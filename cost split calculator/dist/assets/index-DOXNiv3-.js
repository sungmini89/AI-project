const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/geminiService-B_u4aei_.js","assets/ai-DlT_pbP0.js"])))=>i.map(i=>d[i]);
var co=Object.defineProperty;var uo=(s,t,n)=>t in s?co(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var ue=(s,t,n)=>uo(s,typeof t!="symbol"?t+"":t,n);import{r as f,a as vt,R as ie,u as Be,L as kt,b as mo,O as fo,c as Hn,d as ho,e as po,B as xo,f as go,h as ce}from"./vendor-ce8xW3Mj.js";import{X as qt,M as vo,C as Ce,H as Ds,K as bo,S as Mt,a as yo,G as jo,b as Kn,P as Je,B as Lt,F as Dt,A as xs,c as qn,m as Ne,U as gs,d as wo,e as vs,L as No,f as bs,g as _t,D as en,h as ys,i as So,j as rs,R as Gn,k as Yn,l as Co,T as ft,E as Ao,n as Xn,o as js,p as Qn,q as Pt,r as Eo,s as tn,t as Ro,u as sn,v as _s,w as Io,x as nn,y as ko,z as Ft,I as Po,J as rn,N as To,O as Oo,Q as $o,V as Mo,W as Lo,Y as Do,Z as _o,_ as Fo,$ as Bo}from"./ui-BpabE12z.js";import{s as zo,T as Uo}from"./ocr-DKwpO92W.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var Jn={exports:{}},Gt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vo=f,Wo=Symbol.for("react.element"),Ho=Symbol.for("react.fragment"),Ko=Object.prototype.hasOwnProperty,qo=Vo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Go={key:!0,ref:!0,__self:!0,__source:!0};function Zn(s,t,n){var r,a={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)Ko.call(t,r)&&!Go.hasOwnProperty(r)&&(a[r]=t[r]);if(s&&s.defaultProps)for(r in t=s.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Wo,type:s,key:o,ref:i,props:a,_owner:qo.current}}Gt.Fragment=Ho;Gt.jsx=Zn;Gt.jsxs=Zn;Jn.exports=Gt;var e=Jn.exports,ws={},an=vt;ws.createRoot=an.createRoot,ws.hydrateRoot=an.hydrateRoot;function on(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function er(...s){return t=>{let n=!1;const r=s.map(a=>{const o=on(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():on(s[a],null)}}}}function le(...s){return f.useCallback(er(...s),s)}function ht(s){const t=Xo(s),n=f.forwardRef((r,a)=>{const{children:o,...i}=r,l=f.Children.toArray(o),c=l.find(Jo);if(c){const d=c.props.children,u=l.map(m=>m===c?f.Children.count(d)>1?f.Children.only(null):f.isValidElement(d)?d.props.children:null:m);return e.jsx(t,{...i,ref:a,children:f.isValidElement(d)?f.cloneElement(d,void 0,u):null})}return e.jsx(t,{...i,ref:a,children:o})});return n.displayName=`${s}.Slot`,n}var Yo=ht("Slot");function Xo(s){const t=f.forwardRef((n,r)=>{const{children:a,...o}=n;if(f.isValidElement(a)){const i=ei(a),l=Zo(o,a.props);return a.type!==f.Fragment&&(l.ref=r?er(r,i):i),f.cloneElement(a,l)}return f.Children.count(a)>1?f.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var Qo=Symbol("radix.slottable");function Jo(s){return f.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Qo}function Zo(s,t){const n={...t};for(const r in t){const a=s[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...l)=>{const c=o(...l);return a(...l),c}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...s,...n}}function ei(s){var r,a;let t=(r=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}function tr(s){var t,n,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(t=0;t<a;t++)s[t]&&(n=tr(s[t]))&&(r&&(r+=" "),r+=n)}else for(n in s)s[n]&&(r&&(r+=" "),r+=n);return r}function sr(){for(var s,t,n=0,r="",a=arguments.length;n<a;n++)(s=arguments[n])&&(t=tr(s))&&(r&&(r+=" "),r+=t);return r}const ln=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,cn=sr,nr=(s,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return cn(s,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:o}=t,i=Object.keys(a).map(d=>{const u=n==null?void 0:n[d],m=o==null?void 0:o[d];if(u===null)return null;const v=ln(u)||ln(m);return a[d][v]}),l=n&&Object.entries(n).reduce((d,u)=>{let[m,v]=u;return v===void 0||(d[m]=v),d},{}),c=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((d,u)=>{let{class:m,className:v,...j}=u;return Object.entries(j).every(w=>{let[x,h]=w;return Array.isArray(h)?h.includes({...o,...l}[x]):{...o,...l}[x]===h})?[...d,m,v]:d},[]);return cn(s,i,c,n==null?void 0:n.class,n==null?void 0:n.className)},Fs="-",ti=s=>{const t=ni(s),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=s;return{getClassGroupId:i=>{const l=i.split(Fs);return l[0]===""&&l.length!==1&&l.shift(),rr(l,t)||si(i)},getConflictingClassGroupIds:(i,l)=>{const c=n[i]||[];return l&&r[i]?[...c,...r[i]]:c}}},rr=(s,t)=>{var i;if(s.length===0)return t.classGroupId;const n=s[0],r=t.nextPart.get(n),a=r?rr(s.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const o=s.join(Fs);return(i=t.validators.find(({validator:l})=>l(o)))==null?void 0:i.classGroupId},dn=/^\[(.+)\]$/,si=s=>{if(dn.test(s)){const t=dn.exec(s)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},ni=s=>{const{theme:t,prefix:n}=s,r={nextPart:new Map,validators:[]};return ai(Object.entries(s.classGroups),n).forEach(([o,i])=>{Ns(i,r,o,t)}),r},Ns=(s,t,n,r)=>{s.forEach(a=>{if(typeof a=="string"){const o=a===""?t:un(t,a);o.classGroupId=n;return}if(typeof a=="function"){if(ri(a)){Ns(a(r),t,n,r);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([o,i])=>{Ns(i,un(t,o),n,r)})})},un=(s,t)=>{let n=s;return t.split(Fs).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},ri=s=>s.isThemeGetter,ai=(s,t)=>t?s.map(([n,r])=>{const a=r.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,l])=>[t+i,l])):o);return[n,a]}):s,oi=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const a=(o,i)=>{n.set(o,i),t++,t>s&&(t=0,r=n,n=new Map)};return{get(o){let i=n.get(o);if(i!==void 0)return i;if((i=r.get(o))!==void 0)return a(o,i),i},set(o,i){n.has(o)?n.set(o,i):a(o,i)}}},ar="!",ii=s=>{const{separator:t,experimentalParseClassName:n}=s,r=t.length===1,a=t[0],o=t.length,i=l=>{const c=[];let d=0,u=0,m;for(let h=0;h<l.length;h++){let b=l[h];if(d===0){if(b===a&&(r||l.slice(h,h+o)===t)){c.push(l.slice(u,h)),u=h+o;continue}if(b==="/"){m=h;continue}}b==="["?d++:b==="]"&&d--}const v=c.length===0?l:l.substring(u),j=v.startsWith(ar),w=j?v.substring(1):v,x=m&&m>u?m-u:void 0;return{modifiers:c,hasImportantModifier:j,baseClassName:w,maybePostfixModifierPosition:x}};return n?l=>n({className:l,parseClassName:i}):i},li=s=>{if(s.length<=1)return s;const t=[];let n=[];return s.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},ci=s=>({cache:oi(s.cacheSize),parseClassName:ii(s),...ti(s)}),di=/\s+/,ui=(s,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=t,o=[],i=s.trim().split(di);let l="";for(let c=i.length-1;c>=0;c-=1){const d=i[c],{modifiers:u,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:j}=n(d);let w=!!j,x=r(w?v.substring(0,j):v);if(!x){if(!w){l=d+(l.length>0?" "+l:l);continue}if(x=r(v),!x){l=d+(l.length>0?" "+l:l);continue}w=!1}const h=li(u).join(":"),b=m?h+ar:h,p=b+x;if(o.includes(p))continue;o.push(p);const g=a(x,w);for(let y=0;y<g.length;++y){const N=g[y];o.push(b+N)}l=d+(l.length>0?" "+l:l)}return l};function mi(){let s=0,t,n,r="";for(;s<arguments.length;)(t=arguments[s++])&&(n=or(t))&&(r&&(r+=" "),r+=n);return r}const or=s=>{if(typeof s=="string")return s;let t,n="";for(let r=0;r<s.length;r++)s[r]&&(t=or(s[r]))&&(n&&(n+=" "),n+=t);return n};function fi(s,...t){let n,r,a,o=i;function i(c){const d=t.reduce((u,m)=>m(u),s());return n=ci(d),r=n.cache.get,a=n.cache.set,o=l,l(c)}function l(c){const d=r(c);if(d)return d;const u=ui(c,n);return a(c,u),u}return function(){return o(mi.apply(null,arguments))}}const ae=s=>{const t=n=>n[s]||[];return t.isThemeGetter=!0,t},ir=/^\[(?:([a-z-]+):)?(.+)\]$/i,hi=/^\d+\/\d+$/,pi=new Set(["px","full","screen"]),xi=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gi=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,vi=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,bi=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,yi=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ke=s=>Ye(s)||pi.has(s)||hi.test(s),Oe=s=>et(s,"length",Ri),Ye=s=>!!s&&!Number.isNaN(Number(s)),as=s=>et(s,"number",Ye),lt=s=>!!s&&Number.isInteger(Number(s)),ji=s=>s.endsWith("%")&&Ye(s.slice(0,-1)),K=s=>ir.test(s),$e=s=>xi.test(s),wi=new Set(["length","size","percentage"]),Ni=s=>et(s,wi,lr),Si=s=>et(s,"position",lr),Ci=new Set(["image","url"]),Ai=s=>et(s,Ci,ki),Ei=s=>et(s,"",Ii),ct=()=>!0,et=(s,t,n)=>{const r=ir.exec(s);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},Ri=s=>gi.test(s)&&!vi.test(s),lr=()=>!1,Ii=s=>bi.test(s),ki=s=>yi.test(s),Pi=()=>{const s=ae("colors"),t=ae("spacing"),n=ae("blur"),r=ae("brightness"),a=ae("borderColor"),o=ae("borderRadius"),i=ae("borderSpacing"),l=ae("borderWidth"),c=ae("contrast"),d=ae("grayscale"),u=ae("hueRotate"),m=ae("invert"),v=ae("gap"),j=ae("gradientColorStops"),w=ae("gradientColorStopPositions"),x=ae("inset"),h=ae("margin"),b=ae("opacity"),p=ae("padding"),g=ae("saturate"),y=ae("scale"),N=ae("sepia"),S=ae("skew"),C=ae("space"),E=ae("translate"),F=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],L=()=>["auto",K,t],P=()=>[K,t],W=()=>["",ke,Oe],H=()=>["auto",Ye,K],X=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],B=()=>["solid","dashed","dotted","double","none"],A=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],I=()=>["start","end","center","between","around","evenly","stretch"],M=()=>["","0",K],_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],z=()=>[Ye,K];return{cacheSize:500,separator:":",theme:{colors:[ct],spacing:[ke,Oe],blur:["none","",$e,K],brightness:z(),borderColor:[s],borderRadius:["none","","full",$e,K],borderSpacing:P(),borderWidth:W(),contrast:z(),grayscale:M(),hueRotate:z(),invert:M(),gap:P(),gradientColorStops:[s],gradientColorStopPositions:[ji,Oe],inset:L(),margin:L(),opacity:z(),padding:P(),saturate:z(),scale:z(),sepia:M(),skew:z(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",K]}],container:["container"],columns:[{columns:[$e]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...X(),K]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:F()}],"overscroll-x":[{"overscroll-x":F()}],"overscroll-y":[{"overscroll-y":F()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",lt,K]}],basis:[{basis:L()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",K]}],grow:[{grow:M()}],shrink:[{shrink:M()}],order:[{order:["first","last","none",lt,K]}],"grid-cols":[{"grid-cols":[ct]}],"col-start-end":[{col:["auto",{span:["full",lt,K]},K]}],"col-start":[{"col-start":H()}],"col-end":[{"col-end":H()}],"grid-rows":[{"grid-rows":[ct]}],"row-start-end":[{row:["auto",{span:[lt,K]},K]}],"row-start":[{"row-start":H()}],"row-end":[{"row-end":H()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",K]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",K]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...I()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...I(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...I(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[p]}],px:[{px:[p]}],py:[{py:[p]}],ps:[{ps:[p]}],pe:[{pe:[p]}],pt:[{pt:[p]}],pr:[{pr:[p]}],pb:[{pb:[p]}],pl:[{pl:[p]}],m:[{m:[h]}],mx:[{mx:[h]}],my:[{my:[h]}],ms:[{ms:[h]}],me:[{me:[h]}],mt:[{mt:[h]}],mr:[{mr:[h]}],mb:[{mb:[h]}],ml:[{ml:[h]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",K,t]}],"min-w":[{"min-w":[K,t,"min","max","fit"]}],"max-w":[{"max-w":[K,t,"none","full","min","max","fit","prose",{screen:[$e]},$e]}],h:[{h:[K,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[K,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[K,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[K,t,"auto","min","max","fit"]}],"font-size":[{text:["base",$e,Oe]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",as]}],"font-family":[{font:[ct]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",K]}],"line-clamp":[{"line-clamp":["none",Ye,as]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ke,K]}],"list-image":[{"list-image":["none",K]}],"list-style-type":[{list:["none","disc","decimal",K]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[s]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[s]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...B(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ke,Oe]}],"underline-offset":[{"underline-offset":["auto",ke,K]}],"text-decoration-color":[{decoration:[s]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",K]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",K]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...X(),Si]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Ni]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Ai]}],"bg-color":[{bg:[s]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[j]}],"gradient-via":[{via:[j]}],"gradient-to":[{to:[j]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...B(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:B()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...B()]}],"outline-offset":[{"outline-offset":[ke,K]}],"outline-w":[{outline:[ke,Oe]}],"outline-color":[{outline:[s]}],"ring-w":[{ring:W()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[s]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[ke,Oe]}],"ring-offset-color":[{"ring-offset":[s]}],shadow:[{shadow:["","inner","none",$e,Ei]}],"shadow-color":[{shadow:[ct]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...A(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":A()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",$e,K]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[m]}],saturate:[{saturate:[g]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[g]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",K]}],duration:[{duration:z()}],ease:[{ease:["linear","in","out","in-out",K]}],delay:[{delay:z()}],animate:[{animate:["none","spin","ping","pulse","bounce",K]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[y]}],"scale-x":[{"scale-x":[y]}],"scale-y":[{"scale-y":[y]}],rotate:[{rotate:[lt,K]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",K]}],accent:[{accent:["auto",s]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",K]}],"caret-color":[{caret:[s]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",K]}],fill:[{fill:[s,"none"]}],"stroke-w":[{stroke:[ke,Oe,as]}],stroke:[{stroke:[s,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Ti=fi(Pi);function Y(...s){return Ti(sr(s))}const Oi=nr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",industrial:"industrial-btn glow-orange focus-visible:ring-primary/30",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),T=f.forwardRef(({className:s,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?Yo:"button";return e.jsx(i,{className:Y(Oi({variant:t,size:n,className:s})),ref:o,...a})});T.displayName="Button";const cr=f.createContext(null),$i=({children:s})=>{const[t,n]=f.useState([]),[r,a]=f.useState(!1),[o,i]=f.useState(null),l=f.useCallback(j=>{n(w=>[...w.filter(h=>h.action!==j.action),j])},[]),c=f.useCallback(j=>{n(w=>w.filter(x=>x.action!==j))},[]),d=f.useCallback(()=>{i(document.activeElement),a(!0)},[]),u=f.useCallback(()=>{a(!1),o&&(o.focus(),i(null))},[o]),m=f.useCallback(()=>{r||i(document.activeElement),a(j=>!j)},[r]);ie.useEffect(()=>{if(r){const j=document.querySelector('[data-testid="settings-modal"]');j&&j.focus()}},[r]),ie.useEffect(()=>{const j=w=>{if(w.key==="?"&&!w.ctrlKey&&!w.metaKey&&!w.altKey){const x=w.target;if(x.tagName==="INPUT"||x.tagName==="TEXTAREA"||x.isContentEditable)return;w.preventDefault(),m()}w.key==="Escape"&&r&&(w.preventDefault(),u())};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[m,u,r]);const v={globalHotkeys:t,registerGlobalHotkey:l,unregisterGlobalHotkey:c,isHotkeyHelpVisible:r,showHotkeyHelp:d,hideHotkeyHelp:u,toggleHotkeyHelp:m};return e.jsxs(cr.Provider,{value:v,children:[s,r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] p-4",onClick:u,"data-testid":"settings-modal-backdrop",children:e.jsxs("div",{className:"steel-panel hud-element rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto custom-scrollbar",onClick:j=>j.stopPropagation(),"data-testid":"settings-modal",role:"dialog","aria-labelledby":"hotkey-help-title",tabIndex:-1,children:[e.jsx("h3",{id:"hotkey-help-title",className:"text-lg font-semibold mb-4 tech-title",children:"키보드 단축키"}),e.jsxs("div",{className:"space-y-3",children:[t.length>0?t.map(j=>{var w;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:j.description}),e.jsxs("div",{className:"flex items-center space-x-1",children:[(w=j.modifiers)==null?void 0:w.map(x=>e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs font-mono",children:x==="Control"?"Ctrl":x==="Meta"?"Cmd":x==="Alt"?"Alt":x==="Shift"?"Shift":x},x)),e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs font-mono",children:j.key.replace("Key","")})]})]},j.action)}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"사용 가능한 단축키가 없습니다."}),e.jsxs("div",{className:"flex items-center justify-between border-t pt-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"이 도움말 표시/숨김"}),e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs font-mono",children:"?"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t text-center",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"ESC 키나 배경을 클릭하여 닫기"})})]})})]})},Mi=()=>{const s=f.useContext(cr);if(!s)throw new Error("useHotkeyContext must be used within a HotkeyProvider");return s},Li=({onMenuClick:s,sidebarOpen:t})=>{const n=Be(),{showHotkeyHelp:r}=Mi();return e.jsx("header",{className:"sticky top-0 z-50 w-full border-b steel-panel backdrop-blur supports-[backdrop-filter]:bg-background/60 animated-border",children:e.jsxs("div",{className:"container flex h-14 items-center",children:[e.jsx(T,{variant:"ghost",size:"sm",className:"mr-2 px-2 text-base hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 lg:hidden",onClick:s,"aria-label":t?"메뉴 닫기":"메뉴 열기","data-testid":"mobile-menu-button",children:t?e.jsx(qt,{className:"h-6 w-6"}):e.jsx(vo,{className:"h-6 w-6"})}),e.jsxs(kt,{to:"/",className:"mr-6 flex items-center space-x-2 transition-colors hover:text-foreground/80 status-active","data-testid":"logo-link",children:[e.jsx(Ce,{className:"h-6 w-6 text-primary glow-orange"}),e.jsx("span",{className:"hidden font-bold text-xl sm:inline-block tech-title",children:"Smart Split"}),e.jsx("span",{className:"font-bold text-lg sm:hidden tech-title",children:"Split"})]}),e.jsxs("nav",{className:"flex items-center space-x-6 text-sm font-medium hidden lg:flex",children:[e.jsxs(kt,{to:"/calculator",className:Y("transition-colors hover:text-foreground/80","flex items-center space-x-1"),"data-testid":"calculator-nav-link",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{children:"계산기"})]}),e.jsxs(kt,{to:"/history",className:Y("transition-colors hover:text-foreground/80","flex items-center space-x-1"),"data-testid":"history-nav-link",children:[e.jsx(Ds,{className:"h-4 w-4"}),e.jsx("span",{children:"히스토리"})]})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(T,{size:"sm",onClick:()=>n("/calculator"),className:"hidden sm:flex items-center space-x-1 industrial-btn glow-orange","data-testid":"new-calculation-button",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{children:"새 계산"})]}),e.jsx(T,{variant:"ghost",size:"sm",className:"px-2","aria-label":"단축키 도움말","data-testid":"hotkey-help-button",onClick:r,children:e.jsx(bo,{className:"h-4 w-4"})}),e.jsx(T,{variant:"ghost",size:"sm",className:"px-2","aria-label":"설정","data-testid":"settings-button",onClick:()=>n("/settings"),children:e.jsx(Mt,{className:"h-4 w-4"})})]})]})})},Di=()=>{const s=new Date().getFullYear();return e.jsxs("footer",{className:"border-t bg-muted/50 mt-auto",children:[e.jsxs("div",{className:"container flex flex-col items-center justify-between gap-4 py-6 md:h-16 md:flex-row md:py-0",children:[e.jsx("div",{className:"flex flex-col items-center gap-2 px-8 md:flex-row md:gap-2 md:px-0",children:e.jsxs("p",{className:"text-center text-sm leading-loose text-muted-foreground md:text-left",children:["© ",s," Smart Split Calculator.",e.jsx("span",{className:"hidden md:inline",children:" 영수증을 스마트하게 나누세요."})]})}),e.jsxs("div",{className:"flex flex-col items-center gap-2 md:flex-row md:gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-muted-foreground",children:[e.jsx("span",{children:"Made with"}),e.jsx(yo,{className:"h-4 w-4 text-red-500 fill-current"}),e.jsx("span",{children:"in Korea"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("a",{href:"https://github.com/username/cost-split-calculator",target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":"GitHub 저장소","data-testid":"github-link",children:e.jsx(jo,{className:"h-4 w-4"})}),e.jsx("a",{href:"mailto:contact@example.com",className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":"이메일 문의","data-testid":"email-link",children:e.jsx(Kn,{className:"h-4 w-4"})})]})]})]}),e.jsx("div",{className:"border-t bg-muted/30 py-2",children:e.jsx("div",{className:"container text-center",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Version 1.0.0 |",e.jsx("span",{className:"ml-1",children:e.jsx("a",{href:"/privacy",className:"hover:text-foreground transition-colors","data-testid":"privacy-link",children:"개인정보처리방침"})}),e.jsx("span",{className:"mx-1",children:"|"}),e.jsx("a",{href:"/terms",className:"hover:text-foreground transition-colors","data-testid":"terms-link",children:"이용약관"})]})})})]})},_i=({currentPath:s})=>{const t=[{title:"계산기",href:"/calculator",icon:Ce},{title:"새 계산",href:"/calculator/new",icon:Je},{title:"히스토리",href:"/history",icon:Ds},{title:"통계",href:"/stats",icon:Lt}],n=r=>r==="/calculator"&&(s==="/"||s==="/calculator")?!0:s===r;return e.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-background border-t md:hidden","data-testid":"mobile-nav",children:[e.jsx("div",{className:"grid grid-cols-4 gap-0",children:t.map(r=>{const a=r.icon,o=n(r.href);return e.jsxs(kt,{to:r.href,className:Y("flex flex-col items-center justify-center py-2 px-1 text-xs font-medium transition-colors","hover:bg-accent hover:text-accent-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-inset","min-h-[60px]",o?"text-primary bg-accent/50":"text-muted-foreground"),"data-testid":`mobile-nav-${r.title.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsx(a,{className:"h-5 w-5 mb-1"}),e.jsx("span",{className:"text-[10px] leading-tight text-center",children:r.title}),r.badge&&e.jsx("span",{className:"absolute -top-1 -right-1 h-4 w-4 rounded-full bg-primary text-[8px] text-primary-foreground flex items-center justify-center",children:r.badge})]},`${r.title}-${r.href}`)})}),e.jsx("div",{className:"h-safe-area-inset-bottom bg-background"})]})},mn=({orientation:s="horizontal",className:t})=>e.jsx("div",{role:"separator",className:Y("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t)}),Fi=({isOpen:s,onClose:t,currentPath:n})=>{const r=Be(),a=[{title:"새 계산",href:"/calculator/new",icon:Je,description:"새로운 영수증 분할 계산 시작"},{title:"계산기",href:"/calculator",icon:Ce,description:"영수증 OCR 및 분할 계산"},{title:"히스토리",href:"/history",icon:Ds,description:"과거 계산 내역 보기"}],o=[{title:"통계",href:"/stats",icon:Lt,description:"지출 패턴 분석"},{title:"템플릿",href:"/templates",icon:Dt,description:"자주 사용하는 분할 설정"},{title:"아카이브",href:"/archive",icon:xs,description:"보관된 계산 내역"}],i=[{title:"설정",href:"/settings",icon:Mt,description:"앱 설정 및 환경설정"},{title:"도움말",href:"/help",icon:qn,description:"사용법 및 FAQ"}],l=d=>{r(d),t()},c=d=>d==="/calculator/new"?n==="/calculator/new":d==="/calculator"?n==="/"||n==="/calculator":n===d;return e.jsx(e.Fragment,{children:e.jsxs("aside",{className:Y("fixed left-0 top-0 z-50 h-full w-64 transform border-r steel-panel transition-transform duration-200 ease-in-out",s?"translate-x-0":"-translate-x-full","lg:static lg:z-auto lg:translate-x-0 lg:transition-none"),"data-testid":"sidebar",children:[e.jsxs("div",{className:"flex h-14 items-center justify-between border-b px-4 lg:justify-center circuit-line",children:[e.jsxs("div",{className:"flex items-center space-x-2 status-active",children:[e.jsx(Ce,{className:"h-6 w-6 text-primary glow-orange"}),e.jsx("span",{className:"font-semibold tech-title",children:"Smart Split"})]}),e.jsx(T,{variant:"ghost",size:"sm",className:"lg:hidden",onClick:t,"aria-label":"사이드바 닫기","data-testid":"sidebar-close-button",children:e.jsx(qt,{className:"h-4 w-4"})})]}),e.jsxs("nav",{className:"flex flex-col h-[calc(100%-3.5rem)] py-4",children:[e.jsxs("div",{className:"flex-1 space-y-6 px-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"px-3 text-xs font-semibold text-muted-foreground uppercase tracking-wider tech-subtitle",children:"메인"}),a.map(d=>{const u=d.icon,m=c(d.href);return e.jsxs("button",{onClick:()=>l(d.href),className:Y("w-full flex items-center space-x-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors","hover:bg-accent hover:text-accent-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",m&&"bg-accent text-accent-foreground"),"data-testid":`nav-item-${d.title.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsx(u,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{children:d.title}),d.description&&e.jsx("div",{className:"text-xs text-muted-foreground line-clamp-1",children:d.description})]}),d.badge&&e.jsx("span",{className:"ml-auto rounded-full bg-primary px-2 py-0.5 text-xs text-primary-foreground",children:d.badge})]},d.href)})]}),e.jsx(mn,{}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"px-3 text-xs font-semibold text-muted-foreground uppercase tracking-wider tech-subtitle",children:"도구"}),o.map(d=>{const u=d.icon,m=c(d.href);return e.jsxs("button",{onClick:()=>l(d.href),className:Y("w-full flex items-center space-x-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors","hover:bg-accent hover:text-accent-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",m&&"bg-accent text-accent-foreground"),"data-testid":`nav-item-${d.title.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsx(u,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{children:d.title}),d.description&&e.jsx("div",{className:"text-xs text-muted-foreground line-clamp-1",children:d.description})]})]},d.href)})]})]}),e.jsxs("div",{className:"px-3 space-y-1",children:[e.jsx(mn,{className:"mb-3"}),i.map(d=>{const u=d.icon,m=c(d.href);return e.jsxs("button",{onClick:()=>l(d.href),className:Y("w-full flex items-center space-x-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors","hover:bg-accent hover:text-accent-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",m&&"bg-accent text-accent-foreground"),"data-testid":`nav-item-${d.title.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsx(u,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:d.title})]},d.href)})]})]})]})})};function Bi(s,t){const n=fn(s.key),r=fn(t.key);return n===r&&!!s.ctrlKey==!!t.ctrlKey&&!!s.altKey==!!t.altKey&&!!s.shiftKey==!!t.shiftKey&&!!s.metaKey==!!t.metaKey}function fn(s){return s.startsWith("Key")&&s.length===4?s.charAt(3).toLowerCase():["Enter","Escape","Tab","Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(s)?s:s.toLowerCase()}function zi(){return typeof window<"u"&&window.innerWidth<=768}function Ui(s){if(!s)return!1;const t=s.tagName.toLowerCase();return!!(["input","textarea","select"].includes(t)||s.getAttribute("contenteditable")==="true")}const Vi={enableOnFormElements:!1,enableOnMobile:!1,preventDefault:!0,stopPropagation:!0};function Wi(s,t,n={}){const r={...Vi,...n},a=f.useRef(new Map);f.useEffect(()=>{const i=new Map;t.forEach(l=>{i.set(l.action,l)}),a.current=i},[t]);const o=f.useCallback(i=>{if(!r.enableOnMobile&&zi()||!r.enableOnFormElements&&Ui(i.target))return;const l=s.find(d=>Bi(i,d));if(!l)return;const c=a.current.get(l.action);if(c&&c.enabled!==!1){(r.preventDefault||l.preventDefault)&&i.preventDefault(),r.stopPropagation&&i.stopPropagation();try{c.callback()}catch(d){console.error("핫키 액션 실행 중 오류 발생:",d)}}},[s,r]);return f.useEffect(()=>(document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}),[o]),{toggleAction:f.useCallback((i,l)=>{const d=Array.from(a.current.values()).find(u=>u.action===i);d&&(d.enabled=l??!d.enabled,a.current.set(i,d))},[]),disableAll:f.useCallback(()=>{a.current.forEach(i=>{i.enabled=!1})},[]),enableAll:f.useCallback(()=>{a.current.forEach(i=>{i.enabled=!0})},[]),getActiveHotkeys:f.useCallback(()=>s.filter(i=>{const l=a.current.get(i.action);return l&&l.enabled!==!1}),[s])}}const Hi=({children:s})=>{const[t,n]=f.useState(!1),r=mo(),a=Be();Wi([{key:"KeyN",action:"new-calculation",description:"새 계산 시작"},{key:"KeyH",action:"history",description:"히스토리 보기"},{key:"KeyS",action:"settings",description:"설정"},{key:"Escape",action:"escape",description:"취소/닫기"}],[{action:"new-calculation",callback:()=>a("/calculator"),enabled:!0},{action:"history",callback:()=>a("/history"),enabled:!0},{action:"settings",callback:()=>{console.log("Settings opened")},enabled:!0},{action:"escape",callback:()=>{t&&n(!1)},enabled:t}],{enableOnFormElements:!1,enableOnMobile:!1});const l=()=>{n(!t)},c=()=>{n(!1)};return ie.useEffect(()=>{const d=()=>{!(window.innerWidth<768)&&t&&n(!1)};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[t]),e.jsxs("div",{className:"min-h-screen flex flex-col bg-background tech-grid","data-testid":"desktop-layout",children:[e.jsx("div",{className:"hidden md:block","data-testid":"tablet-layout"}),e.jsx("div",{className:"block md:hidden","data-testid":"mobile-indicator"}),e.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-[100] focus:bg-primary focus:text-primary-foreground focus:px-4 focus:py-2 focus:rounded focus:outline-none focus:ring-2 focus:ring-primary","data-testid":"skip-to-main",children:"메인 콘텐츠로 건너뛰기"}),e.jsx(Li,{onMenuClick:l,sidebarOpen:t}),e.jsxs("div",{className:"flex flex-1 relative",children:[e.jsx(Fi,{isOpen:t,onClose:c,currentPath:r.pathname}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:c,"data-testid":"sidebar-backdrop"}),e.jsx("main",{className:Y("flex-1 flex flex-col transition-all duration-200 ease-in-out","min-h-0","relative"),id:"main-content","data-testid":"main-content",tabIndex:-1,children:e.jsx("div",{className:"flex-1 container mx-auto px-4 py-6 max-w-6xl",children:e.jsx("div",{className:"steel-panel rounded-lg p-6 animate-fade-in",children:s||e.jsx(fo,{})})})})]}),e.jsx("div",{className:"lg:hidden",children:e.jsx(_i,{currentPath:r.pathname})}),e.jsx(Di,{})]})},V=f.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:Y("rounded-xl border bg-card text-card-foreground shadow",s),...t}));V.displayName="Card";const J=f.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:Y("flex flex-col space-y-1.5 p-6",s),...t}));J.displayName="CardHeader";const Z=f.forwardRef(({className:s,...t},n)=>e.jsx("h3",{ref:n,className:Y("font-semibold leading-none tracking-tight",s),...t}));Z.displayName="CardTitle";const Ki=f.forwardRef(({className:s,...t},n)=>e.jsx("p",{ref:n,className:Y("text-sm text-muted-foreground",s),...t}));Ki.displayName="CardDescription";const q=f.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:Y("p-6 pt-0",s),...t}));q.displayName="CardContent";const qi=f.forwardRef(({className:s,...t},n)=>e.jsx("div",{ref:n,className:Y("flex items-center p-6 pt-0",s),...t}));qi.displayName="CardFooter";const me=f.forwardRef(({className:s,type:t,...n},r)=>e.jsx("input",{type:t,className:Y("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...n}));me.displayName="Input";const ge=f.forwardRef(({className:s,...t},n)=>e.jsx("label",{ref:n,className:Y("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",s),...t}));ge.displayName="Label";const Gi=nr("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function he({className:s,variant:t,...n}){return e.jsx("div",{className:Y(Gi({variant:t}),s),...n})}const Bs=ie.forwardRef(({className:s,size:t=200,duration:n=15,borderWidth:r=1.5,colorFrom:a="#ffaa40",colorTo:o="#9c40ff",delay:i=0,active:l=!0,children:c,...d},u)=>e.jsxs("div",{ref:u,className:Y("relative overflow-hidden rounded-lg bg-background",s),style:{"--border-beam-size":`${t}px`,"--border-beam-duration":`${n}s`,"--border-beam-delay":`${i}s`,"--border-width":`${r}px`,"--color-from":a,"--color-to":o},...d,children:[l&&e.jsxs(e.Fragment,{children:[e.jsx(Ne.div,{className:"absolute inset-0 rounded-[inherit]",style:{padding:`${r}px`,background:`linear-gradient(90deg, transparent, ${a}, ${o}, transparent)`,mask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",maskComposite:"xor",WebkitMask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",WebkitMaskComposite:"xor"},animate:{background:[`linear-gradient(0deg, transparent, ${a}, ${o}, transparent)`,`linear-gradient(90deg, transparent, ${a}, ${o}, transparent)`,`linear-gradient(180deg, transparent, ${a}, ${o}, transparent)`,`linear-gradient(270deg, transparent, ${a}, ${o}, transparent)`,`linear-gradient(360deg, transparent, ${a}, ${o}, transparent)`]},transition:{duration:n,repeat:1/0,ease:"linear",delay:i}}),e.jsx(Ne.div,{className:"absolute inset-0 opacity-20",style:{background:`radial-gradient(circle at 50% 50%, ${a}40, transparent 60%)`},animate:{scale:[1,1.05,1],opacity:[.2,.4,.2]},transition:{duration:n/2,repeat:1/0,ease:"easeInOut"}})]}),c&&e.jsx("div",{className:"relative z-10",children:c})]}));Bs.displayName="BorderBeam";const dr=ie.forwardRef(({isDragOver:s=!1,isUploading:t=!1,hasError:n=!1,children:r,onDrop:a,onDragOver:o,onDragLeave:i,accept:l,multiple:c=!1,className:d,...u},m)=>{const v=ie.useRef(null),j=N=>{N.preventDefault(),N.stopPropagation();const S=N.dataTransfer.files;S.length>0&&(a==null||a(S))},w=N=>{N.preventDefault(),N.stopPropagation(),o==null||o(N)},x=N=>{N.preventDefault(),N.stopPropagation(),i==null||i(N)},h=()=>{var N;(N=v.current)==null||N.click()},b=N=>{const S=N.target.files;S&&S.length>0&&(a==null||a(S))},p=()=>n?{colorFrom:"#ef4444",colorTo:"#dc2626"}:t?{colorFrom:"#3b82f6",colorTo:"#1d4ed8"}:s?{colorFrom:"#10b981",colorTo:"#059669"}:{colorFrom:"#ffaa40",colorTo:"#9c40ff"},{colorFrom:g,colorTo:y}=p();return e.jsxs(e.Fragment,{children:[e.jsxs(Bs,{ref:m,className:Y("cursor-pointer transition-all duration-200",s&&"scale-[1.02] shadow-lg",t&&"opacity-75 cursor-not-allowed",n&&"border-red-200",d),active:s||t,colorFrom:g,colorTo:y,duration:t?2:15,onDrop:j,onDragOver:w,onDragLeave:x,onClick:t?void 0:h,...u,children:[r,t&&e.jsx(Ne.div,{className:"absolute inset-0 bg-primary/5 flex items-center justify-center rounded-[inherit]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(Ne.div,{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})})]}),e.jsx("input",{ref:v,type:"file",className:"hidden",accept:l,multiple:c,onChange:b,"aria-label":"Upload file","data-testid":"file-input"})]})});dr.displayName="UploadBorderBeam";const Yi=ie.forwardRef(({isFocused:s=!1,hasError:t=!1,children:n,...r},a)=>{const o=()=>t?{colorFrom:"#ef4444",colorTo:"#dc2626"}:{colorFrom:"#3b82f6",colorTo:"#1d4ed8"},{colorFrom:i,colorTo:l}=o();return e.jsx(Bs,{ref:a,active:s,colorFrom:i,colorTo:l,duration:3,...r,children:n})});Yi.displayName="FocusBorderBeam";const Xi=()=>{const[s,t]=f.useState(1),[n,r]=f.useState(null),[a,o]=f.useState(!1),[i,l]=f.useState(!1),[c,d]=f.useState([]),[u,m]=f.useState([]),[v,j]=f.useState(""),[w,x]=f.useState("");f.useRef(null);const h=S=>{if(S.length>0){const C=S[0];if(!C.type.startsWith("image/")){j("지원되지 않는 파일 형식입니다. 이미지 파일만 업로드 가능합니다.");return}j(""),x(""),r(C),setTimeout(()=>{if(o(!1),C.name.includes("blurry")){x("이미지가 흐릿하여 OCR 처리에 실패했습니다."),l(!1);return}l(!0),m([{id:"1",name:"커피",price:4500,quantity:2,category:"음료"},{id:"2",name:"샌드위치",price:7800,quantity:1,category:"음식"},{id:"3",name:"케이크",price:5200,quantity:1,category:"디저트"}])},2e3),o(!0)}},b=()=>{const S={id:Date.now().toString(),name:"",email:"",share:0};d([...c,S])},p=(S,C)=>{d(c.map(E=>E.id===S?{...E,name:C}:E))},g=(S,C)=>{m(u.map(E=>{var F;if(E.id===S){const k=E.assignedParticipants||[],L=(F=c[C])==null?void 0:F.id;if(L&&!k.includes(L))return{...E,assignedParticipants:[...k,L]}}return E}))},y=()=>{console.log("Calculating split...",{participants:c,billItems:u}),t(4)},N=()=>{switch(s){case 1:return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold tech-subtitle",children:"1단계: 영수증 업로드"}),e.jsx(dr,{"data-testid":"upload-zone",onDrop:h,accept:"image/*",className:"p-8 text-center border-2 border-dashed rounded-lg cursor-pointer hover:border-primary",role:"button","aria-label":"영수증 이미지 업로드 영역","aria-describedby":"upload-description",tabIndex:0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg",children:"영수증 이미지를 드롭하거나 클릭해서 업로드하세요"}),e.jsx("p",{id:"upload-description",className:"text-sm text-muted-foreground",children:"JPG, PNG, HEIC 파일을 지원합니다"})]})}),v&&e.jsx("div",{"data-testid":"upload-error",className:"p-4 bg-red-50 border border-red-200 rounded-lg",role:"alert","aria-live":"polite",children:e.jsxs("p",{className:"text-red-800",children:["❌ ",v]})}),n&&!v&&e.jsx("div",{"data-testid":"upload-success",className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-green-800",children:["✅ ",n.name," 업로드 완료"]})}),n&&e.jsx(T,{variant:"industrial","data-testid":"next-button",onClick:()=>t(2),className:"w-full",children:"다음 단계"})]});case 2:return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold tech-subtitle",children:"2단계: OCR 처리 중..."}),a&&e.jsx("div",{"data-testid":"ocr-progress",className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),e.jsx("p",{children:"영수증을 분석하는 중입니다..."})]})}),w&&e.jsxs("div",{"data-testid":"ocr-error",className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("p",{className:"text-red-800",children:["❌ ",w]}),e.jsx(T,{"data-testid":"retry-button",onClick:()=>{x(""),t(1)},className:"mt-2",size:"sm",children:"다시 시도"})]}),i&&!w&&e.jsx("div",{"data-testid":"ocr-complete",className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-blue-800",children:["✅ OCR 처리 완료! ",u.length,"개 항목을 찾았습니다."]})}),i&&e.jsx(T,{variant:"industrial","data-testid":"next-button",onClick:()=>t(3),className:"w-full",children:"다음 단계"})]});case 3:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold tech-subtitle",children:"3단계: 참가자 및 항목 설정"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:"참가자"}),e.jsx(T,{"data-testid":"add-participant-button",onClick:b,variant:"outline",size:"sm",children:"+ 참가자 추가"})]}),c.map((S,C)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(ge,{children:["참가자 ",C+1]}),e.jsx(me,{"data-testid":`participant-name-${C+1}`,placeholder:"이름 입력",value:S.name,onChange:E=>p(S.id,E.target.value),"aria-label":`참가자 ${C+1} 이름`})]},S.id))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"영수증 항목"}),u.map((S,C)=>e.jsx(V,{"data-testid":"bill-item",className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:S.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[S.price.toLocaleString(),"원 x ",S.quantity]})]}),e.jsx("div",{className:"flex space-x-2",children:c.map((E,F)=>e.jsx(T,{"data-testid":`bill-item-${C}`,variant:"outline",size:"sm",onClick:()=>g(S.id,F),children:e.jsx("span",{"data-testid":`assign-participant-${F}`,children:E.name||`참가자 ${F+1}`})},E.id))})]})},S.id))]}),c.length>0&&u.length>0&&e.jsx(T,{variant:"industrial","data-testid":"calculate-button",onClick:y,className:"w-full",children:"계산하기"})]});case 4:return e.jsxs("div",{className:"space-y-4","data-testid":"results-section",children:[e.jsx("h2",{className:"text-xl font-semibold tech-subtitle",children:"4단계: 계산 결과"}),e.jsxs(V,{className:"p-4","data-testid":"calculation-results",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"분할 결과"}),c.map((S,C)=>{const E=u.reduce((F,k)=>{var P;return((P=k.assignedParticipants)==null?void 0:P.includes(S.id))?F+k.price*k.quantity:F},0);return e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{"data-testid":`participant-result-${C}`,children:S.name||`참가자 ${C+1}`}),e.jsxs(he,{"data-testid":`amount-result-${C}`,children:[E.toLocaleString(),"원"]})]},S.id)}),e.jsx("div",{className:"border-t pt-4 mt-4",children:e.jsxs("div",{className:"flex justify-between items-center font-bold",children:[e.jsx("span",{children:"총 금액"}),e.jsxs("span",{"data-testid":"total-amount",children:[u.reduce((S,C)=>S+C.price*C.quantity,0).toLocaleString(),"원"]})]})})]}),e.jsxs(V,{className:"p-4","data-testid":"settlement-suggestions",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"정산 제안"}),e.jsx("div",{className:"space-y-2",children:c.map((S,C)=>{const E=u.reduce((F,k)=>{var P;return((P=k.assignedParticipants)==null?void 0:P.includes(S.id))?F+k.price*k.quantity:F},0);return E===0?null:e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{children:S.name||`참가자 ${C+1}`}),e.jsxs("span",{className:"font-medium",children:[E.toLocaleString(),"원 지불"]})]},S.id)})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(T,{variant:"industrial","data-testid":"save-result-button",onClick:()=>console.log("Saving result..."),className:"flex-1",children:"결과 저장"}),e.jsx(T,{variant:"outline","data-testid":"share-result-button",onClick:()=>console.log("Sharing result..."),className:"flex-1 hover:bg-accent",children:"결과 공유"})]})]});default:return e.jsx("div",{children:"알 수 없는 단계"})}};return e.jsx("div",{className:"container mx-auto p-4 max-w-2xl","data-testid":"calculator-page",children:e.jsxs(V,{className:"steel-panel animated-border",children:[e.jsxs(J,{className:"hud-element rounded-t-lg",children:[e.jsx(Z,{className:"tech-title",children:"스마트 영수증 분할 계산기"}),e.jsx("div",{className:"flex space-x-2",children:[1,2,3,4].map(S=>e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${s>=S?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:S},S))})]}),e.jsx(q,{children:N()})]})})};function se(s,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(s==null||s(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function tt(s,t=[]){let n=[];function r(o,i){const l=f.createContext(i),c=n.length;n=[...n,i];const d=m=>{var b;const{scope:v,children:j,...w}=m,x=((b=v==null?void 0:v[s])==null?void 0:b[c])||l,h=f.useMemo(()=>w,Object.values(w));return e.jsx(x.Provider,{value:h,children:j})};d.displayName=o+"Provider";function u(m,v){var x;const j=((x=v==null?void 0:v[s])==null?void 0:x[c])||l,w=f.useContext(j);if(w)return w;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${o}\``)}return[d,u]}const a=()=>{const o=n.map(i=>f.createContext(i));return function(l){const c=(l==null?void 0:l[s])||o;return f.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[r,Qi(a,...t)]}function Qi(...s){const t=s[0];if(s.length===1)return t;const n=()=>{const r=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const i=r.reduce((l,{useScope:c,scopeName:d})=>{const m=c(o)[`__scope${d}`];return{...l,...m}},{});return f.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}function ur(s){const t=s+"CollectionProvider",[n,r]=tt(t),[a,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=x=>{const{scope:h,children:b}=x,p=ie.useRef(null),g=ie.useRef(new Map).current;return e.jsx(a,{scope:h,itemMap:g,collectionRef:p,children:b})};i.displayName=t;const l=s+"CollectionSlot",c=ht(l),d=ie.forwardRef((x,h)=>{const{scope:b,children:p}=x,g=o(l,b),y=le(h,g.collectionRef);return e.jsx(c,{ref:y,children:p})});d.displayName=l;const u=s+"CollectionItemSlot",m="data-radix-collection-item",v=ht(u),j=ie.forwardRef((x,h)=>{const{scope:b,children:p,...g}=x,y=ie.useRef(null),N=le(h,y),S=o(u,b);return ie.useEffect(()=>(S.itemMap.set(y,{ref:y,...g}),()=>void S.itemMap.delete(y))),e.jsx(v,{[m]:"",ref:N,children:p})});j.displayName=u;function w(x){const h=o(s+"CollectionConsumer",x);return ie.useCallback(()=>{const p=h.collectionRef.current;if(!p)return[];const g=Array.from(p.querySelectorAll(`[${m}]`));return Array.from(h.itemMap.values()).sort((S,C)=>g.indexOf(S.ref.current)-g.indexOf(C.ref.current))},[h.collectionRef,h.itemMap])}return[{Provider:i,Slot:d,ItemSlot:j},w,r]}var de=globalThis!=null&&globalThis.document?f.useLayoutEffect:()=>{},Ji=Hn[" useId ".trim().toString()]||(()=>{}),Zi=0;function bt(s){const[t,n]=f.useState(Ji());return de(()=>{n(r=>r??String(Zi++))},[s]),t?`radix-${t}`:""}var el=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ne=el.reduce((s,t)=>{const n=ht(`Primitive.${t}`),r=f.forwardRef((a,o)=>{const{asChild:i,...l}=a,c=i?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(c,{...l,ref:o})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{});function tl(s,t){s&&vt.flushSync(()=>s.dispatchEvent(t))}function De(s){const t=f.useRef(s);return f.useEffect(()=>{t.current=s}),f.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}var sl=Hn[" useInsertionEffect ".trim().toString()]||de;function Bt({prop:s,defaultProp:t,onChange:n=()=>{},caller:r}){const[a,o,i]=nl({defaultProp:t,onChange:n}),l=s!==void 0,c=l?s:a;{const u=f.useRef(s!==void 0);f.useEffect(()=>{const m=u.current;m!==l&&console.warn(`${r} is changing from ${m?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,r])}const d=f.useCallback(u=>{var m;if(l){const v=rl(u)?u(s):u;v!==s&&((m=i.current)==null||m.call(i,v))}else o(u)},[l,s,o,i]);return[c,d]}function nl({defaultProp:s,onChange:t}){const[n,r]=f.useState(s),a=f.useRef(n),o=f.useRef(t);return sl(()=>{o.current=t},[t]),f.useEffect(()=>{var i;a.current!==n&&((i=o.current)==null||i.call(o,n),a.current=n)},[n,a]),[n,r,o]}function rl(s){return typeof s=="function"}var al=f.createContext(void 0);function zs(s){const t=f.useContext(al);return s||t||"ltr"}var os="rovingFocusGroup.onEntryFocus",ol={bubbles:!1,cancelable:!0},yt="RovingFocusGroup",[Ss,mr,il]=ur(yt),[ll,fr]=tt(yt,[il]),[cl,dl]=ll(yt),hr=f.forwardRef((s,t)=>e.jsx(Ss.Provider,{scope:s.__scopeRovingFocusGroup,children:e.jsx(Ss.Slot,{scope:s.__scopeRovingFocusGroup,children:e.jsx(ul,{...s,ref:t})})}));hr.displayName=yt;var ul=f.forwardRef((s,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...m}=s,v=f.useRef(null),j=le(t,v),w=zs(o),[x,h]=Bt({prop:i,defaultProp:l??null,onChange:c,caller:yt}),[b,p]=f.useState(!1),g=De(d),y=mr(n),N=f.useRef(!1),[S,C]=f.useState(0);return f.useEffect(()=>{const E=v.current;if(E)return E.addEventListener(os,g),()=>E.removeEventListener(os,g)},[g]),e.jsx(cl,{scope:n,orientation:r,dir:w,loop:a,currentTabStopId:x,onItemFocus:f.useCallback(E=>h(E),[h]),onItemShiftTab:f.useCallback(()=>p(!0),[]),onFocusableItemAdd:f.useCallback(()=>C(E=>E+1),[]),onFocusableItemRemove:f.useCallback(()=>C(E=>E-1),[]),children:e.jsx(ne.div,{tabIndex:b||S===0?-1:0,"data-orientation":r,...m,ref:j,style:{outline:"none",...s.style},onMouseDown:se(s.onMouseDown,()=>{N.current=!0}),onFocus:se(s.onFocus,E=>{const F=!N.current;if(E.target===E.currentTarget&&F&&!b){const k=new CustomEvent(os,ol);if(E.currentTarget.dispatchEvent(k),!k.defaultPrevented){const L=y().filter(B=>B.focusable),P=L.find(B=>B.active),W=L.find(B=>B.id===x),X=[P,W,...L].filter(Boolean).map(B=>B.ref.current);gr(X,u)}}N.current=!1}),onBlur:se(s.onBlur,()=>p(!1))})})}),pr="RovingFocusGroupItem",xr=f.forwardRef((s,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,children:i,...l}=s,c=bt(),d=o||c,u=dl(pr,n),m=u.currentTabStopId===d,v=mr(n),{onFocusableItemAdd:j,onFocusableItemRemove:w,currentTabStopId:x}=u;return f.useEffect(()=>{if(r)return j(),()=>w()},[r,j,w]),e.jsx(Ss.ItemSlot,{scope:n,id:d,focusable:r,active:a,children:e.jsx(ne.span,{tabIndex:m?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:se(s.onMouseDown,h=>{r?u.onItemFocus(d):h.preventDefault()}),onFocus:se(s.onFocus,()=>u.onItemFocus(d)),onKeyDown:se(s.onKeyDown,h=>{if(h.key==="Tab"&&h.shiftKey){u.onItemShiftTab();return}if(h.target!==h.currentTarget)return;const b=hl(h,u.orientation,u.dir);if(b!==void 0){if(h.metaKey||h.ctrlKey||h.altKey||h.shiftKey)return;h.preventDefault();let g=v().filter(y=>y.focusable).map(y=>y.ref.current);if(b==="last")g.reverse();else if(b==="prev"||b==="next"){b==="prev"&&g.reverse();const y=g.indexOf(h.currentTarget);g=u.loop?pl(g,y+1):g.slice(y+1)}setTimeout(()=>gr(g))}}),children:typeof i=="function"?i({isCurrentTabStop:m,hasTabStop:x!=null}):i})})});xr.displayName=pr;var ml={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function fl(s,t){return t!=="rtl"?s:s==="ArrowLeft"?"ArrowRight":s==="ArrowRight"?"ArrowLeft":s}function hl(s,t,n){const r=fl(s.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return ml[r]}function gr(s,t=!1){const n=document.activeElement;for(const r of s)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function pl(s,t){return s.map((n,r)=>s[(t+r)%s.length])}var xl=hr,gl=xr;function vl(s,t){return f.useReducer((n,r)=>t[n][r]??n,s)}var vr=s=>{const{present:t,children:n}=s,r=bl(t),a=typeof n=="function"?n({present:r.isPresent}):f.Children.only(n),o=le(r.ref,yl(a));return typeof n=="function"||r.isPresent?f.cloneElement(a,{ref:o}):null};vr.displayName="Presence";function bl(s){const[t,n]=f.useState(),r=f.useRef(null),a=f.useRef(s),o=f.useRef("none"),i=s?"mounted":"unmounted",[l,c]=vl(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return f.useEffect(()=>{const d=St(r.current);o.current=l==="mounted"?d:"none"},[l]),de(()=>{const d=r.current,u=a.current;if(u!==s){const v=o.current,j=St(d);s?c("MOUNT"):j==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&v!==j?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,c]),de(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,m=j=>{const x=St(r.current).includes(CSS.escape(j.animationName));if(j.target===t&&x&&(c("ANIMATION_END"),!a.current)){const h=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=h)})}},v=j=>{j.target===t&&(o.current=St(r.current))};return t.addEventListener("animationstart",v),t.addEventListener("animationcancel",m),t.addEventListener("animationend",m),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",v),t.removeEventListener("animationcancel",m),t.removeEventListener("animationend",m)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:f.useCallback(d=>{r.current=d?getComputedStyle(d):null,n(d)},[])}}function St(s){return(s==null?void 0:s.animationName)||"none"}function yl(s){var r,a;let t=(r=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}var Yt="Tabs",[jl,fm]=tt(Yt,[fr]),br=fr(),[wl,Us]=jl(Yt),yr=f.forwardRef((s,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:l,activationMode:c="automatic",...d}=s,u=zs(l),[m,v]=Bt({prop:r,onChange:a,defaultProp:o??"",caller:Yt});return e.jsx(wl,{scope:n,baseId:bt(),value:m,onValueChange:v,orientation:i,dir:u,activationMode:c,children:e.jsx(ne.div,{dir:u,"data-orientation":i,...d,ref:t})})});yr.displayName=Yt;var jr="TabsList",wr=f.forwardRef((s,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=s,o=Us(jr,n),i=br(n);return e.jsx(xl,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:e.jsx(ne.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});wr.displayName=jr;var Nr="TabsTrigger",Sr=f.forwardRef((s,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=s,i=Us(Nr,n),l=br(n),c=Er(i.baseId,r),d=Rr(i.baseId,r),u=r===i.value;return e.jsx(gl,{asChild:!0,...l,focusable:!a,active:u,children:e.jsx(ne.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:se(s.onMouseDown,m=>{!a&&m.button===0&&m.ctrlKey===!1?i.onValueChange(r):m.preventDefault()}),onKeyDown:se(s.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&i.onValueChange(r)}),onFocus:se(s.onFocus,()=>{const m=i.activationMode!=="manual";!u&&!a&&m&&i.onValueChange(r)})})})});Sr.displayName=Nr;var Cr="TabsContent",Ar=f.forwardRef((s,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=s,l=Us(Cr,n),c=Er(l.baseId,r),d=Rr(l.baseId,r),u=r===l.value,m=f.useRef(u);return f.useEffect(()=>{const v=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(v)},[]),e.jsx(vr,{present:a||u,children:({present:v})=>e.jsx(ne.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!v,id:d,tabIndex:0,...i,ref:t,style:{...s.style,animationDuration:m.current?"0s":void 0},children:v&&o})})});Ar.displayName=Cr;function Er(s,t){return`${s}-trigger-${t}`}function Rr(s,t){return`${s}-content-${t}`}var Nl=yr,Ir=wr,kr=Sr,Pr=Ar;const Sl=Nl,Tr=f.forwardRef(({className:s,...t},n)=>e.jsx(Ir,{ref:n,className:Y("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t}));Tr.displayName=Ir.displayName;const Cs=f.forwardRef(({className:s,...t},n)=>e.jsx(kr,{ref:n,className:Y("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...t}));Cs.displayName=kr.displayName;const As=f.forwardRef(({className:s,...t},n)=>e.jsx(Pr,{ref:n,className:Y("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));As.displayName=Pr.displayName;const Cl=({onFileSelect:s,isProcessing:t=!1,disabled:n=!1,maxFileSize:r=10*1024*1024,acceptedTypes:a=["image/jpeg","image/jpg","image/png","image/webp"]})=>{const[o,i]=f.useState(!1),[l,c]=f.useState(null),[d,u]=f.useState(null),m=f.useCallback(g=>a.includes(g.type)?g.size>r?`파일 크기가 너무 큽니다. 최대 ${Math.round(r/1024/1024)}MB까지 가능합니다.`:null:"지원하지 않는 파일 형식입니다. JPG, PNG, WebP 파일만 업로드 가능합니다.",[a,r]),v=f.useCallback(g=>{const y=m(g);if(y){u(y);return}u(null);const N=URL.createObjectURL(g);c({file:g,url:N}),s(g)},[m,s]),j=f.useCallback(g=>{g.preventDefault(),g.stopPropagation(),!n&&!t&&i(!0)},[n,t]),w=f.useCallback(g=>{g.preventDefault(),g.stopPropagation(),i(!1)},[]),x=f.useCallback(g=>{if(g.preventDefault(),g.stopPropagation(),i(!1),n||t)return;const y=Array.from(g.dataTransfer.files);y.length>0&&v(y[0])},[n,t,v]),h=f.useCallback(g=>{const y=g.target.files;y&&y.length>0&&v(y[0]),g.target.value=""},[v]),b=f.useCallback(()=>{l&&(URL.revokeObjectURL(l.url),c(null)),u(null)},[l]),p=g=>{if(g===0)return"0 B";const y=1024,N=["B","KB","MB","GB"],S=Math.floor(Math.log(g)/Math.log(y));return parseFloat((g/Math.pow(y,S)).toFixed(1))+" "+N[S]};return e.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:`
          relative border-2 border-dashed rounded-lg transition-all duration-300 cursor-pointer
          ${o?"border-blue-400 bg-blue-50 scale-[1.02] shadow-lg":"border-gray-600 hover:border-blue-500"}
          ${n||t?"opacity-50 cursor-not-allowed bg-gray-100":"steel-panel hover:shadow-steel"}
        `,onDragOver:j,onDragLeave:w,onDrop:x,children:[e.jsx("input",{type:"file",accept:a.join(","),onChange:h,disabled:n||t,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",id:"receipt-upload"}),e.jsx("div",{className:"p-8 text-center",children:l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:l.url,alt:"영수증 미리보기",className:"max-w-full max-h-48 rounded-lg shadow-md tech-border"}),e.jsx("button",{onClick:g=>{g.preventDefault(),b()},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors",type:"button",children:e.jsx(qt,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-800",children:l.file.name}),e.jsx("p",{children:p(l.file.size)})]}),!t&&e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"다른 파일을 선택하려면 여기를 클릭하거나 드래그하세요"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto text-gray-400",children:t?e.jsx("div",{className:"animate-spin",children:e.jsx(gs,{className:"w-full h-full"})}):e.jsx(wo,{className:"w-full h-full"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t?"처리 중...":"영수증 이미지 업로드"}),e.jsx("p",{className:"text-gray-600",children:t?"OCR 처리가 진행 중입니다":"이미지를 드래그하거나 클릭하여 선택하세요"})]}),!t&&e.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[e.jsx("p",{children:"지원 형식: JPG, PNG, WebP"}),e.jsxs("p",{children:["최대 크기: ",Math.round(r/1024/1024),"MB"]})]})]})}),t&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"animate-spin w-8 h-8 mx-auto",children:e.jsx(gs,{className:"w-full h-full text-blue-500"})}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"영수증 분석 중..."})]})})]}),d&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-2",children:[e.jsx(vs,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-700",children:d})]}),!l&&!t&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-800 mb-2",children:"📸 더 나은 인식을 위한 팁"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• 영수증이 평평하고 구겨지지 않도록 촬영하세요"}),e.jsx("li",{children:"• 충분한 조명 아래에서 촬영하세요"}),e.jsx("li",{children:"• 글자가 선명하게 보이도록 초점을 맞추세요"}),e.jsx("li",{children:"• 영수증 전체가 화면에 들어오도록 촬영하세요"})]})]})]})};var Vs="Progress",Ws=100,[Al,hm]=tt(Vs),[El,Rl]=Al(Vs),Or=f.forwardRef((s,t)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:o=Il,...i}=s;(a||a===0)&&!hn(a)&&console.error(kl(`${a}`,"Progress"));const l=hn(a)?a:Ws;r!==null&&!pn(r,l)&&console.error(Pl(`${r}`,"Progress"));const c=pn(r,l)?r:null,d=zt(c)?o(c,l):void 0;return e.jsx(El,{scope:n,value:c,max:l,children:e.jsx(ne.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":zt(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":Lr(c,l),"data-value":c??void 0,"data-max":l,...i,ref:t})})});Or.displayName=Vs;var $r="ProgressIndicator",Mr=f.forwardRef((s,t)=>{const{__scopeProgress:n,...r}=s,a=Rl($r,n);return e.jsx(ne.div,{"data-state":Lr(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:t})});Mr.displayName=$r;function Il(s,t){return`${Math.round(s/t*100)}%`}function Lr(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function zt(s){return typeof s=="number"}function hn(s){return zt(s)&&!isNaN(s)&&s>0}function pn(s,t){return zt(s)&&!isNaN(s)&&s<=t&&s>=0}function kl(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ws}\`.`}function Pl(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ws} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Dr=Or,Tl=Mr;const _r=f.forwardRef(({className:s,value:t,...n},r)=>e.jsx(Dr,{ref:r,className:Y("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",s),...n,children:e.jsx(Tl,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));_r.displayName=Dr.displayName;const Ol=({progress:s,className:t=""})=>{const n=(i,l)=>{const c="w-5 h-5";switch(i){case"initializing":return e.jsx(bs,{className:`${c} text-blue-500 animate-pulse`});case"ocr":return e.jsx(Dt,{className:`${c} text-blue-500`});case"ai_enhancement":return e.jsx(_t,{className:`${c} text-purple-500 animate-pulse`});case"processing":return e.jsx(en,{className:`${c} text-orange-500`});case"complete":return e.jsx(ys,{className:`${c} text-green-500`});case"error":return e.jsx(vs,{className:`${c} text-red-500`});default:return e.jsx(So,{className:`${c} text-gray-500`})}},r=i=>{switch(i){case"initializing":return"bg-blue-500";case"ocr":return"bg-green-500";case"ai_enhancement":return"bg-purple-500";case"processing":return"bg-orange-500";case"complete":return"bg-green-600";case"error":return"bg-red-500";default:return"bg-gray-500"}},a=i=>{switch(i){case"initializing":return"초기화";case"ocr":return"OCR 텍스트 인식";case"ai_enhancement":return"AI 결과 개선";case"processing":return"결과 처리";case"complete":return"분석 완료";case"error":return"오류 발생";default:return"처리 중"}},o=i=>{if(!i)return"";switch(i){case"loading":return"엔진 로딩 중...";case"recognizing":return"텍스트 인식 중...";case"processing":return"AI 분석 중...";case"extracting":return"항목 추출 중...";case"finalizing":return"결과 정리 중...";case"merging":return"데이터 통합 중...";case"complete":return"완료";case"finished":return"모든 작업 완료";case"error":return"오류 발생";default:return i}};return e.jsxs("div",{className:`steel-panel p-6 space-y-4 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[s.stage==="complete"?n(s.stage):e.jsx("div",{className:"animate-spin",children:e.jsx(No,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:a(s.stage)}),s.subStage&&e.jsx("p",{className:"text-sm text-gray-600",children:o(s.subStage)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[s.progress.toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:s.stage==="complete"?"완료":"진행 중"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_r,{value:s.progress,className:"h-3 tech-border"}),e.jsx("div",{className:`absolute top-0 left-0 h-full rounded transition-all duration-300 ${r(s.stage)}`,style:{width:`${s.progress}%`}})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:s.message}),s.stage!=="complete"&&s.stage!=="error"&&e.jsx("span",{className:"text-gray-500 animate-pulse",children:"처리 중..."})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mt-6",children:[{key:"initializing",label:"초기화",icon:bs},{key:"ocr",label:"OCR",icon:Dt},{key:"ai_enhancement",label:"AI 개선",icon:_t},{key:"processing",label:"처리",icon:en}].map(({key:i,label:l,icon:c})=>{const d=s.stage===i,u=["initializing","ocr","ai_enhancement","processing"].indexOf(s.stage)>["initializing","ocr","ai_enhancement","processing"].indexOf(i);return e.jsxs("div",{className:`flex flex-col items-center p-2 rounded transition-all ${d?"bg-blue-100 border-2 border-blue-300":u?"bg-green-100 border-2 border-green-300":"bg-gray-100 border-2 border-gray-200"}`,children:[e.jsx(c,{className:`w-4 h-4 mb-1 ${d?"text-blue-600":u?"text-green-600":"text-gray-400"}`}),e.jsx("span",{className:`text-xs font-medium ${d?"text-blue-800":u?"text-green-800":"text-gray-500"}`,children:l})]},i)})}),s.stage==="error"&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vs,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-red-800",children:"분석 중 오류가 발생했습니다"})]})}),s.stage==="complete"&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ys,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"영수증 분석이 완료되었습니다!"})]})})]})},$l=({result:s,onItemToggle:t,onItemEdit:n,onItemDelete:r,onAddItem:a,onRetry:o,onUseResults:i,className:l=""})=>{const[c,d]=f.useState(!1),[u,m]=f.useState("all"),v=s.items.filter(p=>p.isSelected),j=v.reduce((p,g)=>p+g.price*g.quantity,0),w=s.items.filter(p=>{switch(u){case"selected":return p.isSelected;case"unselected":return!p.isSelected;default:return!0}}),x=p=>p>=.8?e.jsx(he,{className:"bg-green-100 text-green-800",children:"높음"}):p>=.6?e.jsx(he,{className:"bg-yellow-100 text-yellow-800",children:"보통"}):e.jsx(he,{className:"bg-red-100 text-red-800",children:"낮음"}),h=p=>{switch(p){case"ai":return e.jsx(he,{className:"bg-purple-100 text-purple-800",children:"AI"});case"ocr":return e.jsx(he,{className:"bg-blue-100 text-blue-800",children:"OCR"});case"manual":return e.jsx(he,{className:"bg-gray-100 text-gray-800",children:"수동"});default:return null}},b=p=>new Intl.NumberFormat("ko-KR").format(p)+"원";return e.jsxs("div",{className:`space-y-6 ${l}`,children:[e.jsxs("div",{className:"steel-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(rs,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"분석 결과"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.items.length,"개 항목 발견, ",v.length,"개 선택됨"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:o&&e.jsxs(T,{variant:"outline",size:"sm",onClick:o,className:"tech-border",children:[e.jsx(Gn,{className:"w-4 h-4 mr-2"}),"다시 분석"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"총 항목"}),e.jsx("div",{className:"text-xl font-bold text-blue-800",children:s.items.length})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"선택된 항목"}),e.jsx("div",{className:"text-xl font-bold text-green-800",children:v.length})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"선택 총액"}),e.jsx("div",{className:"text-xl font-bold text-purple-800",children:b(j)})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"신뢰도"}),e.jsxs("div",{className:"text-xl font-bold text-orange-800",children:[(s.confidence*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"필터:"}),[{key:"all",label:"전체",count:s.items.length},{key:"selected",label:"선택됨",count:v.length},{key:"unselected",label:"선택 안됨",count:s.items.length-v.length}].map(({key:p,label:g,count:y})=>e.jsxs("button",{onClick:()=>m(p),className:`px-3 py-1 text-sm rounded-full border transition-colors ${u===p?"bg-blue-100 border-blue-300 text-blue-800":"bg-gray-100 border-gray-300 text-gray-600 hover:bg-gray-200"}`,children:[g," (",y,")"]},p))]}),a&&e.jsxs(T,{variant:"outline",size:"sm",onClick:a,className:"tech-border",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"항목 추가"]})]})]}),e.jsxs("div",{className:"steel-panel",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("h3",{className:"font-semibold text-gray-800",children:"추출된 항목"})}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[w.map((p,g)=>e.jsx("div",{className:`p-4 transition-colors ${p.isSelected?"bg-blue-50":"bg-white hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t==null?void 0:t(p.id,!p.isSelected),className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${p.isSelected?"bg-blue-600 border-blue-600 text-white":"border-gray-300 hover:border-blue-400"}`,children:p.isSelected&&e.jsx(Yn,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-800",children:p.name}),h(p.source),x(p.confidence)]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["개당 ",b(p.price)]}),e.jsxs("span",{children:["수량 ",p.quantity,"개"]}),e.jsxs("span",{className:"font-medium text-blue-600",children:["합계 ",b(p.price*p.quantity)]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[n&&e.jsx("button",{onClick:()=>n(p),className:"p-2 text-gray-400 hover:text-blue-600 transition-colors rounded",title:"편집",children:e.jsx(Co,{className:"w-4 h-4"})}),r&&e.jsx("button",{onClick:()=>r(p.id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors rounded",title:"삭제",children:e.jsx(ft,{className:"w-4 h-4"})})]})]})},p.id)),w.length===0&&e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(rs,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"표시할 항목이 없습니다"})]})]})]}),e.jsxs("div",{className:"steel-panel p-4",children:[e.jsxs("button",{onClick:()=>d(!c),className:"flex items-center space-x-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",children:[c?e.jsx(Ao,{className:"w-4 h-4"}):e.jsx(Xn,{className:"w-4 h-4"}),e.jsxs("span",{children:["원본 OCR 텍스트 ",c?"숨기기":"보기"]})]}),c&&e.jsx("div",{className:"mt-3 p-4 bg-gray-100 rounded-lg border",children:e.jsx("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap font-mono",children:s.rawText||"원본 텍스트가 없습니다"})}),s.warnings&&s.warnings.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(js,{className:"w-4 h-4 text-yellow-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-1",children:"주의사항"}),e.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:s.warnings.map((p,g)=>e.jsxs("li",{children:["• ",p]},g))})]})]})}),s.errors.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(js,{className:"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-800 mb-1",children:"오류"}),e.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:s.errors.map((p,g)=>e.jsxs("li",{children:["• ",p]},g))})]})]})}),s.suggestions.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Qn,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-1",children:"제안사항"}),e.jsx("ul",{className:"text-sm text-blue-700 space-y-1",children:s.suggestions.map((p,g)=>e.jsxs("li",{children:["• ",p]},g))})]})]})}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"text-xs text-gray-500 space-x-4",children:[e.jsxs("span",{children:["처리 시간: ",s.processingTime,"ms"]}),e.jsxs("span",{children:["사용된 서비스: ",s.usedServices.join(", ")]}),e.jsxs("span",{children:["처리된 항목: ",s.processedItems||0,"개"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 space-x-4",children:[e.jsxs("span",{children:["OCR 신뢰도: ",(s.ocrConfidence*100).toFixed(1),"%"]}),s.aiConfidence&&e.jsxs("span",{children:["AI 신뢰도: ",(s.aiConfidence*100).toFixed(1),"%"]}),e.jsxs("span",{children:["전체 신뢰도: ",(s.confidence*100).toFixed(1),"%"]})]})]})]}),i&&v.length>0&&e.jsx("div",{className:"steel-panel p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-800",children:[v.length,"개 항목을 계산기로 가져오기"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["총 ",b(j)]})]}),e.jsxs(T,{onClick:()=>i(v),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(rs,{className:"w-4 h-4 mr-2"}),"계산기로 가져오기"]})]})})]})};class Ml{constructor(){ue(this,"worker",null);ue(this,"isInitialized",!1);ue(this,"processingQueue",[]);ue(this,"isProcessing",!1);ue(this,"imageCache",new Map);ue(this,"config",{languages:["kor+eng"],engineMode:1,pageSegMode:zo.PSM.SINGLE_BLOCK,preprocessImage:!0,confidenceThreshold:.5});this.loadConfig()}loadConfig(){const t="eng+kor",n=parseFloat("0.6");this.config={...this.config,languages:t.split("+"),confidenceThreshold:n}}async initialize(t){if(!this.isInitialized)try{t==null||t({status:"initializing",progress:10,message:"OCR 엔진 초기화 중...",stage:"loading"});const n={logger:r=>{r.status==="recognizing text"&&t&&t({status:"processing",progress:Math.round(r.progress*70)+20,message:`텍스트 인식 중... ${Math.round(r.progress*100)}%`,stage:"recognizing"})}};this.worker=await Uo.createWorker(this.config.languages,this.config.engineMode,n),await this.worker.setParameters({tessedit_pageseg_mode:this.config.pageSegMode,preserve_interword_spaces:"1",tessedit_char_whitelist:"0123456789가-힣ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz.,()[]- ₩원합계총액",textord_min_linesize:"2.5",textord_merge_desc:"0.2",textord_merge_x:"0.3",textord_tabfind_show_vlines:"0",textord_heavy_nr:"1",textord_show_initial_words:"1",edges_use_new_outline_complexity:"1",edges_max_children_per_outline:"40",language_model_penalty_non_freq_dict_word:"0.1",language_model_penalty_non_dict_word:"0.15",segment_penalty_dict_nonword:"1.3"}),t==null||t({status:"processing",progress:90,message:"OCR 설정 완료",stage:"loading"}),this.isInitialized=!0,console.log("🤖 OCR Service 초기화 완료")}catch(n){throw console.error("❌ OCR 초기화 실패:",n),new Error("OCR 서비스 초기화에 실패했습니다")}}cleanupMemory(){if(this.imageCache.size>10){const t=Array.from(this.imageCache.entries());for(let n=0;n<Math.floor(t.length/2);n++)URL.revokeObjectURL(t[n][1]),this.imageCache.delete(t[n][0])}}async processQueue(){if(this.isProcessing||this.processingQueue.length===0)return;this.isProcessing=!0;const{imageFile:t,resolve:n,reject:r}=this.processingQueue.shift();try{const a=await this.processImageInternal(t);n(a)}catch(a){r(a)}finally{this.isProcessing=!1,this.processingQueue.length>0&&setTimeout(()=>this.processQueue(),100)}}async preprocessImage(t){const n=`${t.name}_${t.lastModified}_${t.size}`;return this.imageCache.has(n)?this.imageCache.get(n):new Promise((r,a)=>{const o=document.createElement("canvas"),i=o.getContext("2d"),l=new Image;this.cleanupMemory(),l.onload=()=>{console.log(`🖼️ 원본 이미지 크기: ${l.width}x${l.height}`);let c=l.width,d=l.height;const u=1200,m=800;if(l.width<u||l.height<m){const p=u/l.width,g=m/l.height,y=Math.max(p,g,1.5);c=Math.round(l.width*y),d=Math.round(l.height*y),console.log(`🔍 한글 인식을 위해 이미지 확대: ${y.toFixed(2)}배`)}c=Math.min(c,4e3),d=Math.min(d,4e3);const v=c,j=d;o.width=v,o.height=j,i.imageSmoothingEnabled=!1,i.drawImage(l,0,0,v,j);const w=i.getImageData(0,0,v,j),x=w.data;console.log("🔧 1단계: 한글 특화 노이즈 제거"),this.applyKoreanOptimizedBlur(x,v,j),console.log("🔧 2단계: 한글 특화 대비 향상"),this.enhanceKoreanContrast(x),console.log("🔧 3단계: 한글 특화 이진화");const h=this.calculateKoreanOptimalThreshold(x);console.log(`🎯 한글 최적 임계값: ${h}`);for(let p=0;p<x.length;p+=4){const y=x[p]*.299+x[p+1]*.587+x[p+2]*.114>h?255:0;x[p]=y,x[p+1]=y,x[p+2]=y}console.log("🔧 5단계: 한글 문자 구조 보강"),this.applyKoreanMorphology(x,v,j),console.log("🔧 6단계: 한글 문자 경계 선명화"),this.sharpenKoreanCharacters(x,v,j),i.putImageData(w,0,0),console.log(`✅ 전처리 완료: ${v}x${j}`);const b=o.toDataURL("image/png");this.imageCache.set(n,b),r(b)},l.onerror=()=>{a(new Error("이미지 로드 실패"))},l.src=URL.createObjectURL(t)})}applyGaussianBlur(t,n,r){const a=[1,2,1,2,4,2,1,2,1],o=16,i=new Uint8ClampedArray(t.length);for(let l=1;l<r-1;l++)for(let c=1;c<n-1;c++){let d=0,u=0,m=0;for(let j=-1;j<=1;j++)for(let w=-1;w<=1;w++){const x=((l+j)*n+(c+w))*4,h=a[(j+1)*3+(w+1)];d+=t[x]*h,u+=t[x+1]*h,m+=t[x+2]*h}const v=(l*n+c)*4;i[v]=d/o,i[v+1]=u/o,i[v+2]=m/o,i[v+3]=t[v+3]}for(let l=1;l<r-1;l++)for(let c=1;c<n-1;c++){const d=(l*n+c)*4;t[d]=i[d],t[d+1]=i[d+1],t[d+2]=i[d+2]}}enhanceContrast(t){for(let r=0;r<t.length;r+=4)t[r]=Math.min(255,Math.max(0,(t[r]-128)*1.5+128)),t[r+1]=Math.min(255,Math.max(0,(t[r+1]-128)*1.5+128)),t[r+2]=Math.min(255,Math.max(0,(t[r+2]-128)*1.5+128))}calculateOptimalThreshold(t){const n=new Array(256).fill(0);for(let d=0;d<t.length;d+=4){const u=Math.round(t[d]*.299+t[d+1]*.587+t[d+2]*.114);n[u]++}const r=t.length/4;let a=0;for(let d=0;d<256;d++)a+=d*n[d];let o=0,i=0,l=0,c=0;for(let d=0;d<256;d++){if(i+=n[d],i===0)continue;const u=r-i;if(u===0)break;o+=d*n[d];const m=o/i,v=(a-o)/u,j=i*u*Math.pow(m-v,2);j>l&&(l=j,c=d)}return c}applyMorphology(t,n,r){const a=new Uint8ClampedArray(t.length);for(let o=1;o<r-1;o++)for(let i=1;i<n-1;i++){const l=(o*n+i)*4;let c=255;for(let d=-1;d<=1;d++)for(let u=-1;u<=1;u++){const m=((o+d)*n+(i+u))*4;c=Math.min(c,t[m])}a[l]=a[l+1]=a[l+2]=c,a[l+3]=t[l+3]}for(let o=1;o<r-1;o++)for(let i=1;i<n-1;i++){const l=(o*n+i)*4;let c=0;for(let d=-1;d<=1;d++)for(let u=-1;u<=1;u++){const m=((o+d)*n+(i+u))*4;c=Math.max(c,a[m])}t[l]=t[l+1]=t[l+2]=c}}preprocessReceiptText(t){console.log("🧹 텍스트 전처리 시작");let n=t;const r={O:"0",o:"0",l:"1",I:"1",S:"5",G:"6",B:"8",Z:"2","〉":">","〈":"<","－":"-","＋":"+","（":"(","）":")","［":"[","］":"]","￦":"₩",W:"₩",ㅗ:"오",ㅏ:"아",ㅓ:"어",ㅜ:"우",ㅣ:"이"};for(const[c,d]of Object.entries(r))n=n.replace(new RegExp(c,"g"),d);const a=[[/(\d),(\d{1,2})([^\d]|$)/g,"$1$2$3"],[/(\d)\.(\d{3})/g,"$1,$2"],[/(\d)\s*,\s*(\d{3})/g,"$1,$2"],[/\s*원\s*$/gm,"원"],[/₩\s*(\d)/g,"₩$1"],[/\s{2,}/g," "],[/^\s+/gm,""],[/\s+$/gm,""],[/[=\-_*]{3,}/g,"---"],[/([가-힣]+)\n([가-힣]+)/g,"$1$2"],[/(\d)\n(\d)/g,"$1$2"]];for(const[c,d]of a)n=n.replace(c,d);const o={아머리카노:"아메리카노",아메리카도:"아메리카노",라떼:"라테",카푸치노:"카푸치노",에소프레소:"에스프레소",에스프래소:"에스프레소",김치찌개:"김치찌개",된장찌게:"된장찌개",비빔밥:"비빔밥",불고기:"불고기",세금:"세금",할인:"할인",부가세:"부가세",봉사료:"봉사료"};for(const[c,d]of Object.entries(o))n=n.replace(new RegExp(c,"g"),d);n=n.replace(/\n{3,}/g,`

`);const i=t.split(`
`).length,l=n.split(`
`).length;return console.log("✅ 텍스트 정제 완료:",{originalLines:i,cleanedLines:l,reductionRate:`${Math.round((1-l/i)*100)}%`,sampleBefore:t.substring(0,100),sampleAfter:n.substring(0,100)}),n}extractReceiptItems(t){const n=[],r=this.preprocessReceiptText(t),a=r.split(`
`).filter(u=>u.trim().length>1);let o=0;console.log("🔍 OCR 텍스트 분석 시작:",{originalLength:t.length,cleanedLength:r.length,lineCount:a.length}),console.log(`📄 정제된 텍스트:
`,r.substring(0,300)+"...");let i=this.extractPositionBasedTotal(r);i>0?console.log(`✅ 위치 기반 총액 발견: ${i}원`):console.log("⚠️ 위치 기반 총액 탐지 실패");const l={namePrice:/^(.{2,40}?)\s+([0-9,.\s]{3,12})원?\s*$/,priceFirst:/^([0-9,.\s]{3,12})원?\s+(.{2,40}?)\s*$/,nameQuantityPrice:/^(.{2,25}?)\s+([0-9]+)\s*[개병잔컵봉팩unit개입매상자박스]\s+([0-9,.\s]{3,12})원?\s*$/,numberedItem:/^[0-9A-Za-z]+[\.\)\-\s]*(.{2,40}?)\s+([0-9,.\s]{3,12})원?\s*$/,tableFormat:/^(.{2,40}?)[\s\t]{2,}([0-9,.\s]{3,12})원?\s*$/,dashSeparated:/^(.{2,40}?)[\.\-]{2,}([0-9,.\s]{3,12})원?\s*$/,discountTax:/^[\(\[\-\+\*\s]*(할인|부가세|세금|봉사료|취소|환불|쿠폰|적립|포인트|DC|VAT).{0,15}?\s*[\-\+]?([0-9,.\s]{3,12})원?\s*$/,alphaNumericMenu:/^([A-Z0-9\-]+\s*[세트콤보COMBO세트menu]*\s*.{0,25}?)\s+([0-9,.\s]{3,12})원?\s*$/,wonSymbol:/^[₩\\]\s*([0-9,.\s]{3,12})\s+(.{2,40}?)\s*$/,complexName:/^(.{2,40}?[\(\)가-힣A-Za-z0-9\s,\.\-]*)\s+([0-9,.\s]{3,12})원?\s*$/,variousUnits:/^(.{2,25}?)\s+([0-9]+)\s*(개|병|잔|컵|봉|팩|EA|ea|매|권|세트|박스|상자|입|kg|g|L|ml|인분|줄|개입)\s+([0-9,.\s]{3,12})원?\s*$/,brandItem:/^(.{2,40}?)\s*[\(\[](.{2,15}?)[\)\]]\s+([0-9,.\s]{3,12})원?\s*$/,timeBasedItem:/^(.{2,40}?)\s*([0-9]+[시분간hour초sec]*)\s+([0-9,.\s]{3,12})원?\s*$/,percentageItem:/^(.{2,40}?)\s*([0-9]+%|할인)\s+([0-9,.\s]{3,12})원?\s*$/,priceOnly:/^([0-9,.\s]{4,12})원?\s*$/},c=[/^[=\-_*]{3,}$/,/^(주소|전화|사업자|대표)/i,/^(영수증|receipt|bill)/i,/^(합계|소계|total|subtotal)/i,/^(카드|현금|cash|card)/i,/^(일시|시간|날짜|date|time)/i,/^[0-9\-\/\:\s]{8,}$/,/^.{1,2}$/,/^[^가-힣a-zA-Z]*$/];for(const u of a){const m=u.trim();console.log("📝 분석 중인 라인:",m);let v=!1;for(const h of c)if(h.test(m)){console.log("⏭️ 스킵된 라인:",m),v=!0;break}if(v)continue;if(!/[0-9]/.test(m)){console.log("⏭️ 숫자 없는 라인 스킵:",m);continue}let j=!1;const w=(h,b="")=>{if(console.log(`💰 extractBestPrice 호출 - 텍스트: "${h}", 기본값: "${b}"`),console.log(`💰 현재 위치 기반 총액: ${i}원`),i>0){const k=i.toString(),L=k.replace(/(\d)(?=(\d{3})+$)/g,"$1,");console.log(`  🔍 총액 문자열 검색: "${k}" 또는 "${L}"`),console.log(`  🔍 검색 대상 텍스트: "${h}"`);const P=h.includes(k)||h.includes(L);if(console.log(`  ✅ 매칭 결과: ${P}`),P)return console.log(`🎯 위치 기반 총액 매칭! ${i}원 사용`),i;console.log("  ❌ 위치 기반 총액이 이 텍스트에 없음")}else console.log(`  ⚠️ 위치 기반 총액이 설정되지 않음 (${i})`);const p=h.match(/[0-9,]{2,}/g)||[];console.log("📊 일반 숫자 패턴:",p);const g=h.match(/(\d{1,3})[\.\s]+(\d{3,})/g)||[];console.log("📊 분리된 숫자 패턴:",g);const y=g.map(k=>{const L=k.replace(/[.\s]/g,"");return console.log(`🔄 결합: "${k}" → "${L}"`),L}),N=h.match(/\d{1,3}[.,]\d{3,}원?/g)||[];console.log("📊 형식화된 숫자 패턴:",N);const S=h.match(/\d{3,6}(?=원)/g)||[];console.log("📊 단순 숫자 패턴 (원 앞):",S);const C=[...p,...y,...N.map(k=>k.replace(/원/g,"")),...S];console.log("📊 모든 숫자 후보:",C);const E=C.map(k=>parseInt(k.replace(/[^0-9]/g,""))).filter(k=>k>=100&&k<=999999).sort((k,L)=>L-k);if(console.log("💰 파싱된 가격 후보들 (큰 순):",E),i>0&&E.includes(i))return console.log(`🎯 위치 기반 총액과 매칭되는 후보 발견: ${i}원`),i;if(E.length>0){const k=E[0];if(y.length>0){const L=y.map(P=>parseInt(P.replace(/[^0-9]/g,""))).filter(P=>P>=1e3&&P<=1e5).sort((P,W)=>W-P);if(L.length>0)return console.log(`✨ 분리된 숫자에서 찾은 가격 우선 선택: ${L[0]}`),L[0]}if(k>1e5&&E.length>1){const L=E[1];if(L>=1e3&&L<=5e4)return console.log(`💡 전화번호 제외하고 두 번째 가격 선택: ${k} → ${L}`),L}return console.log(`💰 최종 선택된 가격: ${k}`),k}const F=parseInt(b.replace(/[^0-9]/g,""))||0;return console.log(`🔄 기본값 사용: ${F}`),F},x=[{name:"variousUnits",pattern:l.variousUnits,extract:h=>{const[,b,p,g,y]=h,N=w(h[0],y);return{name:`${b.trim()} (${g})`,quantity:parseInt(p),price:N,confidence:.95}}},{name:"nameQuantityPrice",pattern:l.nameQuantityPrice,extract:h=>{const[,b,p,g]=h,y=w(h[0],g);return{name:b.trim(),quantity:parseInt(p),price:y,confidence:.9}}},{name:"brandItem",pattern:l.brandItem,extract:h=>{const[,b,p,g]=h,y=w(h[0],g);return{name:`${b.trim()} [${p.trim()}]`,quantity:1,price:y,confidence:.88}}},{name:"numberedItem",pattern:l.numberedItem,extract:h=>{const[,b,p]=h,g=w(h[0],p);return{name:b.trim(),quantity:1,price:g,confidence:.85}}},{name:"timeBasedItem",pattern:l.timeBasedItem,extract:h=>{const[,b,p,g]=h,y=w(h[0],g);return{name:`${b.trim()} (${p})`,quantity:1,price:y,confidence:.82}}},{name:"wonSymbol",pattern:l.wonSymbol,extract:h=>{const[,b,p]=h,g=w(h[0],b);return{name:p.trim(),quantity:1,price:g,confidence:.8}}},{name:"alphaNumericMenu",pattern:l.alphaNumericMenu,extract:h=>{const[,b,p]=h,g=w(h[0],p);return{name:b.trim(),quantity:1,price:g,confidence:.78}}},{name:"percentageItem",pattern:l.percentageItem,extract:h=>{const[,b,p,g]=h,y=w(h[0],g);return{name:`${b.trim()} (${p})`,quantity:1,price:y,confidence:.75}}},{name:"dashSeparated",pattern:l.dashSeparated,extract:h=>{const[,b,p]=h,g=w(h[0],p);return{name:b.trim(),quantity:1,price:g,confidence:.75}}},{name:"tableFormat",pattern:l.tableFormat,extract:h=>{const[,b,p]=h,g=w(h[0],p);return{name:b.trim(),quantity:1,price:g,confidence:.72}}},{name:"namePrice",pattern:l.namePrice,extract:h=>{const[b,p,g]=h,y=w(b,g);return console.log(`💰 namePrice 패턴 - 라인: "${b.substring(0,50)}" → 선택된 가격: ${y}`),{name:p.trim(),quantity:1,price:y,confidence:.7}}},{name:"priceFirst",pattern:l.priceFirst,extract:h=>{const[b,p,g]=h,y=w(b,p);return{name:g.trim(),quantity:1,price:y,confidence:.68}}},{name:"complexName",pattern:l.complexName,extract:h=>{const[b,p,g]=h,y=w(b,g);return{name:p.trim(),quantity:1,price:y,confidence:.65}}},{name:"discountTax",pattern:l.discountTax,extract:h=>{const[,b,p]=h,g=w(h[0],p);return{name:b.trim(),quantity:1,price:g,confidence:.6}}}];for(const{name:h,pattern:b,extract:p}of x){const g=m.match(b);if(g)try{const y=p(g);if(y.price>=100&&y.price<=1e6&&y.name.length>=1&&y.name.length<=50&&y.quantity>=1&&y.quantity<=100){console.log(`✅ ${h} 패턴 매칭:`,y),n.push({id:`ocr-${Date.now()}-${o++}`,name:y.name,price:y.price,quantity:y.quantity,confidence:y.confidence}),j=!0;break}}catch(y){console.warn(`⚠️ ${h} 패턴 추출 오류:`,y)}}if(!j){const h=m.match(l.priceOnly);if(h){const[,b]=h,p=parseInt(b.replace(/[^0-9]/g,""));if(p>=1e3&&p<=1e5){console.log("💰 가격만 추출:",p);const g=a.indexOf(u)-1;if(g>=0){const y=a[g].trim();y.length>=2&&y.length<=30&&/[가-힣a-zA-Z]/.test(y)&&!/[0-9,원₩]/.test(y)&&(console.log("✅ 이전 라인에서 상품명 발견:",y),n.push({id:`ocr-${Date.now()}-${o++}`,name:y,price:p,quantity:1,confidence:.6}),j=!0)}}}}j||console.log("❌ 매칭 실패:",{line:m,containsNumbers:/[0-9]/.test(m),containsWon:/원/.test(m),containsComma:/[,]/.test(m),containsKorean:/[가-힣]/.test(m),lineLength:m.length})}const d=this.removeDuplicateItems(n);return console.log("🎯 OCR 항목 추출 완료:",{totalLines:a.length,extractedItems:n.length,uniqueItems:d.length,averageConfidence:(n.reduce((u,m)=>u+m.confidence,0)/n.length).toFixed(2),positionBasedTotal:i}),{items:d,positionBasedTotal:i}}removeDuplicateItems(t){const n=[];for(const r of t)n.some(o=>{const i=this.calculateStringSimilarity(r.name,o.name)>.8,l=Math.abs(r.price-o.price)<=Math.max(r.price*.1,500);return i&&l})?console.log("🔄 중복 항목 제거:",r.name,r.price):n.push(r);return n.sort((r,a)=>a.confidence-r.confidence)}calculateStringSimilarity(t,n){const r=new Set(t.toLowerCase().replace(/\s/g,"").split("")),a=new Set(n.toLowerCase().replace(/\s/g,"").split("")),o=new Set([...r].filter(l=>a.has(l))),i=new Set([...r,...a]);return i.size===0?0:o.size/i.size}async recognizeImage(t,n){return new Promise((r,a)=>{this.processingQueue.push({imageFile:t,resolve:o=>r(o),reject:o=>a(o)}),this.processQueue()})}async processImageInternal(t){const n=performance.now(),r=[],a=[],o=[];try{const i=this.validateImageFile(t);if(!i.isValid)throw r.push(i.error),o.push(...i.suggestions),new Error(i.error);this.isInitialized||await this.initialize();const l=await this.multiScaleOCROptimized(t);l.length===0&&(a.push("모든 스케일에서 OCR 처리가 실패했습니다"),o.push("이미지 품질을 확인하고 다시 시도해주세요"),o.push("영수증이 선명하고 텍스트가 잘 보이는지 확인하세요"));const c=this.selectBestResult(l),d=this.generateQualityFeedback(c,l);a.push(...d.warnings),o.push(...d.suggestions);const u=performance.now()-n;return console.log(`⚡ OCR 처리 완료: ${u.toFixed(0)}ms`),{...c,processingTime:u,errors:r,warnings:a,suggestions:o,usedServices:["tesseract-ocr","image-preprocessing"]}}catch(i){const l=performance.now()-n;console.error("❌ OCR 처리 실패:",i);const c=this.getErrorMessage(i),d=this.getErrorSuggestions(i);return{items:[],confidence:0,rawText:"",totalAmount:0,processedItems:0,errors:[c],warnings:a,suggestions:[...o,...d],processingTime:l,usedServices:["tesseract-ocr"]}}}async multiScaleOCROptimized(t){const n=[1.5,1,2],r=[];console.log("⚡ 메모리 최적화된 다중 스케일 OCR 분석 시작:",n);for(let a=0;a<n.length;a++){const o=n[a];try{console.log(`📏 스케일 ${o}x 처리 시작`);const i=await this.preprocessImageWithScale(t,o),{data:l}=await this.worker.recognize(i),c=this.calculateConfidence(l.text,l.confidence||0),d=this.extractReceiptItems(l.text),u={scale:o,confidence:c,text:l.text,rawOcr:l,items:d.items,positionBasedTotal:d.positionBasedTotal,processingTime:performance.now()};if(r.push(u),console.log(`✅ 스케일 ${o}x 완료:`,{confidence:c,textLength:l.text.length,itemCount:d.items.length,positionBasedTotal:d.positionBasedTotal}),c>.85&&d.positionBasedTotal>0){console.log("🎯 조기 종료: 높은 신뢰도 결과 발견");break}i.startsWith("data:")&&URL.revokeObjectURL(i)}catch(i){console.error(`❌ 스케일 ${o}x 처리 실패:`,i)}}return console.log(`🏁 다중 스케일 처리 완료: ${r.length}개 결과`),r}async multiScaleOCR(t,n){const r=[1,1.5,2],a=[];console.log("🔍 다중 스케일 OCR 분석 시작:",r);for(let o=0;o<r.length;o++){const i=r[o],l=10+o/r.length*80;try{n==null||n({status:"processing",progress:l,message:`스케일 ${i}x로 OCR 처리 중...`,stage:"processing"}),console.log(`📏 스케일 ${i}x 처리 시작`);const c=await this.preprocessImageWithScale(t,i),{data:d}=await this.worker.recognize(c),u=this.calculateConfidence(d.text,d.confidence||0),m=this.extractReceiptItems(d.text),v={scale:i,confidence:u,text:d.text,rawOcr:d,items:m.items,positionBasedTotal:m.positionBasedTotal,processingTime:Date.now()};a.push(v),console.log(`✅ 스케일 ${i}x 완료:`,{confidence:u,textLength:d.text.length,itemCount:m.items.length,positionBasedTotal:m.positionBasedTotal,preview:d.text.substring(0,100)+"..."}),URL.revokeObjectURL(c)}catch(c){console.error(`❌ 스케일 ${i}x 처리 실패:`,c),a.push({scale:i,confidence:0,text:"",rawOcr:null,items:[],error:c instanceof Error?c.message:"알 수 없는 오류"})}}return console.log("🎯 다중 스케일 OCR 결과 요약:",a.map(o=>({scale:o.scale,confidence:o.confidence,itemCount:o.items.length,hasError:!!o.error}))),a}async preprocessImageWithScale(t,n){return new Promise(r=>{const a=document.createElement("canvas"),o=a.getContext("2d"),i=new Image;i.onload=()=>{const l=Math.round(i.width*n),c=Math.round(i.height*n);a.width=l,a.height=c,o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(i,0,0,l,c);const d=o.getImageData(0,0,l,c),u=d.data;console.log(`🖼️ 스케일 ${n}x 이미지 크기:`,{original:`${i.width}x${i.height}`,scaled:`${l}x${c}`}),this.applyGaussianBlur(u,l,c),this.enhanceContrast(u);const m=this.calculateOptimalThreshold(u);console.log(`📊 스케일 ${n}x 최적 임계값:`,m);for(let v=0;v<u.length;v+=4){const w=u[v]*.299+u[v+1]*.587+u[v+2]*.114>m?255:0;u[v]=u[v+1]=u[v+2]=w}this.applyMorphology(u,l,c),o.putImageData(d,0,0),a.toBlob(v=>{r(URL.createObjectURL(v))},"image/png",1)},i.src=URL.createObjectURL(t)})}selectBestResult(t){var i;if(t.length===0)return console.warn("⚠️ OCR 결과가 없음"),{items:[],confidence:0,rawText:"",totalAmount:0,processedItems:0,errors:["OCR 결과를 찾을 수 없습니다"],warnings:[],suggestions:["이미지를 더 선명하게 촬영해보세요"],usedServices:["tesseract"]};const n=t.filter(l=>!l.error&&l.confidence>0);if(n.length===0){console.warn("⚠️ 유효한 OCR 결과가 없음, 첫 번째 결과 사용");const l=t[0];return{items:l.items||[],confidence:l.confidence||0,rawText:l.text||"",totalAmount:0,processedItems:((i=l.items)==null?void 0:i.length)||0,errors:l.error?[l.error]:["유효한 OCR 결과가 없습니다"],warnings:["OCR 결과의 신뢰도가 낮습니다"],suggestions:["이미지를 더 선명하게 촬영하거나 조명을 개선해보세요"],usedServices:["tesseract"]}}const r=n.map(l=>{const c=l.confidence*.5,d=Math.min(l.items.length/10,1)*.2,u=Math.min(l.text.length/500,1)*.1,m=l.positionBasedTotal>0,v=m?.5:0,j=c+d+u+v;return{...l,totalScore:j,hasTotalAmount:m}}),a=r.reduce((l,c)=>c.totalScore>l.totalScore?c:l);console.log("🏆 최적 결과 선택:",{selectedScale:a.scale,totalScore:a.totalScore.toFixed(3),confidence:a.confidence.toFixed(3),itemCount:a.items.length,textLength:a.text.length,hasTotalAmount:a.hasTotalAmount,positionBasedTotal:a.positionBasedTotal,allScores:r.map(l=>({scale:l.scale,score:l.totalScore.toFixed(3),confidence:l.confidence.toFixed(3),items:l.items.length,totalBonus:l.hasTotalAmount?"✅":"❌",totalAmount:l.positionBasedTotal}))}),console.log("📊 최종 OCR 결과 분석:"),console.log(`📊 발견된 항목 수: ${a.items.length}`),console.log(`📊 전체 신뢰도: ${a.confidence.toFixed(3)}`),a.items.forEach((l,c)=>{console.log(`📋 항목 ${c+1}: "${l.name}" - ${l.price}원 (신뢰도: ${l.confidence.toFixed(2)})`)});const o=a.items.reduce((l,c)=>l+c.price*c.quantity,0);return console.log(`💰 계산된 총액: ${o}원`),{items:a.items,confidence:a.confidence,rawText:a.text,totalAmount:o,processedItems:a.items.length,errors:[],warnings:a.items.length===0?["항목이 발견되지 않았습니다"]:[],suggestions:this.generateQualityFeedback(a,[]).suggestions,usedServices:["tesseract"]}}async terminate(){this.processingQueue.forEach(({reject:t})=>{t(new Error("OCR 서비스가 종료되었습니다"))}),this.processingQueue=[],this.isProcessing=!1,this.imageCache.forEach(t=>{t.startsWith("blob:")&&URL.revokeObjectURL(t)}),this.imageCache.clear(),this.worker&&(await this.worker.terminate(),this.worker=null,this.isInitialized=!1,console.log("🔄 OCR 워커 및 리소스 정리 완료"))}getMemoryUsage(){return{cacheSize:this.imageCache.size,queueLength:this.processingQueue.length,isProcessing:this.isProcessing}}getConfig(){return{...this.config}}extractPositionBasedTotal(t){const n=t.split(`
`).map(o=>o.trim()).filter(o=>o.length>0);console.log("📝 라인별 분석:"),n.forEach((o,i)=>console.log(`  ${i}: "${o}"`));const r=[{keyword:"합계",priority:10},{keyword:"합계:",priority:10},{keyword:"총계",priority:9},{keyword:"총계:",priority:9},{keyword:"총액",priority:8},{keyword:"총액:",priority:8},{keyword:"Total",priority:7},{keyword:"TOTAL",priority:6},{keyword:"합",priority:5},{keyword:"계",priority:4},{keyword:"total",priority:3},{keyword:"소계",priority:2}],a=[];for(const o of n)for(const{keyword:i,priority:l}of r)if(o.includes(i)){console.log(`🎯 키워드 '${i}' 발견 라인: "${o}"`);const c=this.extractAmountsFromLine(o);c.length>0&&c.forEach(d=>{const u=this.calculateAmountConfidence(d,o,i);a.push({amount:d,confidence:u+l/10,source:`키워드(${i})`}),console.log(`💰 후보 금액: ${d}원 (신뢰도: ${u.toFixed(2)}, 키워드: ${i})`)})}if(a.length===0){console.log('🔍 키워드 없음. "원"으로 끝나는 금액 검색...');for(const o of n)o.includes("원")&&this.extractAmountsFromLine(o).forEach(l=>{if(l>=1e3){const c=this.calculateAmountConfidence(l,o);a.push({amount:l,confidence:c*.5,source:"원 패턴"})}})}if(a.length>0){a.sort((i,l)=>l.confidence-i.confidence),console.log("📊 후보 금액들:"),a.forEach((i,l)=>{console.log(`  ${l+1}. ${i.amount}원 (신뢰도: ${i.confidence.toFixed(2)}, 출처: ${i.source})`)});const o=a[0];return console.log(`✅ 선택된 총액: ${o.amount}원 (신뢰도: ${o.confidence.toFixed(2)})`),o.amount}return console.log("❌ 총액 추출 실패"),0}calculateAmountConfidence(t,n,r){let a=.5;return t>=1e4&&(a+=.2),t>=1e5&&(a+=.1),t<=999&&(a-=.3),r&&(a+=.3,["합계","총계","총액"].includes(r)&&(a+=.2)),n.includes("원")&&(a+=.1),(n.includes(",")||n.includes("."))&&(a+=.1),n.match(/\d{2,3}[,\.]\d{3}/)&&(a+=.2),Math.min(Math.max(a,0),1)}extractAmountsFromLine(t){const n=[],r=[/(\d{1,3}[,\.]\d{3,})/g,/(\d{4,7})/g,/(\d{1,3}\s+\d{3,})/g,/(\d{2,3}\s*\.\s*\d{3,})/g];console.log(`  🔍 라인 "${t}"에서 금액 추출 중...`);for(const o of r){const i=[...t.matchAll(o)];for(const l of i){const c=l[1].replace(/[\s,\.]/g,""),d=parseInt(c);!isNaN(d)&&d>=100&&d<=999999&&(n.push(d),console.log(`    ✅ "${l[1]}" → ${d}원`))}}const a=[...new Set(n)].sort((o,i)=>i-o);return console.log(`    💰 추출된 금액들: ${a}`),a}calculateConfidence(t,n){let r=n/100;return t.length<10&&(r*=.8),t.length>1e3&&(r*=1.1),/[가-힣]/.test(t)&&(r*=1.1),/[0-9,원₩]/.test(t)&&(r*=1.05),t.includes(`
`)&&(r*=1.05),Math.min(r,1)}updateConfig(t){this.config={...this.config,...t},console.log("🔄 OCR 설정 업데이트:",t)}applyKoreanOptimizedBlur(t,n,r){const a=[0,1,0,1,8,1,0,1,0],o=12,i=new Uint8ClampedArray(t.length);for(let l=1;l<r-1;l++)for(let c=1;c<n-1;c++){let d=0,u=0,m=0;for(let j=-1;j<=1;j++)for(let w=-1;w<=1;w++){const x=((l+j)*n+(c+w))*4,h=a[(j+1)*3+(w+1)];d+=t[x]*h,u+=t[x+1]*h,m+=t[x+2]*h}const v=(l*n+c)*4;i[v]=d/o,i[v+1]=u/o,i[v+2]=m/o,i[v+3]=t[v+3]}t.set(i)}enhanceKoreanContrast(t){for(let a=0;a<t.length;a+=4){let i=((t[a]*.299+t[a+1]*.587+t[a+2]*.114-128)*1.8+128)*1.1;i=Math.max(0,Math.min(255,i)),t[a]=i,t[a+1]=i,t[a+2]=i}}calculateKoreanOptimalThreshold(t){const n=new Array(256).fill(0);for(let u=0;u<t.length;u+=4){const m=t[u]*.299+t[u+1]*.587+t[u+2]*.114;n[Math.floor(m)]++}const r=t.length/4;let a=0;for(let u=0;u<256;u++)a+=u*n[u];let o=0,i=0,l=0,c=0,d=0;for(let u=0;u<256;u++){if(i+=n[u],i===0)continue;if(l=r-i,l===0)break;o+=u*n[u];const m=o/i,v=(a-o)/l,j=i*l*(m-v)*(m-v);j>c&&(c=j,d=u)}return Math.max(100,Math.min(180,d-10))}applyKoreanMorphology(t,n,r){const a=new Uint8ClampedArray(t.length);a.set(t),this.morphologyErosion(a,n,r,1),this.morphologyDilation(a,n,r,1),this.morphologyDilation(a,n,r,1),this.morphologyErosion(a,n,r,1),t.set(a)}sharpenKoreanCharacters(t,n,r){const a=[0,-1,0,-1,9,-1,0,-1,0],o=new Uint8ClampedArray(t.length);for(let i=1;i<r-1;i++)for(let l=1;l<n-1;l++){let c=0;for(let m=-1;m<=1;m++)for(let v=-1;v<=1;v++){const j=((i+m)*n+(l+v))*4,w=a[(m+1)*3+(v+1)];c+=t[j]*w}const d=(i*n+l)*4,u=Math.max(0,Math.min(255,c));o[d]=u,o[d+1]=u,o[d+2]=u,o[d+3]=t[d+3]}t.set(o)}morphologyErosion(t,n,r,a){const o=new Uint8ClampedArray(t.length);for(let i=a;i<r-a;i++)for(let l=a;l<n-a;l++){let c=255;for(let u=-a;u<=a;u++)for(let m=-a;m<=a;m++){const v=((i+u)*n+(l+m))*4;c=Math.min(c,t[v])}const d=(i*n+l)*4;o[d]=c,o[d+1]=c,o[d+2]=c,o[d+3]=t[d+3]}t.set(o)}morphologyDilation(t,n,r,a){const o=new Uint8ClampedArray(t.length);for(let i=a;i<r-a;i++)for(let l=a;l<n-a;l++){let c=0;for(let u=-a;u<=a;u++)for(let m=-a;m<=a;m++){const v=((i+u)*n+(l+m))*4;c=Math.max(c,t[v])}const d=(i*n+l)*4;o[d]=c,o[d+1]=c,o[d+2]=c,o[d+3]=t[d+3]}t.set(o)}validateImageFile(t){const n=[];return t.size>10*1024*1024?{isValid:!1,error:"파일 크기가 너무 큽니다 (최대 10MB)",suggestions:["이미지를 압축하거나 크기를 줄여주세요","고해상도보다는 적당한 품질의 이미지를 사용하세요"]}:t.type.startsWith("image/")?(["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(t.type)||n.push("JPG, PNG 형식을 권장합니다 (더 나은 OCR 성능)"),{isValid:!0,suggestions:n}):{isValid:!1,error:"이미지 파일만 업로드할 수 있습니다",suggestions:["JPG, PNG, GIF, WebP 형식의 이미지를 사용해주세요"]}}generateQualityFeedback(t,n){const r=[],a=[];t.confidence<.3?(r.push("OCR 신뢰도가 매우 낮습니다"),a.push("이미지를 더 선명하게 촬영해보세요"),a.push("조명이 충분한 환경에서 다시 촬영해주세요")):t.confidence<.6&&(r.push("OCR 신뢰도가 낮습니다"),a.push("결과를 수동으로 확인하고 수정해주세요"));const o=t.items||[];return o.length===0?(r.push("인식된 항목이 없습니다"),a.push("영수증 전체가 이미지에 포함되어 있는지 확인하세요"),a.push("글자가 선명하고 잘 보이는지 확인하세요")):o.length<3&&a.push("항목이 적게 인식되었습니다. 누락된 항목이 있는지 확인해보세요"),(!t.positionBasedTotal||t.positionBasedTotal<=0)&&(r.push("총액을 찾을 수 없습니다"),a.push('"합계", "총액" 등의 텍스트가 선명하게 보이는지 확인하세요')),n.length>1&&this.calculateVariance(n.map(l=>l.confidence))>.1&&(r.push("스케일별 결과가 일관되지 않습니다"),a.push("이미지 품질을 개선하면 더 안정적인 결과를 얻을 수 있습니다")),{warnings:r,suggestions:a}}getErrorMessage(t){var n,r,a,o,i,l;return(n=t.message)!=null&&n.includes("Worker")?"OCR 엔진 초기화에 실패했습니다":(r=t.message)!=null&&r.includes("network")||(a=t.message)!=null&&a.includes("fetch")?"네트워크 연결 문제로 OCR 처리에 실패했습니다":(o=t.message)!=null&&o.includes("memory")||(i=t.message)!=null&&i.includes("Memory")?"메모리 부족으로 처리에 실패했습니다":(l=t.message)!=null&&l.includes("timeout")?"처리 시간이 초과되었습니다":t.message||"알 수 없는 오류가 발생했습니다"}getErrorSuggestions(t){var r,a,o,i,l,c;const n=[];return(r=t.message)!=null&&r.includes("Worker")?(n.push("페이지를 새로고침하고 다시 시도해주세요"),n.push("브라우저를 재시작해보세요")):(a=t.message)!=null&&a.includes("network")||(o=t.message)!=null&&o.includes("fetch")?(n.push("인터넷 연결을 확인하고 다시 시도해주세요"),n.push("잠시 후 다시 시도해주세요")):(i=t.message)!=null&&i.includes("memory")||(l=t.message)!=null&&l.includes("Memory")?(n.push("이미지 크기를 줄여서 다시 시도해주세요"),n.push("다른 탭이나 프로그램을 종료하고 다시 시도해주세요")):(c=t.message)!=null&&c.includes("timeout")?(n.push("이미지 크기를 줄여서 다시 시도해주세요"),n.push("네트워크 연결을 확인해주세요")):(n.push("이미지 품질을 확인하고 다시 시도해주세요"),n.push("문제가 지속되면 페이지를 새로고침해주세요")),n}calculateVariance(t){if(t.length===0)return 0;const n=t.reduce((a,o)=>a+o,0)/t.length;return t.map(a=>Math.pow(a-n,2)).reduce((a,o)=>a+o,0)/t.length}}const xn=new Ml,Ll="modulepreload",Dl=function(s){return"/"+s},gn={},vn=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(n.map(c=>{if(c=Dl(c),c in gn)return;gn[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":Ll,d||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((v,j)=>{m.addEventListener("load",v),m.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})};class _l{constructor(){ue(this,"config");ue(this,"currentMode");ue(this,"usageData",new Map);this.config={mode:"offline",apiKey:void 0,fallbackToOffline:!0},this.currentMode=this.config.mode,this.loadUsageData(),console.log(`🤖 FreeAI Service 초기화 완료 - 모드: ${this.currentMode}`)}updateConfig(t){this.config={...this.config,...t},this.currentMode=this.config.mode,console.log(`🔄 설정 업데이트: ${JSON.stringify(t)}`)}getConfig(){return{...this.config}}async enhanceOCRResult(t,n=[]){console.log(`🔍 OCR 결과 개선 시작 - 모드: ${this.currentMode}`);try{switch(this.currentMode){case"mock":return this.getMockEnhancement(t,n);case"free":return await this.tryFreeAPIs(t,n);case"custom":if(this.config.apiKey)return await this.useCustomAPI(t,n);case"offline":default:return this.getOfflineEnhancement(t,n)}}catch(r){if(console.error("❌ AI 개선 실패:",r),this.config.fallbackToOffline)return console.log("🔄 오프라인 모드로 폴백"),this.getOfflineEnhancement(t,n);throw r}}getMockEnhancement(t,n){console.log("🎭 Mock 모드로 결과 생성");const a=(t.match(/[\d,]+원?/g)||[]).slice(0,5).map((i,l)=>{const c=parseInt(i.replace(/[^\d]/g,""));return{id:`mock-${Date.now()}-${l}`,name:`Mock 항목 ${l+1}`,price:c,quantity:1,confidence:.9}}),o=a.reduce((i,l)=>i+l.price,0);return{items:a,totalAmount:o,confidence:.9,corrections:["Mock 모드에서 생성된 데이터입니다"],suggestions:["실제 환경에서는 AI API를 사용해보세요"],usedService:"mock"}}async tryFreeAPIs(t,n){const r=["gemini","huggingface"];for(const a of r)try{if(this.checkServiceAvailability(a))switch(console.log(`🔄 ${a} API 시도 중...`),a){case"gemini":return await this.useGeminiAPI(t,n);case"huggingface":return await this.useHuggingFaceAPI(t,n)}}catch(o){console.warn(`⚠️ ${a} API 실패:`,o),this.updateUsageData(a,"error")}return console.log("🔄 모든 무료 API 실패, 오프라인 모드 사용"),this.getOfflineEnhancement(t,n)}async useGeminiAPI(t,n){const{geminiService:r}=await vn(async()=>{const{geminiService:o}=await import("./geminiService-B_u4aei_.js");return{geminiService:o}},__vite__mapDeps([0,1]));if(!r.getUsageInfo().isAvailable)throw new Error("Gemini API 사용 불가");const a=await r.enhanceOCRResult(t,n);return this.updateUsageData("gemini","success"),{...a,usedService:"gemini"}}async useHuggingFaceAPI(t,n){throw new Error("Hugging Face 토큰이 설정되지 않음")}async useCustomAPI(t,n){const{geminiService:r}=await vn(async()=>{const{geminiService:a}=await import("./geminiService-B_u4aei_.js");return{geminiService:a}},__vite__mapDeps([0,1]));if(this.config.apiKey&&this.config.apiKey!=="optional")return r.initialize({apiKey:this.config.apiKey}),{...await r.enhanceOCRResult(t,n),usedService:"gemini"};throw new Error("사용자 API 키가 설정되지 않음")}getOfflineEnhancement(t,n){console.log("🔧 오프라인 모드로 처리");const r=this.extractPricesOffline(t),a=r.reduce((o,i)=>o+i.price,0);return{items:r,totalAmount:a,confidence:.7,corrections:["오프라인 모드에서 처리됨"],suggestions:["더 정확한 결과를 위해 AI API 사용을 권장합니다"],usedService:"offline"}}extractPricesOffline(t){const n=t.split(`
`).filter(i=>i.trim()),r=[],a={namePrice:/^(.+?)\s+([\d,]+)원?$/,priceFirst:/^([\d,]+)원?\s+(.+)$/,priceOnly:/([\d,]+)원?/g};let o=0;for(const i of n){const l=i.trim();if(l.length<2)continue;const c=l.match(a.namePrice);if(c){const[,u,m]=c,v=parseInt(m.replace(/[^\d]/g,""));if(v>0&&u.length>0){r.push({id:`offline-${Date.now()}-${o++}`,name:u.trim(),price:v,quantity:1,confidence:.8});continue}}const d=l.match(a.priceFirst);if(d){const[,u,m]=d,v=parseInt(u.replace(/[^\d]/g,""));if(v>0&&m.length>0){r.push({id:`offline-${Date.now()}-${o++}`,name:m.trim(),price:v,quantity:1,confidence:.7});continue}}}return r.length===0&&(t.match(a.priceOnly)||[]).forEach((l,c)=>{const d=parseInt(l.replace(/[^\d]/g,""));d>0&&r.push({id:`offline-${Date.now()}-${c}`,name:`항목 ${c+1}`,price:d,quantity:1,confidence:.6})}),r.slice(0,10)}checkServiceAvailability(t){const n=this.usageData.get(t)||{used:0,limit:1e3,lastReset:Date.now()},r=Date.now(),a=24*60*60*1e3;return r-n.lastReset>a&&(n.used=0,n.lastReset=r,this.usageData.set(t,n)),n.used<n.limit}updateUsageData(t,n){const r=this.usageData.get(t)||{used:0,limit:1e3,lastReset:Date.now()};n==="success"&&r.used++,this.usageData.set(t,r),this.saveUsageData()}loadUsageData(){try{const t=localStorage.getItem("freeAI-usage");if(t){const n=JSON.parse(t);this.usageData=new Map(Object.entries(n))}}catch(t){console.warn("사용량 데이터 로드 실패:",t)}}saveUsageData(){try{const t=Object.fromEntries(this.usageData);localStorage.setItem("freeAI-usage",JSON.stringify(t))}catch(t){console.warn("사용량 데이터 저장 실패:",t)}}getUsageInfo(){return["gemini","huggingface"].map(n=>{const r=this.usageData.get(n)||{used:0,limit:1e3,lastReset:Date.now()},a=new Date(r.lastReset+24*60*60*1e3).toLocaleString("ko-KR");return{service:n,dailyUsed:r.used,dailyLimit:r.limit,remaining:Math.max(0,r.limit-r.used),resetTime:a}})}getCurrentMode(){return this.currentMode}resetUsage(){this.usageData.clear(),localStorage.removeItem("freeAI-usage"),console.log("🔄 사용량 데이터 초기화 완료")}}const fe=new _l;class Fl{constructor(){ue(this,"config",{useAI:!0,aiMode:"offline",preprocessImage:!0,confidenceThreshold:.6,maxItems:20});this.loadConfig()}loadConfig(){const n="offline",r=parseFloat("0.6");this.config={...this.config,useAI:!1,aiMode:n,confidenceThreshold:r},console.log("🔧 Receipt Analyzer 설정 로드:",this.config)}async analyzeReceipt(t,n){const r=Date.now();let a,o=null;const i=[],l=["ocr"];try{if(n==null||n({stage:"ocr",progress:0,message:"OCR 처리 시작...",subStage:"initializing"}),a=await xn.recognizeImage(t,m=>{n==null||n({stage:"ocr",progress:Math.round(m.progress*.6),message:m.message,subStage:m.stage})}),a.errors.length>0&&i.push(...a.errors),this.config.useAI&&a.items.length>0)try{n==null||n({stage:"ai_enhancement",progress:60,message:"AI로 결과 개선 중...",subStage:"processing"}),fe.updateConfig({mode:this.config.aiMode,fallbackToOffline:!0}),o=await fe.enhanceOCRResult(a.rawText||"",a.items),l.push("ai",o.usedService),n==null||n({stage:"ai_enhancement",progress:80,message:"AI 향상 완료",subStage:"complete"})}catch(m){console.warn("⚠️ AI 향상 실패, OCR 결과만 사용:",m),i.push(`AI 향상 실패: ${m instanceof Error?m.message:"알 수 없는 오류"}`)}n==null||n({stage:"processing",progress:85,message:"결과 통합 중...",subStage:"merging"});const c=this.mergeResults(a,o),d=Date.now()-r;n==null||n({stage:"complete",progress:100,message:`분석 완료! ${c.length}개 항목 발견`,subStage:"finished"});const u={items:c,rawText:a.rawText||"",totalAmount:c.reduce((m,v)=>m+v.price*v.quantity,0),confidence:this.calculateOverallConfidence(a,o),ocrConfidence:a.confidence,aiConfidence:o==null?void 0:o.confidence,processingTime:d,processedItems:c.length,errors:i,warnings:a.warnings||[],suggestions:this.generateSuggestions(a,o,c),usedServices:l};return console.log(`✅ Receipt Analysis 완료: ${c.length}개 항목, ${d}ms`),u}catch(c){return console.error("❌ Receipt Analysis 실패:",c),n==null||n({stage:"error",progress:0,message:"분석 중 오류 발생",subStage:"error"}),{items:[],rawText:"",totalAmount:0,confidence:0,ocrConfidence:0,processingTime:Date.now()-r,processedItems:0,errors:[c instanceof Error?c.message:"알 수 없는 오류가 발생했습니다"],warnings:[],suggestions:["이미지 품질을 확인하고 다시 시도해주세요"],usedServices:l}}}mergeResults(t,n){const r=[];n&&n.items.length>0?(r.push(...n.items.map(i=>({...i,source:"ai",isSelected:!0}))),console.log(`🤖 AI 결과 사용: ${n.items.length}개 항목, 서비스: ${n.usedService}`)):(r.push(...t.items.map(i=>({...i,source:"ocr",isSelected:i.confidence>=this.config.confidenceThreshold}))),console.log(`🔍 OCR 결과 사용: ${t.items.length}개 항목`));const a=r.filter(i=>i.confidence>=this.config.confidenceThreshold);return this.removeDuplicates(a).slice(0,this.config.maxItems)}removeDuplicates(t){const n=[];for(const r of t)n.some(o=>{const i=this.calculateSimilarity(r.name,o.name)>.8,l=Math.abs(r.price-o.price)<=100;return i&&l})||n.push(r);return n}calculateSimilarity(t,n){const r=new Set(t.toLowerCase().split("")),a=new Set(n.toLowerCase().split("")),o=new Set([...r].filter(l=>a.has(l))),i=new Set([...r,...a]);return o.size/i.size}calculateOverallConfidence(t,n){return n?t.confidence*.4+n.confidence*.6:t.confidence}generateSuggestions(t,n,r){const a=[];r.length===0&&a.push("항목을 찾을 수 없습니다. 이미지를 더 선명하게 촬영해보세요"),t.confidence<.7&&a.push("OCR 신뢰도가 낮습니다. 이미지 품질을 개선하거나 수동으로 편집하세요"),!n&&this.config.useAI&&a.push("AI 향상을 사용할 수 없습니다. API 키를 확인하거나 오프라인 모드를 사용하세요");const o=r.filter(i=>i.confidence<.8);return o.length>0&&a.push(`${o.length}개 항목의 신뢰도가 낮습니다. 수동 확인을 권장합니다`),n&&n.suggestions.length>0&&a.push(...n.suggestions),a}updateConfig(t){this.config={...this.config,...t},console.log("🔄 Receipt Analyzer 설정 업데이트:",t)}getConfig(){return{...this.config}}getAIUsageInfo(){return fe.getUsageInfo()}async getServiceStatus(){const t=xn.getConfig(),n=fe.getConfig(),r=fe.getUsageInfo();return{ocr:{ready:!0,languages:t.languages,confidence:t.confidenceThreshold},ai:{ready:n.mode!=="custom"||!!n.apiKey,mode:n.mode,usage:r},analyzer:{ready:!0,config:this.config}}}}const Bl=new Fl;class zl{constructor(){ue(this,"STORAGE_KEY","calculation_history")}getAll(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(!t)return this.getInitialData();const n=JSON.parse(t);return Array.isArray(n)?n:this.getInitialData()}catch(t){return console.error("히스토리 데이터 로딩 오류:",t),this.getInitialData()}}add(t){const n={...t,id:this.generateId(),createdAt:Date.now()},r=this.getAll(),a=[n,...r];return this.save(a),n}update(t,n){const r=this.getAll(),a=r.findIndex(o=>o.id===t);return a===-1?!1:(r[a]={...r[a],...n},this.save(r),!0)}delete(t){const n=this.getAll(),r=n.filter(a=>a.id!==t);return r.length===n.length?!1:(this.save(r),!0)}deleteMultiple(t){const n=this.getAll(),r=n.filter(o=>!t.includes(o.id)),a=n.length-r.length;return a>0&&this.save(r),a}getById(t){return this.getAll().find(n=>n.id===t)||null}search(t){const n=this.getAll(),r=t.toLowerCase();return n.filter(a=>a.name.toLowerCase().includes(r)||a.date.includes(t))}save(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(n){console.error("히스토리 데이터 저장 오류:",n)}}generateId(){return`calc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}getInitialData(){const t=[{id:"1",name:"카페 모임",date:"2024-01-15",total:45600,participants:4,items:8,status:"completed",createdAt:new Date("2024-01-15").getTime()},{id:"2",name:"점심 회식",date:"2024-01-14",total:128e3,participants:6,items:12,status:"shared",createdAt:new Date("2024-01-14").getTime()},{id:"3",name:"알배달 주문",date:"2024-01-13",total:32400,participants:3,items:5,status:"pending",createdAt:new Date("2024-01-13").getTime()},{id:"4",name:"노래방 모임",date:"2024-01-12",total:67800,participants:5,items:7,status:"completed",createdAt:new Date("2024-01-12").getTime()},{id:"5",name:"마트 장보기",date:"2024-01-11",total:156700,participants:2,items:15,status:"shared",createdAt:new Date("2024-01-11").getTime()},{id:"6",name:"치킨 야식",date:"2024-01-10",total:89200,participants:4,items:6,status:"completed",createdAt:new Date("2024-01-10").getTime()},{id:"7",name:"술집 모임",date:"2024-12-28",total:245e3,participants:8,items:18,status:"completed",createdAt:new Date("2024-12-28").getTime()},{id:"8",name:"카페 스터디",date:"2024-12-25",total:28900,participants:3,items:4,status:"shared",createdAt:new Date("2024-12-25").getTime()}];return this.save(t),t}reset(){localStorage.removeItem(this.STORAGE_KEY)}getStatsData(){const t=this.getAll(),n=new Date;return n.setMonth(n.getMonth()-12),t.filter(r=>new Date(r.date)>=n)}}const Le=new zl,dt=({className:s=""})=>{const[t,n]=f.useState("input"),[r,a]=f.useState("receipt"),[o,i]=f.useState([]),[l,c]=f.useState([]),[d,u]=f.useState(""),[m,v]=f.useState("pending"),[j,w]=f.useState(!1),[x,h]=f.useState(null),[b,p]=f.useState(null),[g,y]=f.useState(null),N=f.useCallback(async R=>{y(R),w(!0),p(null);try{const $=await Bl.analyzeReceipt(R,U=>{h(U)});p($);const D=$.items.map(U=>({id:U.id,name:U.name,price:U.price,quantity:U.quantity,assignedParticipants:[]}));c(D),$.items.length>0&&setTimeout(()=>{n("participants")},1500)}catch($){console.error("영수증 분석 실패:",$)}finally{w(!1)}},[]),S=f.useCallback(R=>{console.log("📋 계산기로 가져오기 버튼 클릭됨",R);const $=R.map(D=>({id:D.id,name:D.name,price:D.price,quantity:D.quantity,assignedParticipants:[]}));c($),n("participants")},[]),C=f.useCallback((R,$)=>{if(!b)return;const D={...b,items:b.items.map(U=>U.id===R?{...U,isSelected:$}:U)};p(D)},[b]),E=f.useCallback(()=>{console.log("🔄 분석 재시작 버튼 클릭됨",g),g&&N(g)},[g,N]),F=f.useCallback(R=>{if(console.log("✏️ 항목 편집 버튼 클릭됨",R),!b)return;const $={...b,items:b.items.map(D=>D.id===R.id?R:D)};p($)},[b]),k=f.useCallback(R=>{if(console.log("🗑️ 항목 삭제 버튼 클릭됨",R),!b)return;const $={...b,items:b.items.filter(D=>D.id!==R)};p($)},[b]),L=f.useCallback(()=>{if(console.log("➕ 항목 추가 버튼 클릭됨"),!b)return;const R={id:Date.now().toString(),name:"",price:0,quantity:1,confidence:1,source:"manual",isSelected:!0},$={...b,items:[...b.items,R]};p($)},[b]),P=f.useCallback(()=>{const R={id:Date.now().toString(),name:"",price:0,quantity:1,assignedParticipants:[]};c($=>[...$,R])},[]),W=f.useCallback((R,$)=>{c(D=>D.map(U=>U.id===R?{...U,...$}:U))},[]),H=f.useCallback(R=>{c($=>$.filter(D=>D.id!==R))},[]),X=f.useCallback(()=>{const R={id:Date.now().toString(),name:"",color:`#${Math.floor(Math.random()*16777215).toString(16)}`};i($=>[...$,R])},[]),B=f.useCallback((R,$)=>{i(D=>D.map(U=>U.id===R?{...U,...$}:U))},[]),A=f.useCallback(R=>{i($=>$.filter(D=>D.id!==R)),c($=>$.map(D=>{var U;return{...D,assignedParticipants:((U=D.assignedParticipants)==null?void 0:U.filter(O=>O!==R))||[]}}))},[]),I=f.useCallback((R,$)=>{c(D=>D.map(U=>{if(U.id===R){const O=U.assignedParticipants||[],G=O.includes($);return{...U,assignedParticipants:G?O.filter(ee=>ee!==$):[...O,$]}}return U}))},[]),M=f.useCallback(()=>{n("results")},[]),_=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"항목 입력 방법 선택"}),e.jsx("p",{className:"text-gray-600",children:"영수증을 촬영하거나 직접 입력하세요"})]}),e.jsxs(Sl,{value:r,onValueChange:R=>a(R),className:"w-full",children:[e.jsxs(Tr,{className:"grid w-full grid-cols-2",children:[e.jsxs(Cs,{value:"receipt",className:"flex items-center space-x-2",children:[e.jsx(Eo,{className:"w-4 h-4"}),e.jsx("span",{children:"영수증 촬영"})]}),e.jsxs(Cs,{value:"manual",className:"flex items-center space-x-2",children:[e.jsx(tn,{className:"w-4 h-4"}),e.jsx("span",{children:"직접 입력"})]})]}),e.jsxs(As,{value:"receipt",className:"space-y-6 mt-6",children:[e.jsx(Cl,{onFileSelect:N,isProcessing:j}),x&&e.jsx(Ol,{progress:x}),b&&e.jsx($l,{result:b,onItemToggle:C,onItemEdit:F,onItemDelete:k,onAddItem:L,onRetry:E,onUseResults:S})]}),e.jsxs(As,{value:"manual",className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"steel-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"수동 입력"}),e.jsxs(T,{onClick:P,variant:"outline",className:"tech-border",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"항목 추가"]})]}),e.jsxs("div",{className:"space-y-4",children:[l.map((R,$)=>e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(ge,{children:"항목명"}),e.jsx(me,{value:R.name,onChange:D=>W(R.id,{name:D.target.value}),placeholder:"항목명을 입력하세요"})]}),e.jsxs("div",{children:[e.jsx(ge,{children:"가격"}),e.jsx(me,{type:"number",value:R.price,onChange:D=>W(R.id,{price:Number(D.target.value)}),placeholder:"0"})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ge,{children:"수량"}),e.jsx(me,{type:"number",value:R.quantity,onChange:D=>W(R.id,{quantity:Number(D.target.value)}),min:"1"})]}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>H(R.id),className:"text-red-600 hover:text-red-700",children:e.jsx(ft,{className:"w-4 h-4"})})]})]})},R.id)),l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(tn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"항목을 추가해주세요"})]})]})]}),l.length>0&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(T,{onClick:()=>n("participants"),className:"bg-blue-600 hover:bg-blue-700",children:["다음 단계",e.jsx(Ro,{className:"w-4 h-4 ml-2"})]})})]})]})]}),z=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"참가자 및 항목 할당"}),e.jsx("p",{className:"text-gray-600",children:"참가자를 추가하고 각 항목을 할당하세요"})]}),e.jsxs(T,{variant:"outline",onClick:()=>n("input"),className:"tech-border",children:[e.jsx(sn,{className:"w-4 h-4 mr-2"}),"이전 단계"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsxs(Z,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(Pt,{className:"w-5 h-5"}),e.jsx("span",{children:"참가자"})]}),e.jsxs(T,{onClick:X,size:"sm",variant:"outline",className:"tech-border",children:[e.jsx(Je,{className:"w-4 h-4 mr-1"}),"추가"]})]})}),e.jsxs(q,{className:"space-y-4",children:[o.map((R,$)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:R.color}}),e.jsx(me,{value:R.name,onChange:D=>B(R.id,{name:D.target.value}),placeholder:`참가자 ${$+1}`,className:"flex-1"}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>A(R.id),className:"text-red-600 hover:text-red-700",children:e.jsx(ft,{className:"w-4 h-4"})})]},R.id)),o.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Pt,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"참가자를 추가해주세요"})]})]})]}),e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsxs(Z,{className:"flex items-center space-x-2",children:[e.jsx(Ce,{className:"w-5 h-5"}),e.jsx("span",{children:"항목 할당"})]})}),e.jsxs(q,{className:"space-y-4",children:[l.map(R=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:R.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[R.price.toLocaleString(),"원 × ",R.quantity," = ",(R.price*R.quantity).toLocaleString(),"원"]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map($=>{var U;const D=((U=R.assignedParticipants)==null?void 0:U.includes($.id))||!1;return e.jsx("button",{onClick:()=>I(R.id,$.id),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${D?"bg-blue-100 text-blue-800 border-2 border-blue-300":"bg-gray-100 text-gray-600 border-2 border-gray-200 hover:bg-gray-200"}`,children:$.name||`참가자 ${o.indexOf($)+1}`},$.id)})}),(!R.assignedParticipants||R.assignedParticipants.length===0)&&e.jsx("p",{className:"text-sm text-amber-600 mt-2",children:"⚠️ 참가자를 선택해주세요"})]},R.id)),l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ce,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"할당할 항목이 없습니다"})]})]})]})]}),o.length>0&&l.length>0&&l.every(R=>R.assignedParticipants&&R.assignedParticipants.length>0)&&e.jsx("div",{className:"flex justify-center",children:e.jsxs(T,{onClick:M,className:"bg-green-600 hover:bg-green-700 px-8 py-3",children:[e.jsx(Ce,{className:"w-5 h-5 mr-2"}),"계산하기"]})})]}),oe=()=>{const R=l.reduce((D,U)=>D+U.price*U.quantity,0),$=o.map(D=>{const U=l.filter(G=>{var ee;return(ee=G.assignedParticipants)==null?void 0:ee.includes(D.id)}),O=U.reduce((G,ee)=>{var Q;const te=((Q=ee.assignedParticipants)==null?void 0:Q.length)||1;return G+ee.price*ee.quantity/te},0);return{participant:D,total:Math.round(O),items:U}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"계산 결과"}),e.jsx("p",{className:"text-gray-600",children:"각 참가자별 지불 금액입니다"})]}),e.jsxs(T,{variant:"outline",onClick:()=>n("participants"),className:"tech-border",children:[e.jsx(sn,{className:"w-4 h-4 mr-2"}),"수정하기"]})]}),e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsxs(Z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"분할 결과"}),e.jsxs(he,{className:"bg-blue-100 text-blue-800",children:["총 ",R.toLocaleString(),"원"]})]})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"calculation-name",className:"text-sm font-medium",children:"계산 이름 (선택사항)"}),e.jsx(me,{id:"calculation-name",type:"text",placeholder:"예: 친구들과 저녁식사, 카페 모임...",value:d,onChange:D=>u(D.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(ge,{className:"text-sm font-medium block mb-2",children:"정산 상태"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>v("pending"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${m==="pending"?"bg-yellow-100 text-yellow-800 border-2 border-yellow-300":"bg-gray-100 text-gray-600 border-2 border-transparent hover:bg-gray-200"}`,children:"🟡 대기중 (계산만 완료)"}),e.jsx("button",{type:"button",onClick:()=>v("shared"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${m==="shared"?"bg-blue-100 text-blue-800 border-2 border-blue-300":"bg-gray-100 text-gray-600 border-2 border-transparent hover:bg-gray-200"}`,children:"🔵 공유됨 (정산 진행중)"}),e.jsx("button",{type:"button",onClick:()=>v("completed"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${m==="completed"?"bg-green-100 text-green-800 border-2 border-green-300":"bg-gray-100 text-gray-600 border-2 border-transparent hover:bg-gray-200"}`,children:"🟢 완료 (정산 완료)"})]})]})]}),$.map(({participant:D,total:U,items:O})=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:D.color}}),e.jsx("span",{className:"font-medium text-gray-800",children:D.name||`참가자 ${o.indexOf(D)+1}`})]}),e.jsxs(he,{className:"bg-green-100 text-green-800 text-lg font-bold",children:[U.toLocaleString(),"원"]})]}),e.jsx("div",{className:"text-sm text-gray-600 space-y-1",children:O.map(G=>{var Q;const ee=((Q=G.assignedParticipants)==null?void 0:Q.length)||1,te=Math.round(G.price*G.quantity/ee);return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[G.name,ee>1&&` (${ee}명 분할)`]}),e.jsxs("span",{children:[te.toLocaleString(),"원"]})]},G.id)})})]},D.id))]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(T,{variant:"outline",onClick:()=>{n("input"),a("receipt"),c([]),i([]),u(""),v("pending"),p(null),y(null)},className:"flex-1 tech-border",children:"새 계산하기"}),e.jsx(T,{onClick:()=>{const D=d.trim()||`${o.length}명 계산 (${new Date().toLocaleDateString()})`,U=new Date().toISOString().split("T")[0];Le.add({name:D,date:U,total:R,participants:o.length,items:l.length,status:m,details:{participantList:o.map(O=>O.name),itemList:l.map(O=>({name:O.name,price:O.price,quantity:O.quantity})),participantTotals:$.reduce((O,{participant:G,total:ee})=>(O[G.name]=ee,O),{})}}),alert(`계산 결과가 저장되었습니다!
제목: ${D}`),n("input"),c([]),i([]),u(""),v("pending"),p(null),y(null)},className:"flex-1 bg-blue-600 hover:bg-blue-700",children:"결과 저장"})]})]})};return e.jsx("div",{className:`container mx-auto p-4 max-w-6xl ${s}`,children:e.jsxs(V,{className:"steel-panel animated-border",children:[e.jsxs(J,{className:"hud-element rounded-t-lg",children:[e.jsxs(Z,{className:"tech-title flex items-center space-x-3",children:[e.jsx(Ce,{className:"w-6 h-6"}),e.jsx("span",{children:"스마트 영수증 분할 계산기"})]}),e.jsx("div",{className:"flex items-center space-x-4 mt-4",children:[{key:"input",label:"항목 입력",icon:gs},{key:"participants",label:"참가자 할당",icon:Pt},{key:"results",label:"계산 결과",icon:ys}].map(({key:R,label:$,icon:D})=>{const U=t===R,O=["input","participants","results"].indexOf(t)>["input","participants","results"].indexOf(R);return e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-all ${U?"bg-blue-100 text-blue-800 border border-blue-300":O?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:$})]},R)})})]}),e.jsxs(q,{className:"p-6",children:[t==="input"&&_(),t==="participants"&&z(),t==="results"&&oe()]})]})})},jt=ie.forwardRef(({className:s,variant:t="default",size:n="default",shimmerColor:r,shimmerDuration:a=2,shimmerDelay:o=0,loading:i=!1,success:l=!1,disabled:c,children:d,...u},m)=>{const[v,j]=ie.useState(!1),w={default:"bg-primary text-primary-foreground hover:bg-primary/90 focus-visible:ring-primary",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 focus-visible:ring-destructive",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground focus-visible:ring-accent",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 focus-visible:ring-secondary",ghost:"hover:bg-accent hover:text-accent-foreground focus-visible:ring-accent",link:"text-primary underline-offset-4 hover:underline focus-visible:ring-primary"},x={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"},h=()=>r||(l?"#10b981":t==="destructive"?"#ef4444":t==="outline"||t==="ghost"||t==="secondary"?"#64748b":"#ffffff");return e.jsxs("button",{ref:m,className:Y("relative inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50","overflow-hidden",w[t],x[n],s),disabled:c||i,onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),...u,children:[e.jsx(Ne.div,{className:"absolute inset-0 opacity-0",style:{background:`linear-gradient(45deg, transparent 30%, ${h()}40 50%, transparent 70%)`},animate:v&&!c&&!i?{x:["-200%","200%"],opacity:[0,1,0]}:{opacity:0},transition:{duration:a,delay:o,ease:"easeInOut",repeat:v?1/0:0,repeatDelay:.5}}),l&&e.jsx(Ne.div,{className:"absolute inset-0",style:{background:`linear-gradient(45deg, transparent 30%, ${h()}60 50%, transparent 70%)`},initial:{x:"-200%",opacity:0},animate:{x:["200%","-200%"],opacity:[0,1,0]},transition:{duration:1.5,ease:"easeInOut"}}),e.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[i&&e.jsx(Ne.div,{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),l&&!i&&e.jsx(Ne.svg,{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",initial:{scale:0,rotate:-45},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:500,damping:25},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),d]}),e.jsx(Ne.div,{className:"absolute inset-0 rounded-[inherit]",initial:!1,animate:v?{boxShadow:["0 0 0 0px rgba(255,255,255,0.3)","0 0 0 8px rgba(255,255,255,0)"]}:{},transition:{duration:.4}})]})});jt.displayName="ShinyButton";const Ul=ie.forwardRef(({action:s,isActive:t=!1,progress:n,children:r,...a},o)=>{const l={upload:{shimmerColor:"#3b82f6",variant:"default",defaultChildren:"영수증 업로드"},process:{shimmerColor:"#8b5cf6",variant:"secondary",defaultChildren:"OCR 처리"},analyze:{shimmerColor:"#06b6d4",variant:"outline",defaultChildren:"텍스트 분석"},calculate:{shimmerColor:"#10b981",variant:"default",defaultChildren:"금액 계산"},reset:{shimmerColor:"#ef4444",variant:"destructive",defaultChildren:"다시 시작"}}[s];return e.jsxs(jt,{ref:o,variant:l.variant,shimmerColor:l.shimmerColor,shimmerDuration:t?1.5:2,...a,children:[r||l.defaultChildren,n!==void 0&&e.jsxs("span",{className:"ml-2 text-xs opacity-75",children:[Math.round(n),"%"]})]})});Ul.displayName="OCRButton";const Vl=ie.forwardRef(({pulse:s=!1,pulseColor:t,className:n,...r},a)=>e.jsx(Ne.div,{className:"relative",animate:s?{boxShadow:[`0 0 0 0px ${t||"rgba(59, 130, 246, 0.7)"}`,`0 0 0 10px ${t||"rgba(59, 130, 246, 0)"}`]}:{},transition:{duration:2,repeat:s?1/0:0,ease:"easeInOut"},children:e.jsx(jt,{ref:a,className:Y("relative z-10",n),...r})}));Vl.displayName="PulsingShinyButton";const Wl=ie.forwardRef(({orientation:s="horizontal",className:t,children:n},r)=>e.jsx("div",{ref:r,className:Y("flex gap-2",s==="vertical"?"flex-col":"flex-row",t),role:"group",children:n}));Wl.displayName="ShinyButtonGroup";const bn=()=>{const s=Be(),[t,n]=f.useState([{id:"1",name:"커피",price:4500,quantity:2,category:"음료"},{id:"2",name:"샌드위치",price:7800,quantity:1,category:"음식"},{id:"3",name:"케이크",price:5200,quantity:1,category:"디저트"}]),[r,a]=f.useState(null),o=(u,m,v)=>{n(t.map(j=>j.id===u?{...j,[m]:v}:j))},i=()=>{const u={id:Date.now().toString(),name:"새 항목",price:0,quantity:1,category:"기타"};n([...t,u])},l=u=>{n(t.filter(m=>m.id!==u))},c=()=>{console.log("Saving changes...",t),a(null)},d=t.reduce((u,m)=>u+m.price*m.quantity,0);return e.jsx("div",{className:"container mx-auto p-4 max-w-4xl","data-testid":"edit-page",children:e.jsxs(V,{children:[e.jsxs(J,{children:[e.jsx(Z,{"data-testid":"edit-title",children:"OCR 결과 편집"}),e.jsx("p",{className:"text-muted-foreground",children:"OCR로 추출된 영수증 항목들을 확인하고 수정하세요."})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{"data-testid":"ocr-preview",className:"p-4 border rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"원본 영수증 이미지"}),e.jsx("div",{className:"w-32 h-40 bg-gray-200 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:"이미지 미리보기"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:"추출된 항목들"}),e.jsx(T,{"data-testid":"add-item-button",onClick:i,variant:"outline",size:"sm",children:"+ 항목 추가"})]}),t.map((u,m)=>e.jsxs(V,{"data-testid":`editable-item-${m}`,className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx(ge,{children:"상품명"}),r===u.id?e.jsx(me,{"data-testid":`item-name-input-${m}`,value:u.name,onChange:v=>o(u.id,"name",v.target.value)}):e.jsx("p",{className:"font-medium cursor-pointer hover:text-primary",onClick:()=>a(u.id),"data-testid":`edit-item-name-${m}`,children:u.name})]}),e.jsxs("div",{children:[e.jsx(ge,{children:"가격"}),r===u.id?e.jsx(me,{"data-testid":`item-price-input-${m}`,type:"number",value:u.price,onChange:v=>o(u.id,"price",parseInt(v.target.value)||0)}):e.jsxs("p",{className:"cursor-pointer hover:text-primary",onClick:()=>a(u.id),"data-testid":`edit-item-price-${m}`,children:[u.price.toLocaleString(),"원"]})]}),e.jsxs("div",{children:[e.jsx(ge,{children:"수량"}),r===u.id?e.jsx(me,{"data-testid":`item-quantity-${m}`,type:"number",value:u.quantity,onChange:v=>o(u.id,"quantity",parseInt(v.target.value)||1)}):e.jsxs("p",{className:"cursor-pointer hover:text-primary",onClick:()=>a(u.id),"data-testid":`edit-item-quantity-${m}`,children:[u.quantity,"개"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(he,{variant:"secondary",children:u.category}),e.jsx(T,{"data-testid":`remove-item-${m}`,onClick:()=>l(u.id),variant:"destructive",size:"sm",children:"삭제"})]})]}),r===u.id&&e.jsxs("div",{className:"mt-4 flex space-x-2",children:[e.jsx(T,{"data-testid":`save-item-${m}`,onClick:()=>a(null),size:"sm",children:"완료"}),e.jsx(T,{"data-testid":`cancel-edit-${m}`,onClick:()=>a(null),variant:"outline",size:"sm",children:"취소"})]})]},u.id))]}),e.jsx(V,{className:"p-4 bg-primary/5",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-medium",children:"총 금액"}),e.jsxs("span",{"data-testid":"edit-total-amount",className:"text-xl font-bold",children:[d.toLocaleString(),"원"]})]})}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(jt,{"data-testid":"save-changes-button",onClick:c,className:"flex-1",children:"변경사항 저장"}),e.jsx(T,{"data-testid":"cancel-edit-button",variant:"outline",className:"flex-1",onClick:()=>s(-1),children:"취소"})]})]})})]})})};class Hl{constructor(){ue(this,"STORAGE_KEY","calculation_archive")}getAll(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(!t)return[];const n=JSON.parse(t);return Array.isArray(n)?n:[]}catch(t){return console.error("아카이브 데이터 로딩 오류:",t),[]}}add(t){if(t.status!=="completed")throw new Error("완료된 계산만 아카이브할 수 있습니다.");const n={...t,archivedAt:Date.now(),archivedDate:new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},r=this.getAll();return r.unshift(n),this.save(r),n}getById(t){return this.getAll().find(r=>r.id===t)||null}delete(t){const n=this.getAll(),r=n.filter(a=>a.id!==t);return r.length===n.length?!1:(this.save(r),!0)}deleteMultiple(t){const n=this.getAll(),r=n.length,a=n.filter(o=>!t.includes(o.id));return this.save(a),r-a.length}save(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(n){throw console.error("아카이브 데이터 저장 오류:",n),new Error("아카이브 저장 중 오류가 발생했습니다.")}}getStats(){const t=this.getAll(),n=t.reduce((a,o)=>a+o.total,0),r=t.reduce((a,o)=>a+o.participants,0);return{totalArchives:t.length,totalAmount:n,averageAmount:t.length>0?Math.round(n/t.length):0,totalParticipants:r,averageParticipants:t.length>0?Math.round(r/t.length):0}}clear(){try{return localStorage.removeItem(this.STORAGE_KEY),!0}catch(t){return console.error("아카이브 전체 삭제 오류:",t),!1}}}const pt=new Hl,yn=()=>{const s=Be(),{id:t}=ho(),[n,r]=f.useState(null),[a,o]=f.useState([]),[i,l]=f.useState([]),[c,d]=f.useState(!0);f.useEffect(()=>{if(!t){s("/history");return}const A=Le.getById(t);if(!A){alert("계산 기록을 찾을 수 없습니다."),s("/history");return}if(r(A),A.details){const I=A.details.participantList.map((_,z)=>{var oe,R;return{id:`${z+1}`,name:_,email:((R=(oe=A.details)==null?void 0:oe.participantEmails)==null?void 0:R[_])||`${_.toLowerCase()}@example.com`,share:A.details.participantTotals[_]||0}}),M=A.details.itemList.map((_,z)=>({id:`${z+1}`,name:_.name,price:_.price,quantity:_.quantity,category:"기타",assignedParticipants:["1"]}));o(I),l(M)}else{const I=Array.from({length:A.participants},(_,z)=>({id:`${z+1}`,name:`참가자 ${z+1}`,email:`user${z+1}@example.com`,share:Math.round(A.total/A.participants)})),M=[{id:"1",name:A.name,price:A.total,quantity:1,category:"기타",assignedParticipants:I.map(_=>_.id)}];o(I),l(M)}d(!1)},[t,s]);const[u,m]=f.useState(!1),[v,j]=f.useState(""),[w,x]=f.useState(null),[h,b]=f.useState(""),[p,g]=f.useState(!1),[y,N]=f.useState("clipboard"),S=A=>{var I;if((I=n==null?void 0:n.details)!=null&&I.participantTotals){const M=a.find(_=>_.id===A);if(M)return n.details.participantTotals[M.name]||0}return i.reduce((M,_)=>{var oe,R;if(((oe=_.assignedParticipants)==null?void 0:oe.includes(A))||!1){const $=((R=_.assignedParticipants)==null?void 0:R.length)||1;return M+_.price*_.quantity/$}return M},0)},C=(n==null?void 0:n.total)||i.reduce((A,I)=>A+I.price*I.quantity,0);if(c)return e.jsx("div",{className:"container mx-auto p-4 max-w-4xl",children:e.jsx(V,{children:e.jsx(q,{className:"p-8 text-center",children:e.jsx("p",{children:"계산 결과를 불러오는 중..."})})})});const E=()=>{g(!0)},F=async()=>{if(!n)return;const A=a.map(M=>`${M.name}: ${S(M.id).toLocaleString()}원`).join(`
`),I=`💰 ${n.name} - 정산 결과

📅 날짜: ${n.date}
💵 총 금액: ${C.toLocaleString()}원
👥 참가자: ${a.length}명

📋 개별 정산 내역:
${A}

🔗 자세한 내용: ${window.location.href}`;g(!1);try{switch(y){case"clipboard":await k(I);break;case"email":await L(I,A);break;case"kakao":await P(I);break}}catch(M){console.error("전송 실패:",M),j("전송 중 오류가 발생했습니다. 다시 시도해주세요."),m(!0)}},k=async A=>{navigator.clipboard?(await navigator.clipboard.writeText(A),j(`📋 정산 결과가 클립보드에 복사되었습니다!
카카오톡, 문자메시지, 이메일 등에서 Ctrl+V로 붙여넣기 하세요.`)):j(A),m(!0),setTimeout(()=>m(!1),5e3)},L=async(A,I)=>{const M=a.filter(z=>z.email&&z.email.includes("@"));if(M.length===0){j(`⚠️ 유효한 이메일 주소가 없습니다.
참가자 이메일을 먼저 입력해주세요.`),m(!0),setTimeout(()=>m(!1),4e3);return}const _=M.map(z=>{const oe=S(z.id),R=`💰 ${n.name} 정산 알림

안녕하세요! ${n.name}에 대한 정산 결과를 알려드립니다.

📅 날짜: ${n.date}
💵 총 금액: ${C.toLocaleString()}원

👤 ${z.name}님의 정산 금액: ${oe.toLocaleString()}원

🔗 자세한 내용: ${window.location.href}

정산 담당자에게 ${oe.toLocaleString()}원을 송금해주세요.
감사합니다! 😊`,$=`mailto:${z.email}?subject=${encodeURIComponent(`${n.name} - 정산 알림`)}&body=${encodeURIComponent(R)}`;return{participant:z,mailtoLink:$,amount:oe}});_.forEach((z,oe)=>{setTimeout(()=>{window.open(z.mailtoLink,"_blank")},oe*500)}),j(`📧 ${_.length}명에게 이메일 클라이언트가 열렸습니다!
각 이메일을 확인하고 전송해주세요.`),m(!0),setTimeout(()=>m(!1),5e3)},P=async A=>{try{if(navigator.share&&/iPhone|iPad|iPod|Android/i.test(navigator.userAgent))await navigator.share({title:`${n.name} - 정산 결과`,text:A,url:window.location.href}),j("📱 모바일 공유 완료!");else{const I=encodeURIComponent(A),M=`https://sharer.kakao.com/talk/friends/picker/link?url=${encodeURIComponent(window.location.href)}&text=${I}`;window.open(M,"_blank","width=500,height=600"),j("📱 카카오톡 공유 창이 열렸습니다!")}m(!0),setTimeout(()=>m(!1),4e3)}catch{await k(A)}},W=()=>{if(console.log("saveToArchive 함수 실행됨"),console.log("historyItem:",n),!n){alert("아카이브할 계산 데이터가 없습니다.");return}if(console.log("historyItem.status:",n.status),n.status==="pending"){alert("대기중인 계산입니다. 먼저 완료 상태로 변경해주세요.");return}if(n.status==="shared"){alert("공유 상태인 계산입니다. 먼저 완료 상태로 변경해주세요.");return}if(n.status==="completed")try{console.log("archiveService.add 시작");const A=pt.add(n);console.log("archiveService.add 완료:",A),alert(`계산이 아카이브에 성공적으로 저장되었습니다.
저장 시간: ${A.archivedDate}`);const I=pt.getAll();console.log("현재 아카이브 목록:",I)}catch(A){console.error("아카이브 저장 오류:",A),alert(`아카이브 저장 중 오류가 발생했습니다: ${A}`)}else alert("알 수 없는 상태입니다. 먼저 완료 상태로 변경해주세요.")},H=(A,I)=>{x(A),b(I)},X=()=>{x(null),b("")},B=A=>{var M;if(!n||!h.trim()){X();return}const I=a.map(_=>_.id===A?{..._,email:h.trim()}:_);if(o(I),n.details){const _=(M=a.find(z=>z.id===A))==null?void 0:M.name;if(_){const z={...n.details,participantEmails:{...n.details.participantEmails,[_]:h.trim()}};Le.update(n.id,{details:z}),r(oe=>oe?{...oe,details:z}:null)}}X()};return e.jsx("div",{className:"container mx-auto p-4 max-w-4xl","data-testid":"result-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{children:[e.jsxs(J,{children:[e.jsxs(Z,{"data-testid":"result-title",children:[n==null?void 0:n.name," - 계산 결과"]}),e.jsxs("p",{className:"text-muted-foreground",children:[n==null?void 0:n.date," • 총 ",C.toLocaleString(),"원이 ",a.length,"명에게 분할되었습니다."]})]}),e.jsx(q,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((A,I)=>{const M=S(A.id);return e.jsxs(V,{"data-testid":`participant-result-${I}`,className:"p-4 text-center",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:A.name}),e.jsxs(he,{variant:"outline",className:"text-lg px-3 py-1","data-testid":`amount-${I}`,children:[M.toLocaleString(),"원"]}),e.jsx("div",{className:"mt-2",children:w===A.id?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(me,{type:"email",value:h,onChange:_=>b(_.target.value),placeholder:"이메일 주소 입력",className:"text-sm",onKeyDown:_=>{_.key==="Enter"?B(A.id):_.key==="Escape"&&X()},autoFocus:!0}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(T,{size:"sm",onClick:()=>B(A.id),className:"flex-1",children:"저장"}),e.jsx(T,{size:"sm",variant:"outline",onClick:X,className:"flex-1",children:"취소"})]})]}):e.jsx("button",{onClick:()=>H(A.id,A.email),className:"text-sm text-muted-foreground hover:text-foreground transition-colors cursor-pointer",children:A.email||"이메일 추가하기"})})]},A.id)})})})]}),e.jsxs(V,{children:[e.jsx(J,{children:e.jsx(Z,{children:"상세 내역"})}),e.jsx(q,{children:e.jsx("div",{className:"space-y-4",children:i.map((A,I)=>{var M;return e.jsxs("div",{"data-testid":`item-detail-${I}`,className:"border-b pb-4 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:A.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[A.price.toLocaleString(),"원 x ",A.quantity," = ",(A.price*A.quantity).toLocaleString(),"원"]})]}),e.jsx(he,{variant:"secondary",children:A.category})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"분담:"}),(M=A.assignedParticipants)==null?void 0:M.map(_=>{var R;const z=a.find($=>$.id===_),oe=A.price*A.quantity/(((R=A.assignedParticipants)==null?void 0:R.length)||1);return e.jsxs(he,{variant:"outline",className:"text-xs",children:[z==null?void 0:z.name," (",oe.toLocaleString(),"원)"]},_)})]})]},A.id)})})})]}),u&&e.jsx(V,{"data-testid":"share-confirmation",className:"bg-blue-50 border-blue-200",children:e.jsx(q,{className:"pt-6",children:e.jsxs("div",{className:"text-blue-800",children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[v.includes("클립보드")?"📋":v.includes("모바일")?"📱":"📤","공유 완료!"]}),e.jsx("div",{className:"text-sm bg-blue-100 p-3 rounded-lg whitespace-pre-wrap",children:v}),v.includes("클립보드")&&e.jsx("div",{className:"mt-2 text-xs text-blue-600",children:"💡 카카오톡, 문자메시지, 이메일 등에서 Ctrl+V로 붙여넣기 할 수 있습니다."})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(jt,{"data-testid":"send-results-button",onClick:E,variant:"default",className:"h-12",children:"📤 정산 결과 전송"}),e.jsx(T,{"data-testid":"save-to-archive-button",onClick:W,variant:"outline",className:"h-12",children:"📦 아카이브에 저장"})]}),e.jsxs(V,{children:[e.jsx(J,{children:e.jsx(Z,{children:"추가 옵션"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(T,{"data-testid":"export-pdf-button",variant:"outline",onClick:()=>console.log("Exporting to PDF..."),children:"PDF로 내보내기"}),e.jsx(T,{"data-testid":"new-calculation-button",variant:"outline",onClick:()=>s("/"),children:"새 계산 시작"})]})})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(V,{className:"w-full max-w-md",children:[e.jsxs(J,{children:[e.jsx(Z,{className:"text-center",children:"📤 전송 방법 선택"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"정산 결과를 어떻게 전송하시겠습니까?"})]}),e.jsxs(q,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>N("clipboard"),className:`w-full p-4 rounded-lg border-2 transition-colors text-left ${y==="clipboard"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"📋"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"클립보드 복사"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"복사 후 원하는 앱에서 붙여넣기"})]})]})}),e.jsx("button",{onClick:()=>N("email"),className:`w-full p-4 rounded-lg border-2 transition-colors text-left ${y==="email"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"📧"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"이메일 전송"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"참가자별 개별 이메일 발송"})]})]})}),e.jsx("button",{onClick:()=>N("kakao"),className:`w-full p-4 rounded-lg border-2 transition-colors text-left ${y==="kakao"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"💬"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"카카오톡 공유"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"카카오톡으로 바로 공유하기"})]})]})})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(T,{variant:"outline",onClick:()=>g(!1),className:"flex-1",children:"취소"}),e.jsx(T,{onClick:F,className:"flex-1",children:"전송하기"})]})]})]})})]})})},Kl=()=>{const s=Be(),[t,n]=f.useState(""),[r,a]=f.useState([]),[o,i]=f.useState(-1),[l,c]=f.useState([]),[d,u]=f.useState("all");f.useEffect(()=>{const y=()=>{const S=Le.getAll();c(S)};y();const N=()=>y();return window.addEventListener("focus",N),()=>window.removeEventListener("focus",N)},[]);const m=l.filter(y=>{const N=y.name.toLowerCase().includes(t.toLowerCase())||y.date.includes(t),S=d==="all"||y.status===d;return N&&S}),v=y=>{a(N=>N.includes(y)?N.filter(S=>S!==y):[...N,y])},j=()=>{if(r.length===0)return;const y=Le.deleteMultiple(r);if(y>0){const N=Le.getAll();c(N),a([]),alert(`${y}개 항목이 삭제되었습니다.`)}else alert("삭제할 항목이 없습니다.")},w=(y,N)=>{if(Le.update(y,{status:N})){const C=Le.getAll();c(C);const E=g(N);alert(`상태가 '${E}'로 변경되었습니다.`)}else alert("상태 변경에 실패했습니다.")},x=()=>{const y=l.filter(N=>r.includes(N.id));alert(`${r.length}개 항목을 CSV/PDF로 내보내기합니다:
${y.map(N=>`- ${N.name} (${N.date})`).join(`
`)}`)},h=y=>{const N=l.find(S=>S.id===y);if(N)if(navigator.share)navigator.share({title:`${N.name} - 계산 결과`,text:`${N.name}
날짜: ${N.date}
총 금액: ${N.total.toLocaleString()}원
참가자: ${N.participants}명`,url:`${window.location.origin}/result/${y}`}).catch(S=>console.log("공유 실패:",S));else{const S=`${N.name}
날짜: ${N.date}
총 금액: ${N.total.toLocaleString()}원
참가자: ${N.participants}명
링크: ${window.location.origin}/result/${y}`;navigator.clipboard?navigator.clipboard.writeText(S).then(()=>{alert("계산 결과가 클립보드에 복사되었습니다!")}).catch(()=>{alert("복사에 실패했습니다. 다시 시도해주세요.")}):alert(`공유 정보:

${S}`)}},b=y=>{s(`/result/${y}`)},p=y=>{switch(y){case"completed":return"bg-green-100 text-green-800";case"shared":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},g=y=>{switch(y){case"completed":return"완료";case"shared":return"공유됨";case"pending":return"대기중";default:return"알 수 없음"}};return ie.useEffect(()=>{const y=N=>{if(m.length!==0)switch(N.key){case"ArrowDown":N.preventDefault(),i(S=>S<m.length-1?S+1:S);break;case"ArrowUp":N.preventDefault(),i(S=>S>0?S-1:S);break;case"Enter":o>=0&&(N.preventDefault(),b(m[o].id));break;case" ":o>=0&&(N.preventDefault(),v(m[o].id));break}};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[m,o]),ie.useEffect(()=>{if(o>=0&&o<m.length){const N=document.querySelectorAll('[data-testid="history-item"]')[o];N&&N.focus()}},[o,m.length]),e.jsx("div",{className:"container mx-auto p-4 max-w-6xl","data-testid":"history-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsxs(J,{children:[e.jsx(Z,{"data-testid":"history-title",className:"tech-title",children:"계산 히스토리"}),e.jsxs("p",{className:"text-muted-foreground tech-subtitle",children:["지금까지 ",l.length,"개의 계산 기록이 있습니다."]})]}),e.jsx(q,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx(me,{"data-testid":"search-input",placeholder:"계산 이름이나 날짜로 검색...",value:t,onChange:y=>n(y.target.value),className:"md:max-w-md","aria-label":"계산 기록 검색"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(T,{variant:"industrial","data-testid":"new-calculation-button",onClick:()=>s("/"),children:"+ 새 계산"}),r.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{"data-testid":"export-selected-button",onClick:x,variant:"outline",children:["내보내기 (",r.length,")"]}),e.jsxs(T,{"data-testid":"delete-selected-button",onClick:j,variant:"destructive",children:["삭제 (",r.length,")"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"상태 필터:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{"data-testid":"filter-all",onClick:()=>u("all"),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${d==="all"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"전체"}),e.jsx("button",{"data-testid":"filter-pending",onClick:()=>u("pending"),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${d==="pending"?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-muted text-muted-foreground hover:bg-yellow-50"}`,children:"🟡 대기중"}),e.jsx("button",{"data-testid":"filter-shared",onClick:()=>u("shared"),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${d==="shared"?"bg-blue-100 text-blue-800 border border-blue-300":"bg-muted text-muted-foreground hover:bg-blue-50"}`,children:"🔵 공유됨"}),e.jsx("button",{"data-testid":"filter-completed",onClick:()=>u("completed"),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${d==="completed"?"bg-green-100 text-green-800 border border-green-300":"bg-muted text-muted-foreground hover:bg-green-50"}`,children:"🟢 완료"})]})]})]})})]}),e.jsx("div",{className:"space-y-4","data-testid":"history-list",role:"list",children:m.length===0?e.jsx(V,{"data-testid":"no-history",className:"p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:t?"검색 결과가 없습니다.":"아직 계산 기록이 없습니다."})}):m.map((y,N)=>e.jsx(V,{"data-testid":"history-item",className:`steel-panel hud-element transition-all ${r.includes(y.id)?"ring-2 ring-primary bg-primary/5":""} ${o===N?"ring-2 ring-blue-500":""}`,tabIndex:0,onFocus:()=>i(N),role:"listitem","aria-selected":r.includes(y.id),children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{"data-testid":`select-item-${N}`,type:"checkbox",checked:r.includes(y.id),onChange:()=>v(y.id),className:"w-4 h-4","aria-label":`${y.name} 선택`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:y.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:y.date})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-lg",children:[y.total.toLocaleString(),"원"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[y.participants,"명 · ",y.items,"개 항목"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:y.status,onChange:S=>w(y.id,S.target.value),className:`px-3 py-1 rounded-full text-xs font-medium border-0 cursor-pointer appearance-none pr-6 ${p(y.status)}`,children:[e.jsx("option",{value:"pending",children:"🟡 대기중"}),e.jsx("option",{value:"shared",children:"🔵 공유됨"}),e.jsx("option",{value:"completed",children:"🟢 완료"})]}),e.jsx(_s,{className:"absolute right-1 top-1/2 transform -translate-y-1/2 w-3 h-3 pointer-events-none"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(T,{"data-testid":`view-item-${N}`,onClick:()=>b(y.id),variant:"outline",size:"sm",children:"보기"}),e.jsx(T,{"data-testid":`share-item-${N}`,onClick:()=>h(y.id),variant:"outline",size:"sm",children:"공유"})]})]})]})})},y.id))}),e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"통계 정보"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{"data-testid":"total-calculations",className:"tech-display text-center p-4 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:l.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"총 계산 횟수"})]}),e.jsxs("div",{"data-testid":"completed-calculations",className:"tech-display text-center p-4 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:l.filter(y=>y.status==="completed").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"완료된 계산"})]}),e.jsxs("div",{"data-testid":"completed-amount",className:"tech-display text-center p-4 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:l.filter(y=>y.status==="completed").reduce((y,N)=>y+N.total,0).toLocaleString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"완료된 계산 금액"})]}),e.jsxs("div",{"data-testid":"average-amount",className:"tech-display text-center p-4 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:(()=>{const y=l.filter(N=>N.status==="completed");return y.length>0?Math.round(y.reduce((N,S)=>N+S.total,0)/y.length).toLocaleString():"0"})()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"완료된 계산 평균 금액"})]})]})})]})]})})};class ql{getArchivedData(){return pt.getAll()}async calculateStats(){try{const t=this.getArchivedData();if(t.length===0)return this.getEmptyStats();const n=t.length,r=t.reduce((h,b)=>h+b.total,0),a=r/n,o=new Date,i=new Date(o.getFullYear(),o.getMonth(),1),l=new Date(o.getFullYear(),o.getMonth()-1,1),c=t.filter(h=>new Date(h.date)>=i),d=t.filter(h=>{const b=new Date(h.date);return b>=l&&b<i}),u={calculations:c.length,amount:c.reduce((h,b)=>h+b.total,0)},m={calculations:d.length,amount:d.reduce((h,b)=>h+b.total,0)},v=m.calculations>0?(u.calculations-m.calculations)/m.calculations*100:u.calculations>0?100:0,j=m.amount>0?(u.amount-m.amount)/m.amount*100:u.amount>0?100:0,w=this.analyzeCategoriesFromArchivedItems(t),x=this.calculateMonthlyTrendFromArchive(t);return{totalCalculations:n,totalAmount:r,averageAmount:a,thisMonth:u,lastMonth:m,categories:w,monthlyTrend:x,changes:{calculationsChange:v,amountChange:j}}}catch(t){return console.error("통계 계산 중 오류 발생:",t),this.getEmptyStats()}}getMockStats(){const t=new Date,n=`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}`,r=`${t.getMonth()===0?t.getFullYear()-1:t.getFullYear()}-${(t.getMonth()===0?12:t.getMonth()).toString().padStart(2,"0")}`;return{totalCalculations:24,totalAmount:369600,averageAmount:15400,thisMonth:{calculations:8,amount:124800},lastMonth:{calculations:6,amount:92400},categories:{식비:{count:18,amount:277200,percentage:75},음료:{count:8,amount:61600,percentage:16.7},디저트:{count:4,amount:30800,percentage:8.3}},monthlyTrend:[{month:r,calculations:6,amount:92400},{month:n,calculations:8,amount:124800}],changes:{calculationsChange:33.3,amountChange:35}}}getEmptyStats(){return{totalCalculations:0,totalAmount:0,averageAmount:0,thisMonth:{calculations:0,amount:0},lastMonth:{calculations:0,amount:0},categories:{},monthlyTrend:[],changes:{calculationsChange:0,amountChange:0}}}analyzeCategoriesFromArchivedItems(t){const n={};t.forEach(o=>{const i=this.categorizeItem(o.name);n[i]||(n[i]={count:0,amount:0}),n[i].count+=1,n[i].amount+=o.total});const r=Object.values(n).reduce((o,i)=>o+i.amount,0),a={};return Object.entries(n).forEach(([o,i])=>{a[o]={...i,percentage:r>0?i.amount/r*100:0}}),a}categorizeItem(t){const n=t.toLowerCase();return n.includes("음료")||n.includes("커피")||n.includes("차")||n.includes("콜라")||n.includes("사이다")||n.includes("주스")||n.includes("물")||n.includes("맥주")||n.includes("소주")?"음료":n.includes("케이크")||n.includes("아이스크림")||n.includes("과자")||n.includes("초콜릿")||n.includes("캔디")||n.includes("디저트")||n.includes("빙수")||n.includes("팥빙수")?"디저트":n.includes("밥")||n.includes("국밥")||n.includes("비빔밥")||n.includes("덮밥")||n.includes("볶음밥")||n.includes("라면")||n.includes("국수")||n.includes("우동")||n.includes("파스타")?"주식":n.includes("안주")||n.includes("치킨")||n.includes("튀김")||n.includes("전")||n.includes("구이")||n.includes("조림")||n.includes("나물")||n.includes("김치")?"안주/반찬":"식비"}calculateMonthlyTrendFromArchive(t){const n={},r=new Date;for(let a=11;a>=0;a--){const o=new Date(r.getFullYear(),r.getMonth()-a,1),i=`${o.getFullYear()}-${(o.getMonth()+1).toString().padStart(2,"0")}`;n[i]={calculations:0,amount:0}}return t.forEach(a=>{const o=new Date(a.date),i=`${o.getFullYear()}-${(o.getMonth()+1).toString().padStart(2,"0")}`;n[i]&&(n[i].calculations+=1,n[i].amount+=a.total)}),Object.entries(n).map(([a,o])=>({month:a,calculations:o.calculations,amount:o.amount})).sort((a,o)=>a.month.localeCompare(o.month))}async calculateStatsForPeriod(t,n){const a=pt.getAll().filter(c=>{const d=c.date;return d>=t&&d<=n});if(a.length===0)return{totalCalculations:0,totalAmount:0,averageAmount:0};const o=a.length,i=a.reduce((c,d)=>c+d.total,0),l=i/o;return{totalCalculations:o,totalAmount:i,averageAmount:l}}}const Gl=new ql,Yl=()=>{const[s,t]=f.useState(null),[n,r]=f.useState(!0);f.useEffect(()=>{a()},[]);const a=async()=>{try{r(!0);const c=await Gl.calculateStats();t(c)}catch(c){console.error("통계 로딩 오류:",c)}finally{r(!1)}},o=c=>`₩${c.toLocaleString()}`,i=c=>c===0?"변동없음":`지난달 대비 ${c>0?"+":""}${c.toFixed(1)}%`,l=()=>!s||Object.keys(s.categories).length===0?[{name:"데이터 없음",percentage:0,amount:0}]:Object.entries(s.categories).sort(([,c],[,d])=>d.percentage-c.percentage).slice(0,3).map(([c,d])=>({name:c,percentage:d.percentage,amount:d.amount}));return n?e.jsx("div",{className:"container mx-auto p-4 max-w-4xl","data-testid":"stats-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold tech-title mb-2",children:"지출 패턴 분석"}),e.jsx("p",{className:"text-muted-foreground tech-subtitle",children:"아카이브된 계산 내역을 기반으로 한 통계"})]}),e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"통계 데이터를 불러오는 중..."})]})})]})}):e.jsx("div",{className:"container mx-auto p-4 max-w-4xl","data-testid":"stats-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold tech-title mb-2",children:"지출 패턴 분석"}),e.jsx("p",{className:"text-muted-foreground tech-subtitle",children:"아카이브된 계산 내역을 기반으로 한 통계"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(V,{className:"steel-panel",children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Z,{className:"text-sm font-medium tech-subtitle",children:"총 계산 횟수"}),e.jsx(Io,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:(s==null?void 0:s.totalCalculations)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?i(s.changes.calculationsChange):"데이터 없음"})]})]}),e.jsxs(V,{className:"steel-panel",children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Z,{className:"text-sm font-medium tech-subtitle",children:"평균 지출"}),e.jsx(Qn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:s?o(Math.round(s.averageAmount)):"₩0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?i(s.changes.amountChange):"데이터 없음"})]})]}),e.jsxs(V,{className:"steel-panel",children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Z,{className:"text-sm font-medium tech-subtitle",children:"총 지출액"}),e.jsx(Lt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:s?o(s.totalAmount):"₩0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?i(s.changes.amountChange):"데이터 없음"})]})]}),e.jsxs(V,{className:"steel-panel",children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Z,{className:"text-sm font-medium tech-subtitle",children:"카테고리"}),e.jsx(nn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:s?Object.keys(s.categories).length:0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s&&Object.keys(s.categories).length>0?Object.keys(s.categories).slice(0,2).join(", ")+" 등":"데이터 없음"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"월별 지출 추이"})}),e.jsx(q,{children:e.jsx("div",{className:"tech-display rounded-lg p-4",children:s&&s.monthlyTrend.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"최근 6개월 추이"}),s.monthlyTrend.slice(-6).map((c,d)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:c.month}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 h-2 bg-muted/30 rounded-full",children:e.jsx("div",{className:"h-2 bg-primary rounded-full transition-all",style:{width:`${Math.max(5,c.amount/(s.totalAmount||1)*100)}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground w-12 text-right",children:[c.calculations,"건"]})]}),e.jsx("span",{className:"text-sm font-medium w-20 text-right",children:o(c.amount)})]})]},c.month))]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Lt,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["아카이브된 데이터가 없습니다.",e.jsx("br",{}),"완료된 계산을 아카이브에 보관해보세요."]})]})})})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"카테고리별 분석"})}),e.jsx(q,{children:e.jsx("div",{className:"tech-display rounded-lg p-4",children:s&&Object.keys(s.categories).length>0?e.jsx("div",{className:"space-y-3",children:l().map((c,d)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:c.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",o(c.amount),")"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 h-2 bg-muted/30 rounded-full",children:e.jsx("div",{className:"h-2 bg-primary rounded-full transition-all",style:{width:`${Math.max(5,c.percentage)}%`}})}),e.jsxs("span",{className:"text-sm text-muted-foreground w-12 text-right",children:[c.percentage.toFixed(1),"%"]})]})]},c.name))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(nn,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["아카이브된 데이터가 없습니다.",e.jsx("br",{}),"완료된 계산을 아카이브에 보관해보세요."]})]})})})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"통계 정보"})}),e.jsx(q,{children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"데이터 소스:"})," 아카이브에 보관된 완료 계산만 통계에 포함됩니다"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"자동 아카이브:"})," 완료된 계산은 90일 후 자동으로 아카이브됩니다"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"수동 아카이브:"})," 히스토리 페이지에서 완료된 계산을 직접 아카이브할 수 있습니다"]})]})})})]})})]})})},Xl=()=>{const s=Be(),t=()=>{try{const b=localStorage.getItem("costSplitTemplates");if(b)return JSON.parse(b)}catch(b){console.error("템플릿 데이터 로딩 실패:",b)}return[{id:"1",name:"회식 템플릿",participants:4,splitType:"균등 분할",usageCount:12},{id:"2",name:"카페 모임",participants:3,splitType:"항목별 분할",usageCount:8},{id:"3",name:"데이트",participants:2,splitType:"7:3 비율",usageCount:5}]},[n,r]=f.useState(t),a=b=>{try{localStorage.setItem("costSplitTemplates",JSON.stringify(b))}catch(p){console.error("템플릿 데이터 저장 실패:",p)}};ie.useEffect(()=>{a(n)},[n]);const[o,i]=f.useState(!1),[l,c]=f.useState(null),[d,u]=f.useState({name:"",participants:2,splitType:"균등 분할"}),m=["균등 분할","항목별 분할","7:3 비율","6:4 비율","사용자 정의"],v=()=>{c(null),u({name:"",participants:2,splitType:"균등 분할"}),i(!0)},j=b=>{const p=n.find(g=>g.id===b);p&&(r(g=>g.map(y=>y.id===b?{...y,usageCount:y.usageCount+1}:y)),alert(`"${p.name}" 템플릿을 사용하여 계산기 페이지로 이동합니다.`),s("/calculator"))},w=b=>{const p=n.find(g=>g.id===b);p&&(c(p),u({name:p.name,participants:p.participants,splitType:p.splitType}),i(!0))},x=b=>{const p=n.find(g=>g.id===b);p&&window.confirm(`"${p.name}" 템플릿을 삭제하시겠습니까?`)&&(r(g=>g.filter(y=>y.id!==b)),alert("템플릿이 삭제되어 저장되었습니다."))},h=()=>{if(!d.name.trim()){alert("템플릿 이름을 입력해주세요.");return}if(l)r(b=>b.map(p=>p.id===l.id?{...p,name:d.name,participants:d.participants,splitType:d.splitType}:p)),alert("템플릿이 수정되어 저장되었습니다!");else{const b={id:Date.now().toString(),name:d.name,participants:d.participants,splitType:d.splitType,usageCount:0};r(p=>[...p,b]),alert("새 템플릿이 생성되어 저장되었습니다!")}i(!1),c(null)};return e.jsx("div",{className:"container mx-auto p-4 max-w-4xl","data-testid":"templates-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tech-title mb-2",children:"분할 템플릿"}),e.jsx("p",{className:"text-muted-foreground tech-subtitle",children:"자주 사용하는 분할 설정을 저장하고 재사용하세요"})]}),e.jsxs(T,{variant:"industrial",className:"flex items-center space-x-2",onClick:v,children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"새 템플릿"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(b=>e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Dt,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"text-base tech-title",children:b.name})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(T,{variant:"ghost",size:"sm",className:"p-1",onClick:()=>w(b.id),children:e.jsx(ko,{className:"h-3 w-3"})}),e.jsx(T,{variant:"ghost",size:"sm",className:"p-1",onClick:()=>x(b.id),children:e.jsx(ft,{className:"h-3 w-3"})})]})]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"tech-display rounded p-3 space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"참가자:"})," ",b.participants,"명"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"분할 방식:"})," ",b.splitType]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"사용 횟수:"})," ",b.usageCount,"번"]})]}),e.jsx(T,{variant:"outline",size:"sm",className:"w-full mt-3",onClick:()=>j(b.id),children:"템플릿 사용"})]})]},b.id))}),o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background steel-panel p-6 rounded-lg max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold tech-title",children:l?"템플릿 편집":"새 템플릿 생성"}),e.jsx(T,{variant:"ghost",size:"sm",onClick:()=>i(!1),children:e.jsx(qt,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"templateName",children:"템플릿 이름"}),e.jsx(me,{id:"templateName",value:d.name,onChange:b=>u(p=>({...p,name:b.target.value})),placeholder:"예: 회식 템플릿",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"participants",children:"참가자 수"}),e.jsx(me,{id:"participants",type:"number",min:"2",max:"20",value:d.participants,onChange:b=>u(p=>({...p,participants:parseInt(b.target.value)||2})),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"splitType",children:"분할 방식"}),e.jsx("select",{id:"splitType",value:d.splitType,onChange:b=>u(p=>({...p,splitType:b.target.value})),className:"mt-1 w-full p-2 border border-input bg-background rounded-md",children:m.map(b=>e.jsx("option",{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"flex space-x-2 mt-6",children:[e.jsx(T,{variant:"outline",onClick:()=>i(!1),className:"flex-1",children:"취소"}),e.jsx(T,{variant:"industrial",onClick:h,className:"flex-1",children:l?"수정":"생성"})]})]})}),e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"템플릿 생성 가이드"})}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"tech-display rounded p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"템플릿 활용 팁"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1 h-1 bg-primary rounded-full"}),e.jsx("span",{children:"자주 만나는 그룹별로 템플릿을 만들어 두세요"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1 h-1 bg-primary rounded-full"}),e.jsx("span",{children:"분할 비율이 정해진 경우 미리 설정해 두면 편리합니다"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1 h-1 bg-primary rounded-full"}),e.jsx("span",{children:"템플릿 이름은 구분하기 쉽게 명확하게 작성하세요"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1 h-1 bg-green-500 rounded-full"}),e.jsx("span",{children:"템플릿은 브라우저에 자동 저장되어 새로고침해도 유지됩니다"})]})]})]})})]})]})})},Ql=()=>{const s=Be(),[t,n]=f.useState([]);f.useEffect(()=>{const w=()=>{const h=pt.getAll();console.log("로드된 아카이브:",h),n(h)};w();const x=()=>w();return window.addEventListener("focus",x),()=>window.removeEventListener("focus",x)},[]);const[r,a]=f.useState([]),[o,i]=f.useState(!1),l=w=>{const h=[["항목명","날짜","참가자 수","총 금액"],[w.name,w.date,w.participants.toString(),w.total.toString()]].map(y=>y.join(",")).join(`
`),b=new Blob(["\uFEFF"+h],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(b),g=document.createElement("a");g.href=p,g.download=`${w.name.replace(/[^a-zA-Z0-9가-힣]/g,"_")}_${w.date}.csv`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p)},c=w=>{s(`/result/${w.id}`)},d=w=>{const x={name:w.name,date:w.date,participants:w.participants,amount:w.total,exportDate:new Date().toISOString(),format:"archive-item"},h=JSON.stringify(x,null,2),b=new Blob([h],{type:"application/json"}),p=URL.createObjectURL(b),g=document.createElement("a");g.href=p,g.download=`${w.name.replace(/[^a-zA-Z0-9가-힣]/g,"_")}_${w.date}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p)},u=async w=>{const x=t.find(h=>h.id===w);if(x){a(h=>[...h,w]);try{const h=confirm(`어떤 형식으로 다운로드하시겠습니까?

OK: CSV 형식
취소: JSON 형식`);await new Promise(b=>setTimeout(b,500)),h?l(x):d(x),setTimeout(()=>{alert(`"${x.name}" 다운로드가 완료되었습니다!`)},100)}catch{alert("다운로드 중 오류가 발생했습니다. 다시 시도해주세요.")}finally{a(h=>h.filter(b=>b!==w))}}},m=()=>{const x=[["항목명","날짜","참가자 수","총 금액"],...t.map(g=>[g.name,g.date,g.participants.toString(),g.total.toString()])].map(g=>g.join(",")).join(`
`),h=new Blob(["\uFEFF"+x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(h),p=document.createElement("a");p.href=b,p.download=`아카이브_전체_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(b)},v=()=>{var g,y;const w={exportInfo:{title:"아카이브 전체 데이터",exportDate:new Date().toISOString(),totalItems:t.length,totalAmount:t.reduce((N,S)=>N+S.total,0)},items:t,summary:{oldestDate:t.reduce((N,S)=>S.date<N?S.date:N,((g=t[0])==null?void 0:g.date)||""),newestDate:t.reduce((N,S)=>S.date>N?S.date:N,((y=t[0])==null?void 0:y.date)||""),averageAmount:Math.round(t.reduce((N,S)=>N+S.total,0)/t.length),averageParticipants:Math.round(t.reduce((N,S)=>N+S.participants,0)/t.length*10)/10}},x=JSON.stringify(w,null,2),h=new Blob([x],{type:"application/json"}),b=URL.createObjectURL(h),p=document.createElement("a");p.href=b,p.download=`아카이브_전체_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(b)},j=async()=>{if(t.length===0){alert("내보낼 아카이브 데이터가 없습니다.");return}i(!0);try{const w=confirm(`전체 데이터를 어떤 형식으로 내보내시겠습니까?

OK: CSV 형식 (스프레드시트용)
취소: JSON 형식 (상세 정보 포함)`);await new Promise(x=>setTimeout(x,1e3)),w?m():v(),setTimeout(()=>{alert(`전체 아카이브 데이터 (${t.length}개 항목) 내보내기가 완료되었습니다!`)},100)}catch{alert("내보내기 중 오류가 발생했습니다. 다시 시도해주세요.")}finally{i(!1)}};return e.jsx("div",{className:"container mx-auto p-4 max-w-4xl","data-testid":"archive-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tech-title mb-2",children:"아카이브"}),e.jsx("p",{className:"text-muted-foreground tech-subtitle",children:"보관된 계산 내역을 확인하고 관리하세요"})]}),e.jsxs(T,{variant:"industrial",className:"flex items-center space-x-2",onClick:j,disabled:o,children:[e.jsx(Ft,{className:`h-4 w-4 ${o?"animate-spin":""}`}),e.jsx("span",{children:o?"내보내는 중...":"전체 내보내기"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(V,{className:"steel-panel",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"보관된 항목"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:t.length})]}),e.jsx(xs,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(V,{className:"steel-panel",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"총 보관 기간"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:"6개월"})]}),e.jsx(Po,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(V,{className:"steel-panel",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"보관된 총액"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["₩",(t.reduce((w,x)=>w+x.total,0)/1e3).toFixed(0),"K"]})]}),e.jsx(rn,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsx(V,{className:"p-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(xs,{className:"h-12 w-12 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"아카이브가 비어있습니다"}),e.jsx("p",{className:"text-muted-foreground",children:"완료된 계산을 아카이브에 저장해보세요."})]})]})}):t.map(w=>e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Z,{className:"text-base tech-title",children:w.name}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:w.date})]}),e.jsx(he,{className:"bg-primary/20 text-primary",children:"보관됨"})]})}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Pt,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[w.participants,"명"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(rn,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["₩",w.total.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(T,{variant:"outline",size:"sm",className:"flex items-center space-x-1",onClick:()=>c(w),children:[e.jsx(Xn,{className:"h-3 w-3"}),e.jsx("span",{children:"보기"})]}),e.jsxs(T,{variant:"outline",size:"sm",className:"flex items-center space-x-1",onClick:()=>u(w.id),disabled:r.includes(w.id),children:[e.jsx(Ft,{className:`h-3 w-3 ${r.includes(w.id)?"animate-spin":""}`}),e.jsx("span",{children:r.includes(w.id)?"다운로드 중...":"다운로드"})]})]})]})})]},w.id))}),e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"아카이브 정보"})}),e.jsx(q,{children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"자동 보관:"})," 90일 후 자동으로 아카이브로 이동"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"보관 기간:"})," 아카이브된 항목은 1년간 보관"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"데이터 Export:"})," 언제든 CSV 또는 PDF로 다운로드 가능"]})]})})})]})]})})};function jn(s,[t,n]){return Math.min(n,Math.max(t,s))}function Jl(s,t=globalThis==null?void 0:globalThis.document){const n=De(s);f.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Zl="DismissableLayer",Es="dismissableLayer.update",ec="dismissableLayer.pointerDownOutside",tc="dismissableLayer.focusOutside",wn,Fr=f.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Br=f.forwardRef((s,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:l,...c}=s,d=f.useContext(Fr),[u,m]=f.useState(null),v=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,j]=f.useState({}),w=le(t,C=>m(C)),x=Array.from(d.layers),[h]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),b=x.indexOf(h),p=u?x.indexOf(u):-1,g=d.layersWithOutsidePointerEventsDisabled.size>0,y=p>=b,N=rc(C=>{const E=C.target,F=[...d.branches].some(k=>k.contains(E));!y||F||(a==null||a(C),i==null||i(C),C.defaultPrevented||l==null||l())},v),S=ac(C=>{const E=C.target;[...d.branches].some(k=>k.contains(E))||(o==null||o(C),i==null||i(C),C.defaultPrevented||l==null||l())},v);return Jl(C=>{p===d.layers.size-1&&(r==null||r(C),!C.defaultPrevented&&l&&(C.preventDefault(),l()))},v),f.useEffect(()=>{if(u)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(wn=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),Nn(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=wn)}},[u,v,n,d]),f.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),Nn())},[u,d]),f.useEffect(()=>{const C=()=>j({});return document.addEventListener(Es,C),()=>document.removeEventListener(Es,C)},[]),e.jsx(ne.div,{...c,ref:w,style:{pointerEvents:g?y?"auto":"none":void 0,...s.style},onFocusCapture:se(s.onFocusCapture,S.onFocusCapture),onBlurCapture:se(s.onBlurCapture,S.onBlurCapture),onPointerDownCapture:se(s.onPointerDownCapture,N.onPointerDownCapture)})});Br.displayName=Zl;var sc="DismissableLayerBranch",nc=f.forwardRef((s,t)=>{const n=f.useContext(Fr),r=f.useRef(null),a=le(t,r);return f.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),e.jsx(ne.div,{...s,ref:a})});nc.displayName=sc;function rc(s,t=globalThis==null?void 0:globalThis.document){const n=De(s),r=f.useRef(!1),a=f.useRef(()=>{});return f.useEffect(()=>{const o=l=>{if(l.target&&!r.current){let c=function(){zr(ec,n,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function ac(s,t=globalThis==null?void 0:globalThis.document){const n=De(s),r=f.useRef(!1);return f.useEffect(()=>{const a=o=>{o.target&&!r.current&&zr(tc,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Nn(){const s=new CustomEvent(Es);document.dispatchEvent(s)}function zr(s,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(s,t,{once:!0}),r?tl(a,o):a.dispatchEvent(o)}var is=0;function oc(){f.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??Sn()),document.body.insertAdjacentElement("beforeend",s[1]??Sn()),is++,()=>{is===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),is--}},[])}function Sn(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var ls="focusScope.autoFocusOnMount",cs="focusScope.autoFocusOnUnmount",Cn={bubbles:!1,cancelable:!0},ic="FocusScope",Ur=f.forwardRef((s,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=s,[l,c]=f.useState(null),d=De(a),u=De(o),m=f.useRef(null),v=le(t,x=>c(x)),j=f.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;f.useEffect(()=>{if(r){let x=function(g){if(j.paused||!l)return;const y=g.target;l.contains(y)?m.current=y:Me(m.current,{select:!0})},h=function(g){if(j.paused||!l)return;const y=g.relatedTarget;y!==null&&(l.contains(y)||Me(m.current,{select:!0}))},b=function(g){if(document.activeElement===document.body)for(const N of g)N.removedNodes.length>0&&Me(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",h);const p=new MutationObserver(b);return l&&p.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",h),p.disconnect()}}},[r,l,j.paused]),f.useEffect(()=>{if(l){En.add(j);const x=document.activeElement;if(!l.contains(x)){const b=new CustomEvent(ls,Cn);l.addEventListener(ls,d),l.dispatchEvent(b),b.defaultPrevented||(lc(fc(Vr(l)),{select:!0}),document.activeElement===x&&Me(l))}return()=>{l.removeEventListener(ls,d),setTimeout(()=>{const b=new CustomEvent(cs,Cn);l.addEventListener(cs,u),l.dispatchEvent(b),b.defaultPrevented||Me(x??document.body,{select:!0}),l.removeEventListener(cs,u),En.remove(j)},0)}}},[l,d,u,j]);const w=f.useCallback(x=>{if(!n&&!r||j.paused)return;const h=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,b=document.activeElement;if(h&&b){const p=x.currentTarget,[g,y]=cc(p);g&&y?!x.shiftKey&&b===y?(x.preventDefault(),n&&Me(g,{select:!0})):x.shiftKey&&b===g&&(x.preventDefault(),n&&Me(y,{select:!0})):b===p&&x.preventDefault()}},[n,r,j.paused]);return e.jsx(ne.div,{tabIndex:-1,...i,ref:v,onKeyDown:w})});Ur.displayName=ic;function lc(s,{select:t=!1}={}){const n=document.activeElement;for(const r of s)if(Me(r,{select:t}),document.activeElement!==n)return}function cc(s){const t=Vr(s),n=An(t,s),r=An(t.reverse(),s);return[n,r]}function Vr(s){const t=[],n=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function An(s,t){for(const n of s)if(!dc(n,{upTo:t}))return n}function dc(s,{upTo:t}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(t!==void 0&&s===t)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function uc(s){return s instanceof HTMLInputElement&&"select"in s}function Me(s,{select:t=!1}={}){if(s&&s.focus){const n=document.activeElement;s.focus({preventScroll:!0}),s!==n&&uc(s)&&t&&s.select()}}var En=mc();function mc(){let s=[];return{add(t){const n=s[0];t!==n&&(n==null||n.pause()),s=Rn(s,t),s.unshift(t)},remove(t){var n;s=Rn(s,t),(n=s[0])==null||n.resume()}}}function Rn(s,t){const n=[...s],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function fc(s){return s.filter(t=>t.tagName!=="A")}const hc=["top","right","bottom","left"],_e=Math.min,xe=Math.max,Ut=Math.round,Ct=Math.floor,Ee=s=>({x:s,y:s}),pc={left:"right",right:"left",bottom:"top",top:"bottom"},xc={start:"end",end:"start"};function Rs(s,t,n){return xe(s,_e(t,n))}function Pe(s,t){return typeof s=="function"?s(t):s}function Te(s){return s.split("-")[0]}function st(s){return s.split("-")[1]}function Hs(s){return s==="x"?"y":"x"}function Ks(s){return s==="y"?"height":"width"}const gc=new Set(["top","bottom"]);function Ae(s){return gc.has(Te(s))?"y":"x"}function qs(s){return Hs(Ae(s))}function vc(s,t,n){n===void 0&&(n=!1);const r=st(s),a=qs(s),o=Ks(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=Vt(i)),[i,Vt(i)]}function bc(s){const t=Vt(s);return[Is(s),t,Is(t)]}function Is(s){return s.replace(/start|end/g,t=>xc[t])}const In=["left","right"],kn=["right","left"],yc=["top","bottom"],jc=["bottom","top"];function wc(s,t,n){switch(s){case"top":case"bottom":return n?t?kn:In:t?In:kn;case"left":case"right":return t?yc:jc;default:return[]}}function Nc(s,t,n,r){const a=st(s);let o=wc(Te(s),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(Is)))),o}function Vt(s){return s.replace(/left|right|bottom|top/g,t=>pc[t])}function Sc(s){return{top:0,right:0,bottom:0,left:0,...s}}function Wr(s){return typeof s!="number"?Sc(s):{top:s,right:s,bottom:s,left:s}}function Wt(s){const{x:t,y:n,width:r,height:a}=s;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function Pn(s,t,n){let{reference:r,floating:a}=s;const o=Ae(t),i=qs(t),l=Ks(i),c=Te(t),d=o==="y",u=r.x+r.width/2-a.width/2,m=r.y+r.height/2-a.height/2,v=r[l]/2-a[l]/2;let j;switch(c){case"top":j={x:u,y:r.y-a.height};break;case"bottom":j={x:u,y:r.y+r.height};break;case"right":j={x:r.x+r.width,y:m};break;case"left":j={x:r.x-a.width,y:m};break;default:j={x:r.x,y:r.y}}switch(st(t)){case"start":j[i]-=v*(n&&d?-1:1);break;case"end":j[i]+=v*(n&&d?-1:1);break}return j}const Cc=async(s,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,l=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let d=await i.getElementRects({reference:s,floating:t,strategy:a}),{x:u,y:m}=Pn(d,r,c),v=r,j={},w=0;for(let x=0;x<l.length;x++){const{name:h,fn:b}=l[x],{x:p,y:g,data:y,reset:N}=await b({x:u,y:m,initialPlacement:r,placement:v,strategy:a,middlewareData:j,rects:d,platform:i,elements:{reference:s,floating:t}});u=p??u,m=g??m,j={...j,[h]:{...j[h],...y}},N&&w<=50&&(w++,typeof N=="object"&&(N.placement&&(v=N.placement),N.rects&&(d=N.rects===!0?await i.getElementRects({reference:s,floating:t,strategy:a}):N.rects),{x:u,y:m}=Pn(d,v,c)),x=-1)}return{x:u,y:m,placement:v,strategy:a,middlewareData:j}};async function xt(s,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:l,strategy:c}=s,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:m="floating",altBoundary:v=!1,padding:j=0}=Pe(t,s),w=Wr(j),h=l[v?m==="floating"?"reference":"floating":m],b=Wt(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(h)))==null||n?h:h.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),p=m==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,g=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),y=await(o.isElement==null?void 0:o.isElement(g))?await(o.getScale==null?void 0:o.getScale(g))||{x:1,y:1}:{x:1,y:1},N=Wt(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:p,offsetParent:g,strategy:c}):p);return{top:(b.top-N.top+w.top)/y.y,bottom:(N.bottom-b.bottom+w.bottom)/y.y,left:(b.left-N.left+w.left)/y.x,right:(N.right-b.right+w.right)/y.x}}const Ac=s=>({name:"arrow",options:s,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=Pe(s,t)||{};if(d==null)return{};const m=Wr(u),v={x:n,y:r},j=qs(a),w=Ks(j),x=await i.getDimensions(d),h=j==="y",b=h?"top":"left",p=h?"bottom":"right",g=h?"clientHeight":"clientWidth",y=o.reference[w]+o.reference[j]-v[j]-o.floating[w],N=v[j]-o.reference[j],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d));let C=S?S[g]:0;(!C||!await(i.isElement==null?void 0:i.isElement(S)))&&(C=l.floating[g]||o.floating[w]);const E=y/2-N/2,F=C/2-x[w]/2-1,k=_e(m[b],F),L=_e(m[p],F),P=k,W=C-x[w]-L,H=C/2-x[w]/2+E,X=Rs(P,H,W),B=!c.arrow&&st(a)!=null&&H!==X&&o.reference[w]/2-(H<P?k:L)-x[w]/2<0,A=B?H<P?H-P:H-W:0;return{[j]:v[j]+A,data:{[j]:X,centerOffset:H-X-A,...B&&{alignmentOffset:A}},reset:B}}}),Ec=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:m=!0,fallbackPlacements:v,fallbackStrategy:j="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:x=!0,...h}=Pe(s,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=Te(a),p=Ae(l),g=Te(l)===l,y=await(c.isRTL==null?void 0:c.isRTL(d.floating)),N=v||(g||!x?[Vt(l)]:bc(l)),S=w!=="none";!v&&S&&N.push(...Nc(l,x,w,y));const C=[l,...N],E=await xt(t,h),F=[];let k=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&F.push(E[b]),m){const H=vc(a,i,y);F.push(E[H[0]],E[H[1]])}if(k=[...k,{placement:a,overflows:F}],!F.every(H=>H<=0)){var L,P;const H=(((L=o.flip)==null?void 0:L.index)||0)+1,X=C[H];if(X&&(!(m==="alignment"?p!==Ae(X):!1)||k.every(I=>Ae(I.placement)===p?I.overflows[0]>0:!0)))return{data:{index:H,overflows:k},reset:{placement:X}};let B=(P=k.filter(A=>A.overflows[0]<=0).sort((A,I)=>A.overflows[1]-I.overflows[1])[0])==null?void 0:P.placement;if(!B)switch(j){case"bestFit":{var W;const A=(W=k.filter(I=>{if(S){const M=Ae(I.placement);return M===p||M==="y"}return!0}).map(I=>[I.placement,I.overflows.filter(M=>M>0).reduce((M,_)=>M+_,0)]).sort((I,M)=>I[1]-M[1])[0])==null?void 0:W[0];A&&(B=A);break}case"initialPlacement":B=l;break}if(a!==B)return{reset:{placement:B}}}return{}}}};function Tn(s,t){return{top:s.top-t.height,right:s.right-t.width,bottom:s.bottom-t.height,left:s.left-t.width}}function On(s){return hc.some(t=>s[t]>=0)}const Rc=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=Pe(s,t);switch(r){case"referenceHidden":{const o=await xt(t,{...a,elementContext:"reference"}),i=Tn(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:On(i)}}}case"escaped":{const o=await xt(t,{...a,altBoundary:!0}),i=Tn(o,n.floating);return{data:{escapedOffsets:i,escaped:On(i)}}}default:return{}}}}},Hr=new Set(["left","top"]);async function Ic(s,t){const{placement:n,platform:r,elements:a}=s,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=Te(n),l=st(n),c=Ae(n)==="y",d=Hr.has(i)?-1:1,u=o&&c?-1:1,m=Pe(t,s);let{mainAxis:v,crossAxis:j,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&typeof w=="number"&&(j=l==="end"?w*-1:w),c?{x:j*u,y:v*d}:{x:v*d,y:j*u}}const kc=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:l}=t,c=await Ic(t,s);return i===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},Pc=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:l={fn:h=>{let{x:b,y:p}=h;return{x:b,y:p}}},...c}=Pe(s,t),d={x:n,y:r},u=await xt(t,c),m=Ae(Te(a)),v=Hs(m);let j=d[v],w=d[m];if(o){const h=v==="y"?"top":"left",b=v==="y"?"bottom":"right",p=j+u[h],g=j-u[b];j=Rs(p,j,g)}if(i){const h=m==="y"?"top":"left",b=m==="y"?"bottom":"right",p=w+u[h],g=w-u[b];w=Rs(p,w,g)}const x=l.fn({...t,[v]:j,[m]:w});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[v]:o,[m]:i}}}}}},Tc=function(s){return s===void 0&&(s={}),{options:s,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Pe(s,t),u={x:n,y:r},m=Ae(a),v=Hs(m);let j=u[v],w=u[m];const x=Pe(l,t),h=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const g=v==="y"?"height":"width",y=o.reference[v]-o.floating[g]+h.mainAxis,N=o.reference[v]+o.reference[g]-h.mainAxis;j<y?j=y:j>N&&(j=N)}if(d){var b,p;const g=v==="y"?"width":"height",y=Hr.has(Te(a)),N=o.reference[m]-o.floating[g]+(y&&((b=i.offset)==null?void 0:b[m])||0)+(y?0:h.crossAxis),S=o.reference[m]+o.reference[g]+(y?0:((p=i.offset)==null?void 0:p[m])||0)-(y?h.crossAxis:0);w<N?w=N:w>S&&(w=S)}return{[v]:j,[m]:w}}}},Oc=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(t){var n,r;const{placement:a,rects:o,platform:i,elements:l}=t,{apply:c=()=>{},...d}=Pe(s,t),u=await xt(t,d),m=Te(a),v=st(a),j=Ae(a)==="y",{width:w,height:x}=o.floating;let h,b;m==="top"||m==="bottom"?(h=m,b=v===(await(i.isRTL==null?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(b=m,h=v==="end"?"top":"bottom");const p=x-u.top-u.bottom,g=w-u.left-u.right,y=_e(x-u[h],p),N=_e(w-u[b],g),S=!t.middlewareData.shift;let C=y,E=N;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(E=g),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(C=p),S&&!v){const k=xe(u.left,0),L=xe(u.right,0),P=xe(u.top,0),W=xe(u.bottom,0);j?E=w-2*(k!==0||L!==0?k+L:xe(u.left,u.right)):C=x-2*(P!==0||W!==0?P+W:xe(u.top,u.bottom))}await c({...t,availableWidth:E,availableHeight:C});const F=await i.getDimensions(l.floating);return w!==F.width||x!==F.height?{reset:{rects:!0}}:{}}}};function Xt(){return typeof window<"u"}function nt(s){return Kr(s)?(s.nodeName||"").toLowerCase():"#document"}function ve(s){var t;return(s==null||(t=s.ownerDocument)==null?void 0:t.defaultView)||window}function Ie(s){var t;return(t=(Kr(s)?s.ownerDocument:s.document)||window.document)==null?void 0:t.documentElement}function Kr(s){return Xt()?s instanceof Node||s instanceof ve(s).Node:!1}function ye(s){return Xt()?s instanceof Element||s instanceof ve(s).Element:!1}function Re(s){return Xt()?s instanceof HTMLElement||s instanceof ve(s).HTMLElement:!1}function $n(s){return!Xt()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof ve(s).ShadowRoot}const $c=new Set(["inline","contents"]);function wt(s){const{overflow:t,overflowX:n,overflowY:r,display:a}=je(s);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!$c.has(a)}const Mc=new Set(["table","td","th"]);function Lc(s){return Mc.has(nt(s))}const Dc=[":popover-open",":modal"];function Qt(s){return Dc.some(t=>{try{return s.matches(t)}catch{return!1}})}const _c=["transform","translate","scale","rotate","perspective"],Fc=["transform","translate","scale","rotate","perspective","filter"],Bc=["paint","layout","strict","content"];function Gs(s){const t=Ys(),n=ye(s)?je(s):s;return _c.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||Fc.some(r=>(n.willChange||"").includes(r))||Bc.some(r=>(n.contain||"").includes(r))}function zc(s){let t=Fe(s);for(;Re(t)&&!Ze(t);){if(Gs(t))return t;if(Qt(t))return null;t=Fe(t)}return null}function Ys(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Uc=new Set(["html","body","#document"]);function Ze(s){return Uc.has(nt(s))}function je(s){return ve(s).getComputedStyle(s)}function Jt(s){return ye(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function Fe(s){if(nt(s)==="html")return s;const t=s.assignedSlot||s.parentNode||$n(s)&&s.host||Ie(s);return $n(t)?t.host:t}function qr(s){const t=Fe(s);return Ze(t)?s.ownerDocument?s.ownerDocument.body:s.body:Re(t)&&wt(t)?t:qr(t)}function gt(s,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=qr(s),o=a===((r=s.ownerDocument)==null?void 0:r.body),i=ve(a);if(o){const l=ks(i);return t.concat(i,i.visualViewport||[],wt(a)?a:[],l&&n?gt(l):[])}return t.concat(a,gt(a,[],n))}function ks(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function Gr(s){const t=je(s);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Re(s),o=a?s.offsetWidth:n,i=a?s.offsetHeight:r,l=Ut(n)!==o||Ut(r)!==i;return l&&(n=o,r=i),{width:n,height:r,$:l}}function Xs(s){return ye(s)?s:s.contextElement}function Xe(s){const t=Xs(s);if(!Re(t))return Ee(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=Gr(t);let i=(o?Ut(n.width):n.width)/r,l=(o?Ut(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!l||!Number.isFinite(l))&&(l=1),{x:i,y:l}}const Vc=Ee(0);function Yr(s){const t=ve(s);return!Ys()||!t.visualViewport?Vc:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Wc(s,t,n){return t===void 0&&(t=!1),!n||t&&n!==ve(s)?!1:t}function Ve(s,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=s.getBoundingClientRect(),o=Xs(s);let i=Ee(1);t&&(r?ye(r)&&(i=Xe(r)):i=Xe(s));const l=Wc(o,n,r)?Yr(o):Ee(0);let c=(a.left+l.x)/i.x,d=(a.top+l.y)/i.y,u=a.width/i.x,m=a.height/i.y;if(o){const v=ve(o),j=r&&ye(r)?ve(r):r;let w=v,x=ks(w);for(;x&&r&&j!==w;){const h=Xe(x),b=x.getBoundingClientRect(),p=je(x),g=b.left+(x.clientLeft+parseFloat(p.paddingLeft))*h.x,y=b.top+(x.clientTop+parseFloat(p.paddingTop))*h.y;c*=h.x,d*=h.y,u*=h.x,m*=h.y,c+=g,d+=y,w=ve(x),x=ks(w)}}return Wt({width:u,height:m,x:c,y:d})}function Zt(s,t){const n=Jt(s).scrollLeft;return t?t.left+n:Ve(Ie(s)).left+n}function Xr(s,t){const n=s.getBoundingClientRect(),r=n.left+t.scrollLeft-Zt(s,n),a=n.top+t.scrollTop;return{x:r,y:a}}function Hc(s){let{elements:t,rect:n,offsetParent:r,strategy:a}=s;const o=a==="fixed",i=Ie(r),l=t?Qt(t.floating):!1;if(r===i||l&&o)return n;let c={scrollLeft:0,scrollTop:0},d=Ee(1);const u=Ee(0),m=Re(r);if((m||!m&&!o)&&((nt(r)!=="body"||wt(i))&&(c=Jt(r)),Re(r))){const j=Ve(r);d=Xe(r),u.x=j.x+r.clientLeft,u.y=j.y+r.clientTop}const v=i&&!m&&!o?Xr(i,c):Ee(0);return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-c.scrollLeft*d.x+u.x+v.x,y:n.y*d.y-c.scrollTop*d.y+u.y+v.y}}function Kc(s){return Array.from(s.getClientRects())}function qc(s){const t=Ie(s),n=Jt(s),r=s.ownerDocument.body,a=xe(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=xe(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+Zt(s);const l=-n.scrollTop;return je(r).direction==="rtl"&&(i+=xe(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:l}}const Mn=25;function Gc(s,t){const n=ve(s),r=Ie(s),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,l=0,c=0;if(a){o=a.width,i=a.height;const u=Ys();(!u||u&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}const d=Zt(r);if(d<=0){const u=r.ownerDocument,m=u.body,v=getComputedStyle(m),j=u.compatMode==="CSS1Compat"&&parseFloat(v.marginLeft)+parseFloat(v.marginRight)||0,w=Math.abs(r.clientWidth-m.clientWidth-j);w<=Mn&&(o-=w)}else d<=Mn&&(o+=d);return{width:o,height:i,x:l,y:c}}const Yc=new Set(["absolute","fixed"]);function Xc(s,t){const n=Ve(s,!0,t==="fixed"),r=n.top+s.clientTop,a=n.left+s.clientLeft,o=Re(s)?Xe(s):Ee(1),i=s.clientWidth*o.x,l=s.clientHeight*o.y,c=a*o.x,d=r*o.y;return{width:i,height:l,x:c,y:d}}function Ln(s,t,n){let r;if(t==="viewport")r=Gc(s,n);else if(t==="document")r=qc(Ie(s));else if(ye(t))r=Xc(t,n);else{const a=Yr(s);r={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Wt(r)}function Qr(s,t){const n=Fe(s);return n===t||!ye(n)||Ze(n)?!1:je(n).position==="fixed"||Qr(n,t)}function Qc(s,t){const n=t.get(s);if(n)return n;let r=gt(s,[],!1).filter(l=>ye(l)&&nt(l)!=="body"),a=null;const o=je(s).position==="fixed";let i=o?Fe(s):s;for(;ye(i)&&!Ze(i);){const l=je(i),c=Gs(i);!c&&l.position==="fixed"&&(a=null),(o?!c&&!a:!c&&l.position==="static"&&!!a&&Yc.has(a.position)||wt(i)&&!c&&Qr(s,i))?r=r.filter(u=>u!==i):a=l,i=Fe(i)}return t.set(s,r),r}function Jc(s){let{element:t,boundary:n,rootBoundary:r,strategy:a}=s;const i=[...n==="clippingAncestors"?Qt(t)?[]:Qc(t,this._c):[].concat(n),r],l=i[0],c=i.reduce((d,u)=>{const m=Ln(t,u,a);return d.top=xe(m.top,d.top),d.right=_e(m.right,d.right),d.bottom=_e(m.bottom,d.bottom),d.left=xe(m.left,d.left),d},Ln(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Zc(s){const{width:t,height:n}=Gr(s);return{width:t,height:n}}function ed(s,t,n){const r=Re(t),a=Ie(t),o=n==="fixed",i=Ve(s,!0,o,t);let l={scrollLeft:0,scrollTop:0};const c=Ee(0);function d(){c.x=Zt(a)}if(r||!r&&!o)if((nt(t)!=="body"||wt(a))&&(l=Jt(t)),r){const j=Ve(t,!0,o,t);c.x=j.x+t.clientLeft,c.y=j.y+t.clientTop}else a&&d();o&&!r&&a&&d();const u=a&&!r&&!o?Xr(a,l):Ee(0),m=i.left+l.scrollLeft-c.x-u.x,v=i.top+l.scrollTop-c.y-u.y;return{x:m,y:v,width:i.width,height:i.height}}function ds(s){return je(s).position==="static"}function Dn(s,t){if(!Re(s)||je(s).position==="fixed")return null;if(t)return t(s);let n=s.offsetParent;return Ie(s)===n&&(n=n.ownerDocument.body),n}function Jr(s,t){const n=ve(s);if(Qt(s))return n;if(!Re(s)){let a=Fe(s);for(;a&&!Ze(a);){if(ye(a)&&!ds(a))return a;a=Fe(a)}return n}let r=Dn(s,t);for(;r&&Lc(r)&&ds(r);)r=Dn(r,t);return r&&Ze(r)&&ds(r)&&!Gs(r)?n:r||zc(s)||n}const td=async function(s){const t=this.getOffsetParent||Jr,n=this.getDimensions,r=await n(s.floating);return{reference:ed(s.reference,await t(s.floating),s.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function sd(s){return je(s).direction==="rtl"}const nd={convertOffsetParentRelativeRectToViewportRelativeRect:Hc,getDocumentElement:Ie,getClippingRect:Jc,getOffsetParent:Jr,getElementRects:td,getClientRects:Kc,getDimensions:Zc,getScale:Xe,isElement:ye,isRTL:sd};function Zr(s,t){return s.x===t.x&&s.y===t.y&&s.width===t.width&&s.height===t.height}function rd(s,t){let n=null,r;const a=Ie(s);function o(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function i(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),o();const d=s.getBoundingClientRect(),{left:u,top:m,width:v,height:j}=d;if(l||t(),!v||!j)return;const w=Ct(m),x=Ct(a.clientWidth-(u+v)),h=Ct(a.clientHeight-(m+j)),b=Ct(u),g={rootMargin:-w+"px "+-x+"px "+-h+"px "+-b+"px",threshold:xe(0,_e(1,c))||1};let y=!0;function N(S){const C=S[0].intersectionRatio;if(C!==c){if(!y)return i();C?i(!1,C):r=setTimeout(()=>{i(!1,1e-7)},1e3)}C===1&&!Zr(d,s.getBoundingClientRect())&&i(),y=!1}try{n=new IntersectionObserver(N,{...g,root:a.ownerDocument})}catch{n=new IntersectionObserver(N,g)}n.observe(s)}return i(!0),o}function ad(s,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,d=Xs(s),u=a||o?[...d?gt(d):[],...gt(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const m=d&&l?rd(d,n):null;let v=-1,j=null;i&&(j=new ResizeObserver(b=>{let[p]=b;p&&p.target===d&&j&&(j.unobserve(t),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var g;(g=j)==null||g.observe(t)})),n()}),d&&!c&&j.observe(d),j.observe(t));let w,x=c?Ve(s):null;c&&h();function h(){const b=Ve(s);x&&!Zr(x,b)&&n(),x=b,w=requestAnimationFrame(h)}return n(),()=>{var b;u.forEach(p=>{a&&p.removeEventListener("scroll",n),o&&p.removeEventListener("resize",n)}),m==null||m(),(b=j)==null||b.disconnect(),j=null,c&&cancelAnimationFrame(w)}}const od=kc,id=Pc,ld=Ec,cd=Oc,dd=Rc,_n=Ac,ud=Tc,md=(s,t,n)=>{const r=new Map,a={platform:nd,...n},o={...a.platform,_c:r};return Cc(s,t,{...a,platform:o})};var fd=typeof document<"u",hd=function(){},Tt=fd?f.useLayoutEffect:hd;function Ht(s,t){if(s===t)return!0;if(typeof s!=typeof t)return!1;if(typeof s=="function"&&s.toString()===t.toString())return!0;let n,r,a;if(s&&t&&typeof s=="object"){if(Array.isArray(s)){if(n=s.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Ht(s[r],t[r]))return!1;return!0}if(a=Object.keys(s),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&s.$$typeof)&&!Ht(s[o],t[o]))return!1}return!0}return s!==s&&t!==t}function ea(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function Fn(s,t){const n=ea(s);return Math.round(t*n)/n}function us(s){const t=f.useRef(s);return Tt(()=>{t.current=s}),t}function pd(s){s===void 0&&(s={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:l=!0,whileElementsMounted:c,open:d}=s,[u,m]=f.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[v,j]=f.useState(r);Ht(v,r)||j(r);const[w,x]=f.useState(null),[h,b]=f.useState(null),p=f.useCallback(I=>{I!==S.current&&(S.current=I,x(I))},[]),g=f.useCallback(I=>{I!==C.current&&(C.current=I,b(I))},[]),y=o||w,N=i||h,S=f.useRef(null),C=f.useRef(null),E=f.useRef(u),F=c!=null,k=us(c),L=us(a),P=us(d),W=f.useCallback(()=>{if(!S.current||!C.current)return;const I={placement:t,strategy:n,middleware:v};L.current&&(I.platform=L.current),md(S.current,C.current,I).then(M=>{const _={...M,isPositioned:P.current!==!1};H.current&&!Ht(E.current,_)&&(E.current=_,vt.flushSync(()=>{m(_)}))})},[v,t,n,L,P]);Tt(()=>{d===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,m(I=>({...I,isPositioned:!1})))},[d]);const H=f.useRef(!1);Tt(()=>(H.current=!0,()=>{H.current=!1}),[]),Tt(()=>{if(y&&(S.current=y),N&&(C.current=N),y&&N){if(k.current)return k.current(y,N,W);W()}},[y,N,W,k,F]);const X=f.useMemo(()=>({reference:S,floating:C,setReference:p,setFloating:g}),[p,g]),B=f.useMemo(()=>({reference:y,floating:N}),[y,N]),A=f.useMemo(()=>{const I={position:n,left:0,top:0};if(!B.floating)return I;const M=Fn(B.floating,u.x),_=Fn(B.floating,u.y);return l?{...I,transform:"translate("+M+"px, "+_+"px)",...ea(B.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:M,top:_}},[n,l,B.floating,u.x,u.y]);return f.useMemo(()=>({...u,update:W,refs:X,elements:B,floatingStyles:A}),[u,W,X,B,A])}const xd=s=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:s,fn(n){const{element:r,padding:a}=typeof s=="function"?s(n):s;return r&&t(r)?r.current!=null?_n({element:r.current,padding:a}).fn(n):{}:r?_n({element:r,padding:a}).fn(n):{}}}},gd=(s,t)=>({...od(s),options:[s,t]}),vd=(s,t)=>({...id(s),options:[s,t]}),bd=(s,t)=>({...ud(s),options:[s,t]}),yd=(s,t)=>({...ld(s),options:[s,t]}),jd=(s,t)=>({...cd(s),options:[s,t]}),wd=(s,t)=>({...dd(s),options:[s,t]}),Nd=(s,t)=>({...xd(s),options:[s,t]});var Sd="Arrow",ta=f.forwardRef((s,t)=>{const{children:n,width:r=10,height:a=5,...o}=s;return e.jsx(ne.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?n:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});ta.displayName=Sd;var Cd=ta;function Ad(s){const[t,n]=f.useState(void 0);return de(()=>{if(s){n({width:s.offsetWidth,height:s.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,l;if("borderBoxSize"in o){const c=o.borderBoxSize,d=Array.isArray(c)?c[0]:c;i=d.inlineSize,l=d.blockSize}else i=s.offsetWidth,l=s.offsetHeight;n({width:i,height:l})});return r.observe(s,{box:"border-box"}),()=>r.unobserve(s)}else n(void 0)},[s]),t}var Qs="Popper",[sa,na]=tt(Qs),[Ed,ra]=sa(Qs),aa=s=>{const{__scopePopper:t,children:n}=s,[r,a]=f.useState(null);return e.jsx(Ed,{scope:t,anchor:r,onAnchorChange:a,children:n})};aa.displayName=Qs;var oa="PopperAnchor",ia=f.forwardRef((s,t)=>{const{__scopePopper:n,virtualRef:r,...a}=s,o=ra(oa,n),i=f.useRef(null),l=le(t,i),c=f.useRef(null);return f.useEffect(()=>{const d=c.current;c.current=(r==null?void 0:r.current)||i.current,d!==c.current&&o.onAnchorChange(c.current)}),r?null:e.jsx(ne.div,{...a,ref:l})});ia.displayName=oa;var Js="PopperContent",[Rd,Id]=sa(Js),la=f.forwardRef((s,t)=>{var O,G,ee,te,Q,re;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:m="partial",hideWhenDetached:v=!1,updatePositionStrategy:j="optimized",onPlaced:w,...x}=s,h=ra(Js,n),[b,p]=f.useState(null),g=le(t,pe=>p(pe)),[y,N]=f.useState(null),S=Ad(y),C=(S==null?void 0:S.width)??0,E=(S==null?void 0:S.height)??0,F=r+(o!=="center"?"-"+o:""),k=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(d)?d:[d],P=L.length>0,W={padding:k,boundary:L.filter(Pd),altBoundary:P},{refs:H,floatingStyles:X,placement:B,isPositioned:A,middlewareData:I}=pd({strategy:"fixed",placement:F,whileElementsMounted:(...pe)=>ad(...pe,{animationFrame:j==="always"}),elements:{reference:h.anchor},middleware:[gd({mainAxis:a+E,alignmentAxis:i}),c&&vd({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?bd():void 0,...W}),c&&yd({...W}),jd({...W,apply:({elements:pe,rects:we,availableWidth:at,availableHeight:ot})=>{const{width:it,height:lo}=we.reference,Nt=pe.floating.style;Nt.setProperty("--radix-popper-available-width",`${at}px`),Nt.setProperty("--radix-popper-available-height",`${ot}px`),Nt.setProperty("--radix-popper-anchor-width",`${it}px`),Nt.setProperty("--radix-popper-anchor-height",`${lo}px`)}}),y&&Nd({element:y,padding:l}),Td({arrowWidth:C,arrowHeight:E}),v&&wd({strategy:"referenceHidden",...W})]}),[M,_]=ua(B),z=De(w);de(()=>{A&&(z==null||z())},[A,z]);const oe=(O=I.arrow)==null?void 0:O.x,R=(G=I.arrow)==null?void 0:G.y,$=((ee=I.arrow)==null?void 0:ee.centerOffset)!==0,[D,U]=f.useState();return de(()=>{b&&U(window.getComputedStyle(b).zIndex)},[b]),e.jsx("div",{ref:H.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:A?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:D,"--radix-popper-transform-origin":[(te=I.transformOrigin)==null?void 0:te.x,(Q=I.transformOrigin)==null?void 0:Q.y].join(" "),...((re=I.hide)==null?void 0:re.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:e.jsx(Rd,{scope:n,placedSide:M,onArrowChange:N,arrowX:oe,arrowY:R,shouldHideArrow:$,children:e.jsx(ne.div,{"data-side":M,"data-align":_,...x,ref:g,style:{...x.style,animation:A?void 0:"none"}})})})});la.displayName=Js;var ca="PopperArrow",kd={top:"bottom",right:"left",bottom:"top",left:"right"},da=f.forwardRef(function(t,n){const{__scopePopper:r,...a}=t,o=Id(ca,r),i=kd[o.placedSide];return e.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:e.jsx(Cd,{...a,ref:n,style:{...a.style,display:"block"}})})});da.displayName=ca;function Pd(s){return s!==null}var Td=s=>({name:"transformOrigin",options:s,fn(t){var h,b,p;const{placement:n,rects:r,middlewareData:a}=t,i=((h=a.arrow)==null?void 0:h.centerOffset)!==0,l=i?0:s.arrowWidth,c=i?0:s.arrowHeight,[d,u]=ua(n),m={start:"0%",center:"50%",end:"100%"}[u],v=(((b=a.arrow)==null?void 0:b.x)??0)+l/2,j=(((p=a.arrow)==null?void 0:p.y)??0)+c/2;let w="",x="";return d==="bottom"?(w=i?m:`${v}px`,x=`${-c}px`):d==="top"?(w=i?m:`${v}px`,x=`${r.floating.height+c}px`):d==="right"?(w=`${-c}px`,x=i?m:`${j}px`):d==="left"&&(w=`${r.floating.width+c}px`,x=i?m:`${j}px`),{data:{x:w,y:x}}}});function ua(s){const[t,n="center"]=s.split("-");return[t,n]}var Od=aa,$d=ia,Md=la,Ld=da,Dd="Portal",ma=f.forwardRef((s,t)=>{var l;const{container:n,...r}=s,[a,o]=f.useState(!1);de(()=>o(!0),[]);const i=n||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return i?po.createPortal(e.jsx(ne.div,{...r,ref:t}),i):null});ma.displayName=Dd;function _d(s){const t=f.useRef({value:s,previous:s});return f.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])}var fa=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Fd="VisuallyHidden",Bd=f.forwardRef((s,t)=>e.jsx(ne.span,{...s,ref:t,style:{...fa,...s.style}}));Bd.displayName=Fd;var zd=function(s){if(typeof document>"u")return null;var t=Array.isArray(s)?s[0]:s;return t.ownerDocument.body},Ke=new WeakMap,At=new WeakMap,Et={},ms=0,ha=function(s){return s&&(s.host||ha(s.parentNode))},Ud=function(s,t){return t.map(function(n){if(s.contains(n))return n;var r=ha(n);return r&&s.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",s,". Doing nothing"),null)}).filter(function(n){return!!n})},Vd=function(s,t,n,r){var a=Ud(t,Array.isArray(s)?s:[s]);Et[n]||(Et[n]=new WeakMap);var o=Et[n],i=[],l=new Set,c=new Set(a),d=function(m){!m||l.has(m)||(l.add(m),d(m.parentNode))};a.forEach(d);var u=function(m){!m||c.has(m)||Array.prototype.forEach.call(m.children,function(v){if(l.has(v))u(v);else try{var j=v.getAttribute(r),w=j!==null&&j!=="false",x=(Ke.get(v)||0)+1,h=(o.get(v)||0)+1;Ke.set(v,x),o.set(v,h),i.push(v),x===1&&w&&At.set(v,!0),h===1&&v.setAttribute(n,"true"),w||v.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",v,b)}})};return u(t),l.clear(),ms++,function(){i.forEach(function(m){var v=Ke.get(m)-1,j=o.get(m)-1;Ke.set(m,v),o.set(m,j),v||(At.has(m)||m.removeAttribute(r),At.delete(m)),j||m.removeAttribute(n)}),ms--,ms||(Ke=new WeakMap,Ke=new WeakMap,At=new WeakMap,Et={})}},Wd=function(s,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(s)?s:[s]),a=zd(s);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live], script"))),Vd(r,a,n,"aria-hidden")):function(){return null}},Se=function(){return Se=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Se.apply(this,arguments)};function pa(s,t){var n={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&t.indexOf(r)<0&&(n[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(s);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(s,r[a])&&(n[r[a]]=s[r[a]]);return n}function Hd(s,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return s.concat(o||Array.prototype.slice.call(t))}var Ot="right-scroll-bar-position",$t="width-before-scroll-bar",Kd="with-scroll-bars-hidden",qd="--removed-body-scroll-bar-size";function fs(s,t){return typeof s=="function"?s(t):s&&(s.current=t),s}function Gd(s,t){var n=f.useState(function(){return{value:s,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var Yd=typeof window<"u"?f.useLayoutEffect:f.useEffect,Bn=new WeakMap;function Xd(s,t){var n=Gd(null,function(r){return s.forEach(function(a){return fs(a,r)})});return Yd(function(){var r=Bn.get(n);if(r){var a=new Set(r),o=new Set(s),i=n.current;a.forEach(function(l){o.has(l)||fs(l,null)}),o.forEach(function(l){a.has(l)||fs(l,i)})}Bn.set(n,s)},[s]),n}function Qd(s){return s}function Jd(s,t){t===void 0&&(t=Qd);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:s},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(l){return l!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(l){return o(l)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var l=n;n=[],l.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},d=function(){return Promise.resolve().then(c)};d(),n={push:function(u){i.push(u),d()},filter:function(u){return i=i.filter(u),n}}}};return a}function Zd(s){s===void 0&&(s={});var t=Jd(null);return t.options=Se({async:!0,ssr:!1},s),t}var xa=function(s){var t=s.sideCar,n=pa(s,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return f.createElement(r,Se({},n))};xa.isSideCarExport=!0;function eu(s,t){return s.useMedium(t),xa}var ga=Zd(),hs=function(){},es=f.forwardRef(function(s,t){var n=f.useRef(null),r=f.useState({onScrollCapture:hs,onWheelCapture:hs,onTouchMoveCapture:hs}),a=r[0],o=r[1],i=s.forwardProps,l=s.children,c=s.className,d=s.removeScrollBar,u=s.enabled,m=s.shards,v=s.sideCar,j=s.noRelative,w=s.noIsolation,x=s.inert,h=s.allowPinchZoom,b=s.as,p=b===void 0?"div":b,g=s.gapMode,y=pa(s,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),N=v,S=Xd([n,t]),C=Se(Se({},y),a);return f.createElement(f.Fragment,null,u&&f.createElement(N,{sideCar:ga,removeScrollBar:d,shards:m,noRelative:j,noIsolation:w,inert:x,setCallbacks:o,allowPinchZoom:!!h,lockRef:n,gapMode:g}),i?f.cloneElement(f.Children.only(l),Se(Se({},C),{ref:S})):f.createElement(p,Se({},C,{className:c,ref:S}),l))});es.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};es.classNames={fullWidth:$t,zeroRight:Ot};var tu=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function su(){if(!document)return null;var s=document.createElement("style");s.type="text/css";var t=tu();return t&&s.setAttribute("nonce",t),s}function nu(s,t){s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}function ru(s){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(s)}var au=function(){var s=0,t=null;return{add:function(n){s==0&&(t=su())&&(nu(t,n),ru(t)),s++},remove:function(){s--,!s&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},ou=function(){var s=au();return function(t,n){f.useEffect(function(){return s.add(t),function(){s.remove()}},[t&&n])}},va=function(){var s=ou(),t=function(n){var r=n.styles,a=n.dynamic;return s(r,a),null};return t},iu={left:0,top:0,right:0,gap:0},ps=function(s){return parseInt(s||"",10)||0},lu=function(s){var t=window.getComputedStyle(document.body),n=t[s==="padding"?"paddingLeft":"marginLeft"],r=t[s==="padding"?"paddingTop":"marginTop"],a=t[s==="padding"?"paddingRight":"marginRight"];return[ps(n),ps(r),ps(a)]},cu=function(s){if(s===void 0&&(s="margin"),typeof window>"u")return iu;var t=lu(s),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},du=va(),Qe="data-scroll-locked",uu=function(s,t,n,r){var a=s.left,o=s.top,i=s.right,l=s.gap;return n===void 0&&(n="margin"),`
  .`.concat(Kd,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Qe,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ot,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat($t,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Ot," .").concat(Ot,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat($t," .").concat($t,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Qe,`] {
    `).concat(qd,": ").concat(l,`px;
  }
`)},zn=function(){var s=parseInt(document.body.getAttribute(Qe)||"0",10);return isFinite(s)?s:0},mu=function(){f.useEffect(function(){return document.body.setAttribute(Qe,(zn()+1).toString()),function(){var s=zn()-1;s<=0?document.body.removeAttribute(Qe):document.body.setAttribute(Qe,s.toString())}},[])},fu=function(s){var t=s.noRelative,n=s.noImportant,r=s.gapMode,a=r===void 0?"margin":r;mu();var o=f.useMemo(function(){return cu(a)},[a]);return f.createElement(du,{styles:uu(o,!t,a,n?"":"!important")})},Ps=!1;if(typeof window<"u")try{var Rt=Object.defineProperty({},"passive",{get:function(){return Ps=!0,!0}});window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch{Ps=!1}var qe=Ps?{passive:!1}:!1,hu=function(s){return s.tagName==="TEXTAREA"},ba=function(s,t){if(!(s instanceof Element))return!1;var n=window.getComputedStyle(s);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!hu(s)&&n[t]==="visible")},pu=function(s){return ba(s,"overflowY")},xu=function(s){return ba(s,"overflowX")},Un=function(s,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=ya(s,r);if(a){var o=ja(s,r),i=o[1],l=o[2];if(i>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},gu=function(s){var t=s.scrollTop,n=s.scrollHeight,r=s.clientHeight;return[t,n,r]},vu=function(s){var t=s.scrollLeft,n=s.scrollWidth,r=s.clientWidth;return[t,n,r]},ya=function(s,t){return s==="v"?pu(t):xu(t)},ja=function(s,t){return s==="v"?gu(t):vu(t)},bu=function(s,t){return s==="h"&&t==="rtl"?-1:1},yu=function(s,t,n,r,a){var o=bu(s,window.getComputedStyle(t).direction),i=o*r,l=n.target,c=t.contains(l),d=!1,u=i>0,m=0,v=0;do{if(!l)break;var j=ja(s,l),w=j[0],x=j[1],h=j[2],b=x-h-o*w;(w||b)&&ya(s,l)&&(m+=b,v+=w);var p=l.parentNode;l=p&&p.nodeType===Node.DOCUMENT_FRAGMENT_NODE?p.host:p}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&Math.abs(m)<1||!u&&Math.abs(v)<1)&&(d=!0),d},It=function(s){return"changedTouches"in s?[s.changedTouches[0].clientX,s.changedTouches[0].clientY]:[0,0]},Vn=function(s){return[s.deltaX,s.deltaY]},Wn=function(s){return s&&"current"in s?s.current:s},ju=function(s,t){return s[0]===t[0]&&s[1]===t[1]},wu=function(s){return`
  .block-interactivity-`.concat(s,` {pointer-events: none;}
  .allow-interactivity-`).concat(s,` {pointer-events: all;}
`)},Nu=0,Ge=[];function Su(s){var t=f.useRef([]),n=f.useRef([0,0]),r=f.useRef(),a=f.useState(Nu++)[0],o=f.useState(va)[0],i=f.useRef(s);f.useEffect(function(){i.current=s},[s]),f.useEffect(function(){if(s.inert){document.body.classList.add("block-interactivity-".concat(a));var x=Hd([s.lockRef.current],(s.shards||[]).map(Wn),!0).filter(Boolean);return x.forEach(function(h){return h.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),x.forEach(function(h){return h.classList.remove("allow-interactivity-".concat(a))})}}},[s.inert,s.lockRef.current,s.shards]);var l=f.useCallback(function(x,h){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!i.current.allowPinchZoom;var b=It(x),p=n.current,g="deltaX"in x?x.deltaX:p[0]-b[0],y="deltaY"in x?x.deltaY:p[1]-b[1],N,S=x.target,C=Math.abs(g)>Math.abs(y)?"h":"v";if("touches"in x&&C==="h"&&S.type==="range")return!1;var E=Un(C,S);if(!E)return!0;if(E?N=C:(N=C==="v"?"h":"v",E=Un(C,S)),!E)return!1;if(!r.current&&"changedTouches"in x&&(g||y)&&(r.current=N),!N)return!0;var F=r.current||N;return yu(F,h,x,F==="h"?g:y)},[]),c=f.useCallback(function(x){var h=x;if(!(!Ge.length||Ge[Ge.length-1]!==o)){var b="deltaY"in h?Vn(h):It(h),p=t.current.filter(function(N){return N.name===h.type&&(N.target===h.target||h.target===N.shadowParent)&&ju(N.delta,b)})[0];if(p&&p.should){h.cancelable&&h.preventDefault();return}if(!p){var g=(i.current.shards||[]).map(Wn).filter(Boolean).filter(function(N){return N.contains(h.target)}),y=g.length>0?l(h,g[0]):!i.current.noIsolation;y&&h.cancelable&&h.preventDefault()}}},[]),d=f.useCallback(function(x,h,b,p){var g={name:x,delta:h,target:b,should:p,shadowParent:Cu(b)};t.current.push(g),setTimeout(function(){t.current=t.current.filter(function(y){return y!==g})},1)},[]),u=f.useCallback(function(x){n.current=It(x),r.current=void 0},[]),m=f.useCallback(function(x){d(x.type,Vn(x),x.target,l(x,s.lockRef.current))},[]),v=f.useCallback(function(x){d(x.type,It(x),x.target,l(x,s.lockRef.current))},[]);f.useEffect(function(){return Ge.push(o),s.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:v}),document.addEventListener("wheel",c,qe),document.addEventListener("touchmove",c,qe),document.addEventListener("touchstart",u,qe),function(){Ge=Ge.filter(function(x){return x!==o}),document.removeEventListener("wheel",c,qe),document.removeEventListener("touchmove",c,qe),document.removeEventListener("touchstart",u,qe)}},[]);var j=s.removeScrollBar,w=s.inert;return f.createElement(f.Fragment,null,w?f.createElement(o,{styles:wu(a)}):null,j?f.createElement(fu,{noRelative:s.noRelative,gapMode:s.gapMode}):null)}function Cu(s){for(var t=null;s!==null;)s instanceof ShadowRoot&&(t=s.host,s=s.host),s=s.parentNode;return t}const Au=eu(ga,Su);var wa=f.forwardRef(function(s,t){return f.createElement(es,Se({},s,{ref:t,sideCar:Au}))});wa.classNames=es.classNames;var Eu=[" ","Enter","ArrowUp","ArrowDown"],Ru=[" ","Enter"],We="Select",[ts,ss,Iu]=ur(We),[rt,pm]=tt(We,[Iu,na]),ns=na(),[ku,ze]=rt(We),[Pu,Tu]=rt(We),Na=s=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:m,disabled:v,required:j,form:w}=s,x=ns(t),[h,b]=f.useState(null),[p,g]=f.useState(null),[y,N]=f.useState(!1),S=zs(d),[C,E]=Bt({prop:r,defaultProp:a??!1,onChange:o,caller:We}),[F,k]=Bt({prop:i,defaultProp:l,onChange:c,caller:We}),L=f.useRef(null),P=h?w||!!h.closest("form"):!0,[W,H]=f.useState(new Set),X=Array.from(W).map(B=>B.props.value).join(";");return e.jsx(Od,{...x,children:e.jsxs(ku,{required:j,scope:t,trigger:h,onTriggerChange:b,valueNode:p,onValueNodeChange:g,valueNodeHasChildren:y,onValueNodeHasChildrenChange:N,contentId:bt(),value:F,onValueChange:k,open:C,onOpenChange:E,dir:S,triggerPointerDownPosRef:L,disabled:v,children:[e.jsx(ts.Provider,{scope:t,children:e.jsx(Pu,{scope:s.__scopeSelect,onNativeOptionAdd:f.useCallback(B=>{H(A=>new Set(A).add(B))},[]),onNativeOptionRemove:f.useCallback(B=>{H(A=>{const I=new Set(A);return I.delete(B),I})},[]),children:n})}),P?e.jsxs(qa,{"aria-hidden":!0,required:j,tabIndex:-1,name:u,autoComplete:m,value:F,onChange:B=>k(B.target.value),disabled:v,form:w,children:[F===void 0?e.jsx("option",{value:""}):null,Array.from(W)]},X):null]})})};Na.displayName=We;var Sa="SelectTrigger",Ca=f.forwardRef((s,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=s,o=ns(n),i=ze(Sa,n),l=i.disabled||r,c=le(t,i.onTriggerChange),d=ss(n),u=f.useRef("touch"),[m,v,j]=Ya(x=>{const h=d().filter(g=>!g.disabled),b=h.find(g=>g.value===i.value),p=Xa(h,x,b);p!==void 0&&i.onValueChange(p.value)}),w=x=>{l||(i.onOpenChange(!0),j()),x&&(i.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return e.jsx($d,{asChild:!0,...o,children:e.jsx(ne.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Ga(i.value)?"":void 0,...a,ref:c,onClick:se(a.onClick,x=>{x.currentTarget.focus(),u.current!=="mouse"&&w(x)}),onPointerDown:se(a.onPointerDown,x=>{u.current=x.pointerType;const h=x.target;h.hasPointerCapture(x.pointerId)&&h.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(w(x),x.preventDefault())}),onKeyDown:se(a.onKeyDown,x=>{const h=m.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&v(x.key),!(h&&x.key===" ")&&Eu.includes(x.key)&&(w(),x.preventDefault())})})})});Ca.displayName=Sa;var Aa="SelectValue",Ea=f.forwardRef((s,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...l}=s,c=ze(Aa,n),{onValueNodeHasChildrenChange:d}=c,u=o!==void 0,m=le(t,c.onValueNodeChange);return de(()=>{d(u)},[d,u]),e.jsx(ne.span,{...l,ref:m,style:{pointerEvents:"none"},children:Ga(c.value)?e.jsx(e.Fragment,{children:i}):o})});Ea.displayName=Aa;var Ou="SelectIcon",Ra=f.forwardRef((s,t)=>{const{__scopeSelect:n,children:r,...a}=s;return e.jsx(ne.span,{"aria-hidden":!0,...a,ref:t,children:r||"▼"})});Ra.displayName=Ou;var $u="SelectPortal",Ia=s=>e.jsx(ma,{asChild:!0,...s});Ia.displayName=$u;var He="SelectContent",ka=f.forwardRef((s,t)=>{const n=ze(He,s.__scopeSelect),[r,a]=f.useState();if(de(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?vt.createPortal(e.jsx(Pa,{scope:s.__scopeSelect,children:e.jsx(ts.Slot,{scope:s.__scopeSelect,children:e.jsx("div",{children:s.children})})}),o):null}return e.jsx(Ta,{...s,ref:t})});ka.displayName=He;var be=10,[Pa,Ue]=rt(He),Mu="SelectContentImpl",Lu=ht("SelectContent.RemoveScroll"),Ta=f.forwardRef((s,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:m,collisionBoundary:v,collisionPadding:j,sticky:w,hideWhenDetached:x,avoidCollisions:h,...b}=s,p=ze(He,n),[g,y]=f.useState(null),[N,S]=f.useState(null),C=le(t,O=>y(O)),[E,F]=f.useState(null),[k,L]=f.useState(null),P=ss(n),[W,H]=f.useState(!1),X=f.useRef(!1);f.useEffect(()=>{if(g)return Wd(g)},[g]),oc();const B=f.useCallback(O=>{const[G,...ee]=P().map(re=>re.ref.current),[te]=ee.slice(-1),Q=document.activeElement;for(const re of O)if(re===Q||(re==null||re.scrollIntoView({block:"nearest"}),re===G&&N&&(N.scrollTop=0),re===te&&N&&(N.scrollTop=N.scrollHeight),re==null||re.focus(),document.activeElement!==Q))return},[P,N]),A=f.useCallback(()=>B([E,g]),[B,E,g]);f.useEffect(()=>{W&&A()},[W,A]);const{onOpenChange:I,triggerPointerDownPosRef:M}=p;f.useEffect(()=>{if(g){let O={x:0,y:0};const G=te=>{var Q,re;O={x:Math.abs(Math.round(te.pageX)-(((Q=M.current)==null?void 0:Q.x)??0)),y:Math.abs(Math.round(te.pageY)-(((re=M.current)==null?void 0:re.y)??0))}},ee=te=>{O.x<=10&&O.y<=10?te.preventDefault():g.contains(te.target)||I(!1),document.removeEventListener("pointermove",G),M.current=null};return M.current!==null&&(document.addEventListener("pointermove",G),document.addEventListener("pointerup",ee,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",G),document.removeEventListener("pointerup",ee,{capture:!0})}}},[g,I,M]),f.useEffect(()=>{const O=()=>I(!1);return window.addEventListener("blur",O),window.addEventListener("resize",O),()=>{window.removeEventListener("blur",O),window.removeEventListener("resize",O)}},[I]);const[_,z]=Ya(O=>{const G=P().filter(Q=>!Q.disabled),ee=G.find(Q=>Q.ref.current===document.activeElement),te=Xa(G,O,ee);te&&setTimeout(()=>te.ref.current.focus())}),oe=f.useCallback((O,G,ee)=>{const te=!X.current&&!ee;(p.value!==void 0&&p.value===G||te)&&(F(O),te&&(X.current=!0))},[p.value]),R=f.useCallback(()=>g==null?void 0:g.focus(),[g]),$=f.useCallback((O,G,ee)=>{const te=!X.current&&!ee;(p.value!==void 0&&p.value===G||te)&&L(O)},[p.value]),D=r==="popper"?Ts:Oa,U=D===Ts?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:m,collisionBoundary:v,collisionPadding:j,sticky:w,hideWhenDetached:x,avoidCollisions:h}:{};return e.jsx(Pa,{scope:n,content:g,viewport:N,onViewportChange:S,itemRefCallback:oe,selectedItem:E,onItemLeave:R,itemTextRefCallback:$,focusSelectedItem:A,selectedItemText:k,position:r,isPositioned:W,searchRef:_,children:e.jsx(wa,{as:Lu,allowPinchZoom:!0,children:e.jsx(Ur,{asChild:!0,trapped:p.open,onMountAutoFocus:O=>{O.preventDefault()},onUnmountAutoFocus:se(a,O=>{var G;(G=p.trigger)==null||G.focus({preventScroll:!0}),O.preventDefault()}),children:e.jsx(Br,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:O=>O.preventDefault(),onDismiss:()=>p.onOpenChange(!1),children:e.jsx(D,{role:"listbox",id:p.contentId,"data-state":p.open?"open":"closed",dir:p.dir,onContextMenu:O=>O.preventDefault(),...b,...U,onPlaced:()=>H(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:se(b.onKeyDown,O=>{const G=O.ctrlKey||O.altKey||O.metaKey;if(O.key==="Tab"&&O.preventDefault(),!G&&O.key.length===1&&z(O.key),["ArrowUp","ArrowDown","Home","End"].includes(O.key)){let te=P().filter(Q=>!Q.disabled).map(Q=>Q.ref.current);if(["ArrowUp","End"].includes(O.key)&&(te=te.slice().reverse()),["ArrowUp","ArrowDown"].includes(O.key)){const Q=O.target,re=te.indexOf(Q);te=te.slice(re+1)}setTimeout(()=>B(te)),O.preventDefault()}})})})})})})});Ta.displayName=Mu;var Du="SelectItemAlignedPosition",Oa=f.forwardRef((s,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=s,o=ze(He,n),i=Ue(He,n),[l,c]=f.useState(null),[d,u]=f.useState(null),m=le(t,C=>u(C)),v=ss(n),j=f.useRef(!1),w=f.useRef(!0),{viewport:x,selectedItem:h,selectedItemText:b,focusSelectedItem:p}=i,g=f.useCallback(()=>{if(o.trigger&&o.valueNode&&l&&d&&x&&h&&b){const C=o.trigger.getBoundingClientRect(),E=d.getBoundingClientRect(),F=o.valueNode.getBoundingClientRect(),k=b.getBoundingClientRect();if(o.dir!=="rtl"){const Q=k.left-E.left,re=F.left-Q,pe=C.left-re,we=C.width+pe,at=Math.max(we,E.width),ot=window.innerWidth-be,it=jn(re,[be,Math.max(be,ot-at)]);l.style.minWidth=we+"px",l.style.left=it+"px"}else{const Q=E.right-k.right,re=window.innerWidth-F.right-Q,pe=window.innerWidth-C.right-re,we=C.width+pe,at=Math.max(we,E.width),ot=window.innerWidth-be,it=jn(re,[be,Math.max(be,ot-at)]);l.style.minWidth=we+"px",l.style.right=it+"px"}const L=v(),P=window.innerHeight-be*2,W=x.scrollHeight,H=window.getComputedStyle(d),X=parseInt(H.borderTopWidth,10),B=parseInt(H.paddingTop,10),A=parseInt(H.borderBottomWidth,10),I=parseInt(H.paddingBottom,10),M=X+B+W+I+A,_=Math.min(h.offsetHeight*5,M),z=window.getComputedStyle(x),oe=parseInt(z.paddingTop,10),R=parseInt(z.paddingBottom,10),$=C.top+C.height/2-be,D=P-$,U=h.offsetHeight/2,O=h.offsetTop+U,G=X+B+O,ee=M-G;if(G<=$){const Q=L.length>0&&h===L[L.length-1].ref.current;l.style.bottom="0px";const re=d.clientHeight-x.offsetTop-x.offsetHeight,pe=Math.max(D,U+(Q?R:0)+re+A),we=G+pe;l.style.height=we+"px"}else{const Q=L.length>0&&h===L[0].ref.current;l.style.top="0px";const pe=Math.max($,X+x.offsetTop+(Q?oe:0)+U)+ee;l.style.height=pe+"px",x.scrollTop=G-$+x.offsetTop}l.style.margin=`${be}px 0`,l.style.minHeight=_+"px",l.style.maxHeight=P+"px",r==null||r(),requestAnimationFrame(()=>j.current=!0)}},[v,o.trigger,o.valueNode,l,d,x,h,b,o.dir,r]);de(()=>g(),[g]);const[y,N]=f.useState();de(()=>{d&&N(window.getComputedStyle(d).zIndex)},[d]);const S=f.useCallback(C=>{C&&w.current===!0&&(g(),p==null||p(),w.current=!1)},[g,p]);return e.jsx(Fu,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:j,onScrollButtonChange:S,children:e.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:y},children:e.jsx(ne.div,{...a,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Oa.displayName=Du;var _u="SelectPopperPosition",Ts=f.forwardRef((s,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=be,...o}=s,i=ns(n);return e.jsx(Md,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Ts.displayName=_u;var[Fu,Zs]=rt(He,{}),Os="SelectViewport",$a=f.forwardRef((s,t)=>{const{__scopeSelect:n,nonce:r,...a}=s,o=Ue(Os,n),i=Zs(Os,n),l=le(t,o.onViewportChange),c=f.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),e.jsx(ts.Slot,{scope:n,children:e.jsx(ne.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:se(a.onScroll,d=>{const u=d.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:v}=i;if(v!=null&&v.current&&m){const j=Math.abs(c.current-u.scrollTop);if(j>0){const w=window.innerHeight-be*2,x=parseFloat(m.style.minHeight),h=parseFloat(m.style.height),b=Math.max(x,h);if(b<w){const p=b+j,g=Math.min(w,p),y=p-g;m.style.height=g+"px",m.style.bottom==="0px"&&(u.scrollTop=y>0?y:0,m.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});$a.displayName=Os;var Ma="SelectGroup",[Bu,zu]=rt(Ma),Uu=f.forwardRef((s,t)=>{const{__scopeSelect:n,...r}=s,a=bt();return e.jsx(Bu,{scope:n,id:a,children:e.jsx(ne.div,{role:"group","aria-labelledby":a,...r,ref:t})})});Uu.displayName=Ma;var La="SelectLabel",Da=f.forwardRef((s,t)=>{const{__scopeSelect:n,...r}=s,a=zu(La,n);return e.jsx(ne.div,{id:a.id,...r,ref:t})});Da.displayName=La;var Kt="SelectItem",[Vu,_a]=rt(Kt),Fa=f.forwardRef((s,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=s,l=ze(Kt,n),c=Ue(Kt,n),d=l.value===r,[u,m]=f.useState(o??""),[v,j]=f.useState(!1),w=le(t,p=>{var g;return(g=c.itemRefCallback)==null?void 0:g.call(c,p,r,a)}),x=bt(),h=f.useRef("touch"),b=()=>{a||(l.onValueChange(r),l.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(Vu,{scope:n,value:r,disabled:a,textId:x,isSelected:d,onItemTextChange:f.useCallback(p=>{m(g=>g||((p==null?void 0:p.textContent)??"").trim())},[]),children:e.jsx(ts.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:e.jsx(ne.div,{role:"option","aria-labelledby":x,"data-highlighted":v?"":void 0,"aria-selected":d&&v,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:w,onFocus:se(i.onFocus,()=>j(!0)),onBlur:se(i.onBlur,()=>j(!1)),onClick:se(i.onClick,()=>{h.current!=="mouse"&&b()}),onPointerUp:se(i.onPointerUp,()=>{h.current==="mouse"&&b()}),onPointerDown:se(i.onPointerDown,p=>{h.current=p.pointerType}),onPointerMove:se(i.onPointerMove,p=>{var g;h.current=p.pointerType,a?(g=c.onItemLeave)==null||g.call(c):h.current==="mouse"&&p.currentTarget.focus({preventScroll:!0})}),onPointerLeave:se(i.onPointerLeave,p=>{var g;p.currentTarget===document.activeElement&&((g=c.onItemLeave)==null||g.call(c))}),onKeyDown:se(i.onKeyDown,p=>{var y;((y=c.searchRef)==null?void 0:y.current)!==""&&p.key===" "||(Ru.includes(p.key)&&b(),p.key===" "&&p.preventDefault())})})})})});Fa.displayName=Kt;var ut="SelectItemText",Ba=f.forwardRef((s,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=s,i=ze(ut,n),l=Ue(ut,n),c=_a(ut,n),d=Tu(ut,n),[u,m]=f.useState(null),v=le(t,b=>m(b),c.onItemTextChange,b=>{var p;return(p=l.itemTextRefCallback)==null?void 0:p.call(l,b,c.value,c.disabled)}),j=u==null?void 0:u.textContent,w=f.useMemo(()=>e.jsx("option",{value:c.value,disabled:c.disabled,children:j},c.value),[c.disabled,c.value,j]),{onNativeOptionAdd:x,onNativeOptionRemove:h}=d;return de(()=>(x(w),()=>h(w)),[x,h,w]),e.jsxs(e.Fragment,{children:[e.jsx(ne.span,{id:c.textId,...o,ref:v}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?vt.createPortal(o.children,i.valueNode):null]})});Ba.displayName=ut;var za="SelectItemIndicator",Ua=f.forwardRef((s,t)=>{const{__scopeSelect:n,...r}=s;return _a(za,n).isSelected?e.jsx(ne.span,{"aria-hidden":!0,...r,ref:t}):null});Ua.displayName=za;var $s="SelectScrollUpButton",Va=f.forwardRef((s,t)=>{const n=Ue($s,s.__scopeSelect),r=Zs($s,s.__scopeSelect),[a,o]=f.useState(!1),i=le(t,r.onScrollButtonChange);return de(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollTop>0;o(d)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),a?e.jsx(Ha,{...s,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});Va.displayName=$s;var Ms="SelectScrollDownButton",Wa=f.forwardRef((s,t)=>{const n=Ue(Ms,s.__scopeSelect),r=Zs(Ms,s.__scopeSelect),[a,o]=f.useState(!1),i=le(t,r.onScrollButtonChange);return de(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;o(u)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),a?e.jsx(Ha,{...s,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});Wa.displayName=Ms;var Ha=f.forwardRef((s,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=s,o=Ue("SelectScrollButton",n),i=f.useRef(null),l=ss(n),c=f.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return f.useEffect(()=>()=>c(),[c]),de(()=>{var u;const d=l().find(m=>m.ref.current===document.activeElement);(u=d==null?void 0:d.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),e.jsx(ne.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:se(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:se(a.onPointerMove,()=>{var d;(d=o.onItemLeave)==null||d.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:se(a.onPointerLeave,()=>{c()})})}),Wu="SelectSeparator",Ka=f.forwardRef((s,t)=>{const{__scopeSelect:n,...r}=s;return e.jsx(ne.div,{"aria-hidden":!0,...r,ref:t})});Ka.displayName=Wu;var Ls="SelectArrow",Hu=f.forwardRef((s,t)=>{const{__scopeSelect:n,...r}=s,a=ns(n),o=ze(Ls,n),i=Ue(Ls,n);return o.open&&i.position==="popper"?e.jsx(Ld,{...a,...r,ref:t}):null});Hu.displayName=Ls;var Ku="SelectBubbleInput",qa=f.forwardRef(({__scopeSelect:s,value:t,...n},r)=>{const a=f.useRef(null),o=le(r,a),i=_d(t);return f.useEffect(()=>{const l=a.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==t&&u){const m=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(m)}},[i,t]),e.jsx(ne.select,{...n,style:{...fa,...n.style},ref:o,defaultValue:t})});qa.displayName=Ku;function Ga(s){return s===""||s===void 0}function Ya(s){const t=De(s),n=f.useRef(""),r=f.useRef(0),a=f.useCallback(i=>{const l=n.current+i;t(l),function c(d){n.current=d,window.clearTimeout(r.current),d!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),o=f.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return f.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function Xa(s,t,n){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=n?s.indexOf(n):-1;let i=qu(s,Math.max(o,0));a.length===1&&(i=i.filter(d=>d!==n));const c=i.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==n?c:void 0}function qu(s,t){return s.map((n,r)=>s[(t+r)%s.length])}var Gu=Na,Qa=Ca,Yu=Ea,Xu=Ra,Qu=Ia,Ja=ka,Ju=$a,Za=Da,eo=Fa,Zu=Ba,em=Ua,to=Va,so=Wa,no=Ka;const tm=Gu,sm=Yu,ro=f.forwardRef(({className:s,children:t,...n},r)=>e.jsxs(Qa,{ref:r,className:Y("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[t,e.jsx(Xu,{asChild:!0,children:e.jsx(_s,{className:"h-4 w-4 opacity-50"})})]}));ro.displayName=Qa.displayName;const ao=f.forwardRef(({className:s,...t},n)=>e.jsx(to,{ref:n,className:Y("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(To,{className:"h-4 w-4"})}));ao.displayName=to.displayName;const oo=f.forwardRef(({className:s,...t},n)=>e.jsx(so,{ref:n,className:Y("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(_s,{className:"h-4 w-4"})}));oo.displayName=so.displayName;const io=f.forwardRef(({className:s,children:t,position:n="popper",...r},a)=>e.jsx(Qu,{children:e.jsxs(Ja,{ref:a,className:Y("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...r,children:[e.jsx(ao,{}),e.jsx(Ju,{className:Y("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(oo,{})]})}));io.displayName=Ja.displayName;const nm=f.forwardRef(({className:s,...t},n)=>e.jsx(Za,{ref:n,className:Y("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));nm.displayName=Za.displayName;const mt=f.forwardRef(({className:s,children:t,...n},r)=>e.jsxs(eo,{ref:r,className:Y("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(em,{children:e.jsx(Yn,{className:"h-4 w-4"})})}),e.jsx(Zu,{children:t})]}));mt.displayName=eo.displayName;const rm=f.forwardRef(({className:s,...t},n)=>e.jsx(no,{ref:n,className:Y("-mx-1 my-1 h-px bg-muted",s),...t}));rm.displayName=no.displayName;const am=()=>{const[s,t]=f.useState(fe.getConfig()),[n,r]=f.useState(""),[a,o]=f.useState(fe.getUsageInfo()),[i,l]=f.useState({calculation:!0,settlement:!0,updates:!1}),[c,d]=f.useState({autoBackup:!0,analytics:!1,cloudSync:!1});f.useEffect(()=>{const g=setInterval(()=>{o(fe.getUsageInfo())},5e3);return()=>clearInterval(g)},[]);const u=g=>{const y={...s,mode:g};t(y),fe.updateConfig(y)},m=g=>{if(r(g),s.mode==="custom"){const y={...s,apiKey:g};t(y),fe.updateConfig(y)}},v=()=>{const g={...s,fallbackToOffline:!s.fallbackToOffline};t(g),fe.updateConfig(g)},j=()=>{fe.resetUsage(),o(fe.getUsageInfo())},w=g=>{l(y=>({...y,[g]:!y[g]}))},x=g=>{d(y=>({...y,[g]:!y[g]}))},h=()=>{const g={calculations:[],settings:{notifications:i,privacy:c,aiConfig:s},exportDate:new Date().toISOString()},y=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),N=URL.createObjectURL(y),S=document.createElement("a");S.href=N,S.download=`smart-split-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(N)},b=()=>{if(confirm("앱을 초기화하시겠습니까? 설정이 모두 기본값으로 되돌아갑니다.")){l({calculation:!0,settlement:!0,updates:!1}),d({autoBackup:!0,analytics:!1,cloudSync:!1});const g={mode:"offline",fallbackToOffline:!0};t(g),fe.updateConfig(g),alert("앱이 초기화되었습니다.")}},p=()=>{confirm("정말로 모든 데이터를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.")&&confirm("마지막 확인: 계산 기록, 설정 등 모든 데이터가 영구 삭제됩니다.")&&(localStorage.clear(),sessionStorage.clear(),alert("모든 데이터가 삭제되었습니다. 페이지가 새로고침됩니다."),window.location.reload())};return e.jsx("div",{className:"container mx-auto p-4 max-w-2xl","data-testid":"settings-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold tech-title mb-2",children:"설정"}),e.jsx("p",{className:"text-muted-foreground tech-subtitle",children:"앱 설정 및 환경설정"})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_t,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"AI 분석 설정"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"AI 분석 모드"}),e.jsxs(tm,{value:s.mode,onValueChange:u,children:[e.jsx(ro,{className:"w-full",children:e.jsx(sm,{placeholder:"AI 모드 선택"})}),e.jsxs(io,{children:[e.jsx(mt,{value:"offline",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"오프라인 모드"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"규칙 기반 분석 (무료)"})]})]})}),e.jsx(mt,{value:"mock",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"Mock 모드"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"개발/테스트용"})]})]})}),e.jsx(mt,{value:"free",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"무료 AI 모드"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"제한된 AI 분석"})]})]})}),e.jsx(mt,{value:"custom",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oo,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{children:"사용자 API 키"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"개인 API 키 사용"})]})]})})]})]})]}),s.mode==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Gemini API 키"}),e.jsx(me,{type:"password",placeholder:"Google Gemini API 키를 입력하세요",value:n,onChange:g=>m(g.target.value),className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"API 키는 로컬에만 저장됩니다. Google AI Studio에서 발급받으실 수 있습니다."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"오프라인 대체 모드"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"API 실패 시 오프라인 모드로 대체"})]}),e.jsx(T,{variant:"outline",size:"sm",onClick:v,children:s.fallbackToOffline?"ON":"OFF"})]}),s.mode==="free"&&a.length>0&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"API 사용량"}),e.jsx(T,{variant:"ghost",size:"sm",onClick:j,children:"초기화"})]}),a.map(g=>e.jsxs("div",{className:"text-xs space-y-1 mb-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"capitalize",children:g.service}),e.jsxs("span",{children:[g.dailyUsed,"/",g.dailyLimit]})]}),e.jsx("div",{className:"w-full bg-muted/30 rounded-full h-1",children:e.jsx("div",{className:"bg-primary h-1 rounded-full transition-all",style:{width:`${g.dailyUsed/g.dailyLimit*100}%`}})}),e.jsxs("div",{className:"text-muted-foreground",children:["리셋: ",g.resetTime]})]},g.service))]})]})})})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($o,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"계정 설정"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"사용자 이름"}),e.jsx("div",{className:"mt-1 p-2 bg-muted/30 rounded text-sm",children:"익명 사용자"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"언어"}),e.jsx("div",{className:"mt-1 p-2 bg-muted/30 rounded text-sm",children:"한국어"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"통화"}),e.jsx("div",{className:"mt-1 p-2 bg-muted/30 rounded text-sm",children:"KRW (₩)"})]})]})})})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mo,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"알림 설정"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"계산 완료 알림"}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>w("calculation"),className:i.calculation?"bg-green-100 text-green-800":"",children:i.calculation?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"정산 알림"}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>w("settlement"),className:i.settlement?"bg-green-100 text-green-800":"",children:i.settlement?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"앱 업데이트 알림"}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>w("updates"),className:i.updates?"bg-green-100 text-green-800":"",children:i.updates?"ON":"OFF"})]})]})})})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Lo,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"개인정보 및 보안"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"데이터 자동 백업"}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>x("autoBackup"),className:c.autoBackup?"bg-green-100 text-green-800":"",children:c.autoBackup?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"분석 데이터 수집"}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>x("analytics"),className:c.analytics?"bg-green-100 text-green-800":"",children:c.analytics?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"클라우드 동기화"}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>x("cloudSync"),className:c.cloudSync?"bg-green-100 text-green-800":"",children:c.cloudSync?"ON":"OFF"})]})]})})})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"데이터 관리"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(T,{variant:"outline",className:"w-full justify-start",onClick:h,children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"데이터 내보내기"]}),e.jsxs(T,{variant:"outline",className:"w-full justify-start",onClick:b,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"앱 초기화"]}),e.jsxs(T,{variant:"outline",className:"w-full justify-start text-destructive",onClick:p,children:[e.jsx(ft,{className:"h-4 w-4 mr-2"}),"모든 데이터 삭제"]})]})})]}),e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"앱 정보"})}),e.jsx(q,{children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"버전"}),e.jsx("span",{children:"1.0.0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"빌드"}),e.jsx("span",{children:"2024.01.15"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"개발자"}),e.jsx("span",{children:"Smart Split Team"})]})]})})})]})]})})},om=()=>{const s=()=>{window.open("mailto:support@smartsplit.com","_blank")},t=()=>{window.open("https://smartsplit.example.com/help","_blank")};return e.jsx("div",{className:"container mx-auto p-4 max-w-4xl","data-testid":"help-page",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold tech-title mb-2",children:"도움말"}),e.jsx("p",{className:"text-muted-foreground tech-subtitle",children:"사용법 및 자주 묻는 질문"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Do,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"사용 가이드"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm mb-2",children:"1단계: 영수증 업로드"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"영수증 사진을 찍거나 갤러리에서 선택하여 업로드하세요."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm mb-2",children:"2단계: OCR 처리"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AI가 자동으로 영수증 내용을 인식하고 분석합니다."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm mb-2",children:"3단계: 참가자 설정"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"참가자를 추가하고 각 항목을 누구에게 할당할지 설정합니다."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm mb-2",children:"4단계: 결과 확인"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"계산 결과를 확인하고 저장 또는 공유합니다."})]})]})})})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qn,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"자주 묻는 질문"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm mb-1",children:"Q: OCR 인식이 정확하지 않아요"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"영수증을 잘 보이도록 촬영하고, 조명이 충분한 곳에서 찍어보세요. 수동으로 항목을 수정할 수도 있습니다."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm mb-1",children:"Q: 데이터가 저장되나요?"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"모든 데이터는 기기 내에서만 저장되며, 외부로 전송되지 않습니다."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm mb-1",children:"Q: 여러 명이 동시에 사용할 수 있나요?"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"현재는 단일 기기에서만 사용 가능하며, 결과 공유 기능을 통해 다른 사람과 결과를 나눌 수 있습니다."})]})]})})})]})]}),e.jsxs(V,{className:"steel-panel hud-element",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_o,{className:"h-5 w-5 text-primary glow-orange"}),e.jsx(Z,{className:"tech-title",children:"지원 및 문의"})]})}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(T,{variant:"outline",className:"flex items-center justify-start space-x-2 h-auto p-4",onClick:s,children:[e.jsx(Kn,{className:"h-5 w-5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"이메일 문의"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"support@smartsplit.com"})]})]}),e.jsxs(T,{variant:"outline",className:"flex items-center justify-start space-x-2 h-auto p-4",onClick:t,children:[e.jsx(Fo,{className:"h-5 w-5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"온라인 도움말"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"웹사이트 방문"})]})]})]})})]}),e.jsxs(V,{className:"steel-panel",children:[e.jsx(J,{children:e.jsx(Z,{className:"tech-title",children:"팁과 요령"})}),e.jsx(q,{children:e.jsx("div",{className:"tech-display rounded p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",children:"영수증 촬영 시 주의사항"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"영수증 전체가 화면에 들어오도록 하고, 그림자가 지지 않도록 촬영하세요."})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",children:"템플릿 활용하기"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"자주 만나는 그룹의 분할 설정을 템플릿으로 저장해두면 매번 설정할 필요가 없어 편리합니다."})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",children:"결과 저장하기"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"계산 결과를 저장해두면 나중에 히스토리에서 다시 확인할 수 있습니다."})]})]})]})})})]})]})})};class im extends f.Component{constructor(n){super(n);ue(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});ue(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Error Boundary caught an error:",n,r),this.setState({error:n,errorInfo:r}),this.props.onError&&this.props.onError(n,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:e.jsxs("div",{className:"max-w-md w-full text-center space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-4 bg-destructive/10 rounded-full",children:e.jsx(js,{className:"h-8 w-8 text-destructive"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-semibold text-foreground",children:"문제가 발생했습니다"}),e.jsx("p",{className:"text-muted-foreground",children:"예상치 못한 오류로 인해 앱이 중단되었습니다. 페이지를 새로고침하거나 홈으로 이동해주세요."})]}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(T,{onClick:this.handleReset,className:"flex items-center gap-2","data-testid":"error-retry-button",children:[e.jsx(Gn,{className:"h-4 w-4"}),"다시 시도"]}),e.jsxs(T,{variant:"outline",onClick:this.handleGoHome,className:"flex items-center gap-2","data-testid":"error-home-button",children:[e.jsx(Bo,{className:"h-4 w-4"}),"홈으로 이동"]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:e.jsxs("p",{children:["문제가 지속될 경우"," ",e.jsx("a",{href:"mailto:contact@example.com",className:"text-primary hover:underline",children:"contact@example.com"}),"으로 문의해주세요."]})})]})}):this.props.children}}function lm(){return e.jsx(im,{children:e.jsx(xo,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx($i,{children:e.jsx(Hi,{children:e.jsxs(go,{children:[e.jsx(ce,{path:"/",element:e.jsx(dt,{})}),e.jsx(ce,{path:"/calculator",element:e.jsx(dt,{})}),e.jsx(ce,{path:"/calculator/new",element:e.jsx(dt,{})}),e.jsx(ce,{path:"/calculator/legacy",element:e.jsx(Xi,{})}),e.jsx(ce,{path:"/calculator/:step",element:e.jsx(dt,{})}),e.jsx(ce,{path:"/edit",element:e.jsx(bn,{})}),e.jsx(ce,{path:"/edit/:calculationId",element:e.jsx(bn,{})}),e.jsx(ce,{path:"/result",element:e.jsx(yn,{})}),e.jsx(ce,{path:"/result/:id",element:e.jsx(yn,{})}),e.jsx(ce,{path:"/history",element:e.jsx(Kl,{})}),e.jsx(ce,{path:"/stats",element:e.jsx(Yl,{})}),e.jsx(ce,{path:"/templates",element:e.jsx(Xl,{})}),e.jsx(ce,{path:"/archive",element:e.jsx(Ql,{})}),e.jsx(ce,{path:"/settings",element:e.jsx(am,{})}),e.jsx(ce,{path:"/help",element:e.jsx(om,{})}),e.jsx(ce,{path:"*",element:e.jsx(dt,{})})]})})})})})}ws.createRoot(document.getElementById("root")).render(e.jsx(ie.StrictMode,{children:e.jsx(lm,{})}));
