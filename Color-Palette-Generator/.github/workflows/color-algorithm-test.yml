name: 🎨 Color Algorithm Tests

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'src/algorithms/**'
      - 'src/services/colorService.ts'
      - 'src/data/color-keywords.json'
      - 'tests/**/*.spec.ts'
  pull_request:
    branches: [ main ]
    paths:
      - 'src/algorithms/**'
      - 'src/services/**'

jobs:
  color-theory-validation:
    name: 🧮 Color Theory Mathematical Accuracy
    runs-on: ubuntu-latest
    
    steps:
      - name: 📋 Checkout code
        uses: actions/checkout@v4
        
      - name: 📦 Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: 🔧 Install dependencies
        run: npm ci
        
      - name: 🎯 Test Color Harmony Rules
        run: |
          npm run test -- --testPathPattern="algorithms" --verbose
          echo "✅ 5가지 색상 조화 규칙 수학적 정확성 검증 완료"
          
      - name: 📊 Test Korean Keyword Mapping
        run: |
          npm run test -- --testNamePattern="keyword" --coverage
          echo "✅ 한국어 키워드 → 색상 매핑 정확성 검증 완료"
          
      - name: 🎨 Test HSL/RGB/HEX Conversion
        run: |
          npm run test -- --testNamePattern="color.*conversion" --verbose
          echo "✅ 색상 형식 변환 정확성 검증 완료"

  accessibility-compliance:
    name: ♿ WCAG Accessibility Compliance  
    runs-on: ubuntu-latest
    
    steps:
      - name: 📋 Checkout code
        uses: actions/checkout@v4
        
      - name: 📦 Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: 🔧 Install dependencies
        run: npm ci
        
      - name: 🔍 Test WCAG Contrast Ratio Calculation
        run: |
          npm run test -- --testNamePattern="wcag|contrast|accessibility" --verbose
          echo "✅ WCAG AA(4.5:1) / AAA(7:1) 대비율 계산 정확성 검증"